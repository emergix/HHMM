(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    504555,      12349]
NotebookOptionsPosition[    492518,      11978]
NotebookOutlinePosition[    492887,      11994]
CellTagsIndexPosition[    492844,      11991]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<CompiledFunctionTools`\>\"", "]"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell["Fonctions auxiliaires", "Section",
 CellChangeTimes->{{3.5672553128830385`*^9, 3.56725531625266*^9}, 
   3.567255789523305*^9, {3.5672579563656373`*^9, 3.567257968284114*^9}, 
   3.5672602990754766`*^9, {3.5677513207625947`*^9, 3.5677513279386406`*^9}}],

Cell[CellGroupData[{

Cell["Fonctions de base", "Subsubsection",
 CellChangeTimes->{{3.574788938473341*^9, 3.574788956210768*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LogRC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"a", ",", "_Real"}], "}"}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"a", "\[Equal]", "0"}], ",", " ", 
       RowBox[{
        RowBox[{"-", "1.23456789"}], " ", 
        RowBox[{"10", "^", "99"}]}], ",", " ", 
       RowBox[{"Log", "[", "a", "]"}]}], "]"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.568445128000594*^9, 3.568445230898854*^9}, {
   3.5744116491756916`*^9, 3.574411679237277*^9}, {3.574411737925229*^9, 
   3.574411747909357*^9}, 3.574593761352316*^9, 3.574684969027884*^9, {
   3.6059360671192713`*^9, 3.605936082017367*^9}}],

Cell[BoxData[
 RowBox[{"SetAttributes", "[", 
  RowBox[{"LogRC", ",", "Listable"}], "]"}]], "Input",
 CellChangeTimes->{{3.6059357836186543`*^9, 3.605935795225128*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"LogRC", ",", "NumericFunction"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{3.6059358334921737`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"LogR", "[", "1.2", "]"}], ",", 
   RowBox[{"LogRC", "[", "1.2", "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.5744117604363174`*^9, 3.574411777612138*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.1823215567939546`", ",", "0.1823215567939546`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.5744117788757544`*^9, 3.5745937811801696`*^9, 
  3.6059361106747503`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Exp", "[", "1.2", "]"}], ",", 
   RowBox[{"ExpRC", "[", "1.2", "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.5744117604363174`*^9, 3.5744118019172497`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.3201169227365472`", ",", "3.3201169227365472`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.574411804616084*^9, 3.5745937791521435`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"LogRC1", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"a", ",", " ", "_Real", ",", " ", "1"}], "}"}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"-", "1.23456789`"}], " ", 
          SuperscriptBox["10", "99"]}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"a", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605272736407796*^9, 3.6052728125362835`*^9}, {
  3.6052730621534843`*^9, 3.6052730807956038`*^9}, {3.605273111949003*^9, 
  3.6052731204666576`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpRC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"a", ",", "_Real"}], "}"}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"a", "<", 
        RowBox[{"-", 
         RowBox[{"10", "^", 
          RowBox[{"(", "3", ")"}]}]}]}], ",", "0.", ",", 
       RowBox[{"Exp", "[", "a", "]"}]}], "]"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5684461413570957`*^9, 3.568446241452543*^9}, {
   3.569252471841101*^9, 3.5692524733699207`*^9}, {3.574411696506698*^9, 
   3.57441173098314*^9}, 3.5745937660479755`*^9, 3.574684963209009*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpRC1", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"a", ",", " ", "_Real", ",", " ", "1"}], "}"}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
           "<", 
          RowBox[{"-", 
           RowBox[{"10", "^", 
            RowBox[{"(", "3", ")"}]}]}]}], ",", "0.", ",", 
         RowBox[{"Exp", "[", 
          RowBox[{"a", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
           "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6059367350215583`*^9, 3.605936736238366*^9}, {
  3.6059368469054756`*^9, 3.6059368584339495`*^9}, {3.605936893799376*^9, 
  3.605936967977852*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LogRC1", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"1", "/", "12."}], ",", 
    RowBox[{"1", "/", "12."}], ",", 
    RowBox[{"1", "/", "12."}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.605935670018726*^9, 3.60593568781844*^9}, {
   3.6059358938177605`*^9, 3.6059358977645855`*^9}, 3.605937002875275*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "2.4849066497880004`"}], ",", 
   RowBox[{"-", "2.4849066497880004`"}], ",", 
   RowBox[{"-", "2.4849066497880004`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6059356902520556`*^9, 3.605935803430781*^9, 
  3.605935837735401*^9, 3.6059358990437937`*^9, 3.6059361162595863`*^9, 
  3.605937004029683*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Attributes", "[", "ExpRC", "]"}]], "Input",
 CellChangeTimes->{{3.6059355983674664`*^9, 3.6059356523126125`*^9}}],

Cell[BoxData[
 RowBox[{"{", "Listable", "}"}]], "Output",
 CellChangeTimes->{{3.6059356145759706`*^9, 3.6059356526870146`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"LogSumExpC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"vec", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"biggest", ",", "vecp", ",", "sum", ",", " ", "logCutoff"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"biggest", "=", 
         RowBox[{"Max", "[", "vec", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"logCutoff", "=", 
         RowBox[{"-", "70.0"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vecp", "=", 
         RowBox[{"vec", "-", "biggest"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sum", "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"vecp", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "<", "logCutoff"}], ",", "0.0",
              ",", 
             RowBox[{"ExpRC", "[", 
              RowBox[{"vecp", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "vec", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"LogRC", "[", "sum", "]"}], "+", "biggest"}]}]}], "]"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ExpRC", "[", "_", "]"}], ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LogRC", "[", "_", "]"}], ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"biggest", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"logCutoff", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"vecp", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"sum", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"biggest", ",", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.567434937401575*^9, 3.567434973163151*^9}, {
   3.5674350820390377`*^9, 3.5674352316369953`*^9}, {3.5674353994027705`*^9, 
   3.5674354002348537`*^9}, {3.5674354662454543`*^9, 
   3.5674354802058496`*^9}, {3.5674355682816567`*^9, 3.567435628267655*^9}, {
   3.5674356817340007`*^9, 3.5674357364714737`*^9}, {3.5674360921800413`*^9, 
   3.567436204808303*^9}, 3.5674362542182436`*^9, {3.5674375917059793`*^9, 
   3.5674375921220207`*^9}, 3.5674401042442074`*^9, {3.5675170084225903`*^9, 
   3.567517018827857*^9}, {3.5675170847382793`*^9, 3.5675170975459614`*^9}, {
   3.5675171779020767`*^9, 3.567517257265991*^9}, {3.567517361193857*^9, 
   3.5675173901164427`*^9}, 3.5684454535902815`*^9, 3.56844631430501*^9, {
   3.5744039517904215`*^9, 3.574404033317067*^9}, {3.57440901264555*^9, 
   3.5744090456087723`*^9}, {3.574409088010116*^9, 3.5744091095071917`*^9}, 
   3.574409211813303*^9, {3.5744092757273226`*^9, 3.574409284759838*^9}, 
   3.5744115881009083`*^9, {3.5745128253411937`*^9, 3.57451303795632*^9}, {
   3.5745135129366093`*^9, 3.5745135225619326`*^9}, {3.5745144962192154`*^9, 
   3.574514499776061*^9}, 3.5746849105895348`*^9, {3.5747475595684276`*^9, 
   3.574747578678673*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CompilePrint", "[", "LogSumExpC", "]"}]], "Input",
 CellChangeTimes->{{3.5745127594927497`*^9, 3.5745127672772493`*^9}}],

Cell[BoxData["\<\"\\n\\t\\t1 argument\\n\\t\\t2 Boolean registers\\n\\t\\t8 \
Integer registers\\n\\t\\t11 Real registers\\n\\t\\t2 Tensor \
registers\\n\\t\\tUnderflow checking off\\n\\t\\tOverflow checking \
off\\n\\t\\tInteger overflow checking on\\n\\t\\tRuntimeAttributes -> \
{}\\n\\n\\t\\tT(R1)0 = A1\\n\\t\\tI4 = 0\\n\\t\\tR10 = -1.23456789\\n\\t\\tI7 \
= 99\\n\\t\\tR1 = -70.\\n\\t\\tI6 = 10\\n\\t\\tI0 = 1\\n\\t\\tR3 = \
7.\\n\\t\\tI1 = -1000\\n\\t\\tR4 = 0.\\n\\t\\tResult = R5\\n\\n1\\tR0 = \
MaxRT[ T(R1)0]]\\n2\\tR2 = - R0\\n3\\tT(R1)1 = R2 + T(R1)0\\n4\\tR8 = \
R4\\n5\\tI3 = Length[ T(R1)0]\\n6\\tI5 = I4\\n7\\tgoto 24\\n8\\tR7 = Part[ \
T(R1)1, I5]\\n9\\tB0 = R7 < R1 (tol R3)\\n10\\tif[ !B0] goto 13\\n11\\tR7 = \
R4\\n12\\tgoto 22\\n13\\tR7 = Part[ T(R1)1, I5]\\n14\\tR5 = I1\\n15\\tB1 = R7 \
< R5 (tol R3)\\n16\\tif[ !B1] goto 19\\n17\\tR9 = R4\\n18\\tgoto 21\\n19\\tR5 \
= Exp[ R7]\\n20\\tR9 = R5\\n21\\tR7 = R9\\n22\\tR9 = R8 + R7\\n23\\tR8 = \
R9\\n24\\tif[ ++ I5 < I3] goto 8\\n25\\tR2 = R8\\n26\\tR6 = I4\\n27\\tB0 = R2 \
== R6 (tol R3)\\n28\\tif[ !B0] goto 34\\n29\\tI5 = Power[ I6, I7]\\n30\\tR9 = \
I5\\n31\\tR7 = R10 * R9\\n32\\tR5 = R7\\n33\\tgoto 36\\n34\\tR9 = Log[ \
R2]\\n35\\tR5 = R9\\n36\\tR5 = R5 + R0\\n37\\tReturn\\n\"\>"], "Output",
 CellChangeTimes->{
  3.574512768696868*^9, 3.574512995820179*^9, {3.5745130450076103`*^9, 
   3.574513046349227*^9}, 3.5745135298004255`*^9, 3.5745145078725643`*^9, 
   3.5745929513383102`*^9, 3.5747475990681343`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"LogSumExp", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1.25"}], ",", 
      RowBox[{"-", "25"}], ",", 
      RowBox[{"-", "3000000"}], ",", 
      RowBox[{"-", "2"}]}], "}"}], "]"}], ",", 
   RowBox[{"LogSumExpC", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1.25"}], ",", 
      RowBox[{"-", "25"}], ",", 
      RowBox[{"-", "3000000"}], ",", 
      RowBox[{"-", "2"}]}], "}"}], "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.5674352419250245`*^9, 3.567435276317463*^9}, {
  3.5674354940062304`*^9, 3.5674355234631753`*^9}, {3.567436218319654*^9, 
  3.5674362380476265`*^9}, {3.5675166708988266`*^9, 3.5675166816628957`*^9}, {
  3.574409150067712*^9, 3.5744091761824465`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.8631289938521778`"}], ",", 
   RowBox[{"-", "0.8631289938521778`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5744091779920692`*^9, 3.5744092162905607`*^9, {3.5744092904071107`*^9, 
   3.574409295586377*^9}, 3.574411591954158*^9, 3.5745136877212496`*^9, 
   3.57451451766949*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "30"}], " ", 
  RowBox[{"Log", "[", "10.", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"-", "69.07755278982138`"}]], "Output",
 CellChangeTimes->{3.574695469533166*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Timing", "[", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"LogSumExpC", "[", 
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", "100"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "1000"}], "}"}]}], "]"}], "]"}], ",", 
   RowBox[{"Timing", "[", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"LogSumExp", "[", 
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", "100"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "1000"}], "}"}]}], "]"}], "]"}]}], 
  "}"}]], "Input",
 CellChangeTimes->{{3.5744142957436695`*^9, 3.5744143422322655`*^9}, 
   3.5744143801303616`*^9, {3.574414423062112*^9, 3.574414441142743*^9}, {
   3.57441448770934*^9, 3.5744145061955776`*^9}, {3.574414613743356*^9, 
   3.574414620576244*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.1559999999999988`", ",", "Null"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.7490000000000006`", ",", "Null"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5744143843112144`*^9, {3.574414424980936*^9, 3.5744144435607743`*^9}, 
   3.57441450875401*^9, 3.574414623789885*^9, 3.5745136994370003`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"LogSumExp2C", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"vec", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "biggest", ",", "vecp", ",", "sum", ",", " ", "logCutoff", ",", 
         "nbdecimal"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"biggest", "=", 
         RowBox[{"Max", "[", "vec", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"logCutoff", "=", 
         RowBox[{"-", "69.07755278982138"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vecp", "=", 
         RowBox[{"vec", "-", "biggest"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sum", "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"vecp", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "<", "logCutoff"}], 
             ",", "0.0", ",", 
             RowBox[{"ExpRC", "[", 
              RowBox[{"vecp", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "vec", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "vec", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"LogRC", "[", "sum", "]"}], "+", "biggest"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vecp", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ExpRC", "[", "_", "]"}], ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LogRC", "[", "_", "]"}], ",", "_Real"}], "}"}]}], "}"}], 
     ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.567434937401575*^9, 3.567434973163151*^9}, {
   3.5674350820390377`*^9, 3.5674352316369953`*^9}, {3.5674353994027705`*^9, 
   3.5674354002348537`*^9}, {3.5674354662454543`*^9, 
   3.5674354802058496`*^9}, {3.5674355682816567`*^9, 3.567435628267655*^9}, {
   3.5674356817340007`*^9, 3.5674357364714737`*^9}, {3.5674360921800413`*^9, 
   3.567436204808303*^9}, 3.5674362542182436`*^9, {3.5674375917059793`*^9, 
   3.5674375921220207`*^9}, 3.5674401042442074`*^9, {3.56744080333311*^9, 
   3.5674408494387197`*^9}, {3.5675174142965975`*^9, 3.567517417900221*^9}, 
   3.5684454451974277`*^9, 3.568446321637057*^9, {3.5744093299224176`*^9, 
   3.5744093789850464`*^9}, {3.5744095285129633`*^9, 
   3.5744095782932014`*^9}, {3.5744112887486706`*^9, 3.574411288842272*^9}, 
   3.5744113476706257`*^9, {3.574411377732211*^9, 3.5744113818038635`*^9}, {
   3.5744114577300367`*^9, 3.5744114624568977`*^9}, {3.57441152346928*^9, 
   3.574411561252964*^9}, {3.5744118221039085`*^9, 3.5744118530703053`*^9}, 
   3.574684924489313*^9, {3.5746954386291695`*^9, 3.574695498190733*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"LogSumExp2", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1.25"}], ",", 
        RowBox[{"-", "25"}], ",", 
        RowBox[{"-", "3000000"}], ",", 
        RowBox[{"-", "2"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1.25"}], ",", 
        RowBox[{"-", "35"}], ",", 
        RowBox[{"-", "4000000"}], ",", 
        RowBox[{"-", "2"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1.25"}], ",", 
        RowBox[{"-", "25"}], ",", 
        RowBox[{"-", "1000000"}], ",", 
        RowBox[{"-", "2"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1.25"}], ",", 
        RowBox[{"-", "25"}], ",", 
        RowBox[{"-", "2400000"}], ",", 
        RowBox[{"-", "6"}]}], "}"}]}], "}"}], "]"}], ",", 
   RowBox[{"LogSumExp2C", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1.25"}], ",", 
        RowBox[{"-", "25"}], ",", 
        RowBox[{"-", "3000000"}], ",", 
        RowBox[{"-", "2"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1.25"}], ",", 
        RowBox[{"-", "35"}], ",", 
        RowBox[{"-", "4000000"}], ",", 
        RowBox[{"-", "2"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1.25"}], ",", 
        RowBox[{"-", "25"}], ",", 
        RowBox[{"-", "1000000"}], ",", 
        RowBox[{"-", "2"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1.25"}], ",", 
        RowBox[{"-", "25"}], ",", 
        RowBox[{"-", "2400000"}], ",", 
        RowBox[{"-", "6"}]}], "}"}]}], "}"}], "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.5674352419250245`*^9, 3.567435276317463*^9}, {
  3.5674354940062304`*^9, 3.5674355234631753`*^9}, {3.567436218319654*^9, 
  3.5674362380476265`*^9}, {3.5675166708988266`*^9, 3.5675166816628957`*^9}, {
  3.574409150067712*^9, 3.5744091761824465`*^9}, {3.5744094082042212`*^9, 
  3.574409503693045*^9}, {3.5744118982328844`*^9, 3.5744119096366305`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.44115638819072167`", ",", "0.44115638819072145`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.5744091779920692`*^9, 3.5744092162905607`*^9, {3.5744092904071107`*^9, 
   3.574409295586377*^9}, 3.5744095079206996`*^9, 3.574409591834175*^9, 
   3.574411295628359*^9, {3.5744114860288*^9, 3.5744114969177394`*^9}, 
   3.5744115562141*^9, 3.574411601127075*^9, 3.5744118632104354`*^9, 
   3.5744119114150534`*^9, 3.5746955088144693`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalizeLog", "[", "M_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"HDim", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "M", "]"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Switch", "[", 
     RowBox[{"HDim", ",", "\[IndentingNewLine]", "1", ",", 
      RowBox[{"M", "-", 
       RowBox[{"LogSumExp", "[", "M", "]"}]}], ",", "\[IndentingNewLine]", 
      "2", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"M", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "-", 
         RowBox[{"LogSumExp", "[", 
          RowBox[{"M", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "3", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"M", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "-", 
         RowBox[{"LogSumExp", "[", 
          RowBox[{"M", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "4", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"M", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "-", 
         RowBox[{"LogSumExp", "[", 
          RowBox[{"M", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "5", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"M", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}], "-", 
         RowBox[{"LogSumExp", "[", 
          RowBox[{"M", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", 
          RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.570431844282255*^9, 3.5704319345132756`*^9}, {
  3.570442868672586*^9, 3.570442901011593*^9}, {3.5710533623671217`*^9, 
  3.5710533700112195`*^9}, {3.571053413270574*^9, 3.571053460195976*^9}, {
  3.571053609630292*^9, 3.5710536198484225`*^9}, {3.5710536724054966`*^9, 
  3.5710538233530316`*^9}, {3.5735593393031216`*^9, 3.573559340114332*^9}, {
  3.573559396665057*^9, 3.573559399005087*^9}, {3.573559429051072*^9, 
  3.5735594689251833`*^9}, {3.5735595014516*^9, 3.5735595222154665`*^9}, {
  3.573562822053792*^9, 3.5735628225685987`*^9}, {3.5735633124148784`*^9, 
  3.573563344130085*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalizeLog1C2", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"M", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"M", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "-", 
        RowBox[{"LogSumExp", "[", "M", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"LogSumExpC", "[", "_", "]"}], ",", "_Real"}], "}"}], "}"}], 
     ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.57416125511619*^9, 3.574161418216281*^9}, {
   3.5744119693697968`*^9, 3.574411969869003*^9}, {3.574412030600581*^9, 
   3.574412072669531*^9}, 3.5744126457116776`*^9, {3.5744126989863605`*^9, 
   3.5744127258967056`*^9}, {3.5744130918929977`*^9, 
   3.5744131286002684`*^9}, {3.5744131729360366`*^9, 3.5744132437141438`*^9}, 
   3.5744133481882935`*^9, {3.5744141503810053`*^9, 3.574414208273348*^9}, 
   3.574414269987739*^9, {3.574514565546504*^9, 3.574514573175002*^9}, 
   3.5746849367042694`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalizeLog1C", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"M", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"M", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "-", 
        RowBox[{"LogSumExpC", "[", "M", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"LogSumExpC", "[", "_", "]"}], ",", "_Real"}], "}"}], "}"}], 
     ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.57416125511619*^9, 3.574161418216281*^9}, {
   3.5744119693697968`*^9, 3.574411969869003*^9}, {3.574412030600581*^9, 
   3.574412072669531*^9}, 3.5744126457116776`*^9, {3.5744126989863605`*^9, 
   3.5744127258967056`*^9}, {3.5744130918929977`*^9, 
   3.5744131286002684`*^9}, {3.5744131729360366`*^9, 3.5744132437141438`*^9}, 
   3.5744133481882935`*^9, {3.574514597620515*^9, 3.574514599071334*^9}, 
   3.574684941789935*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalizeLog2C", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"M", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"M", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "-", 
        RowBox[{"LogSumExpC", "[", 
         RowBox[{"M", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"LogSumExpC", "[", "_", "]"}], ",", "_Real"}], "}"}], "}"}], 
     ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5741614336448793`*^9, 3.574161452599122*^9}, 
   3.574411979634728*^9, {3.5744121137448573`*^9, 3.574412159781048*^9}, 
   3.574412526385748*^9, 3.5744126471936965`*^9, 3.5744129020853643`*^9, 
   3.5744133552863846`*^9, {3.5745146075578423`*^9, 3.574514608462654*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalizeLog3C", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"M", ",", "_Real", ",", "3"}], "}"}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"M", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "-", 
        RowBox[{"LogSumExpC", "[", 
         RowBox[{"M", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"LogSumExpC", "[", "_", "]"}], ",", "_Real"}], "}"}], "}"}], 
     ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.574161491195017*^9, 3.5741614921466293`*^9}, {
   3.574161524501444*^9, 3.5741615514585896`*^9}, 3.5744119816939545`*^9, {
   3.5744121781268826`*^9, 3.574412181371724*^9}, 3.5744125291625834`*^9, 
   3.57441264901892*^9, 3.5744129059074135`*^9, 3.574413365598117*^9, {
   3.5745146165123577`*^9, 3.5745146173079677`*^9}, {3.5745928472225757`*^9, 
   3.574592857861912*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalizeLog4C", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"M", ",", "_Real", ",", "4"}], "}"}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"M", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "-", 
        RowBox[{"LogSumExpC", "[", 
         RowBox[{"M", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"LogSumExpC", "[", "_", "]"}], ",", "_Real"}], "}"}], "}"}], 
     ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.5741614952042685`*^9, {3.5741615361391935`*^9, 3.5741615546410303`*^9}, 
   3.574411983300775*^9, {3.57441218882862*^9, 3.5744121939298854`*^9}, 
   3.57441253201742*^9, 3.574412651312149*^9, 3.57441291111788*^9, 
   3.574413371182988*^9, {3.574514622487234*^9, 3.5745146232672443`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalizeLog5C", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"M", ",", "_Real", ",", "5"}], "}"}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"M", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}], "-", 
        RowBox[{"LogSumExpC", "[", 
         RowBox[{"M", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}], "]"}]}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"LogSumExpC", "[", "_", "]"}], ",", "_Real"}], "}"}], "}"}], 
     ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.5741614979343033`*^9, {3.5741615469345317`*^9, 3.5741615572306633`*^9}, {
   3.5741616542015066`*^9, 3.5741616603011847`*^9}, 3.5744119852352*^9, {
   3.574412204038815*^9, 3.5744122083132696`*^9}, 3.5744125347942553`*^9, 
   3.5744126530125713`*^9, {3.5744129186215763`*^9, 3.5744129221472216`*^9}, 
   3.574413375753847*^9, {3.574514633906191*^9, 3.574514634701801*^9}, {
   3.574514725448164*^9, 3.57451472590057*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalizeLogC", "[", "M_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"HDim", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "M", "]"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Switch", "[", 
     RowBox[{"HDim", ",", "\[IndentingNewLine]", "1", ",", 
      RowBox[{"MNormalizeLog1C", "[", "M", "]"}], ",", "\[IndentingNewLine]", 
      "2", ",", 
      RowBox[{"MNormalizeLog2C", "[", "M", "]"}], ",", "\[IndentingNewLine]", 
      "3", ",", 
      RowBox[{"MNormalizeLog3C", "[", "M", "]"}], ",", "\[IndentingNewLine]", 
      "4", ",", 
      RowBox[{"MNormalizeLog4C", "[", "M", "]"}], ",", "\[IndentingNewLine]", 
      "5", ",", 
      RowBox[{"MNormalizeLog5C", "[", "M", "]"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5741611584417505`*^9, 3.574161193916606*^9}, 
   3.5741612469884863`*^9, {3.574161576606112*^9, 3.5741616465730085`*^9}, 
   3.574161759456056*^9, 3.5744119885580425`*^9, {3.5744122211210337`*^9, 
   3.5744122358788233`*^9}, {3.5744126573026257`*^9, 3.574412661233876*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.", ",", "2."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3.", ",", "4."}], "}"}]}], "}"}]}], ";", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"MNormalizeLogC", "[", "A", "]"}], "//", " ", "MatrixForm"}], 
    ",", 
    RowBox[{
     RowBox[{"MNormalizeLog", "[", "A", "]"}], "//", " ", "MatrixForm"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.5704431008176737`*^9, 3.5704431604412565`*^9}, {
   3.570475625273945*^9, 3.570475630733257*^9}, {3.570475719111312*^9, 
   3.570475729795923*^9}, {3.570477029454259*^9, 3.5704771089028034`*^9}, {
   3.573562617379168*^9, 3.5735626226520357`*^9}, {3.5735627446455994`*^9, 
   3.5735627657526703`*^9}, {3.5741617202527533`*^9, 3.574161735026143*^9}, 
   3.5741617728618383`*^9, {3.5744123467494445`*^9, 3.574412351398304*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"-", "1.313261687518223`"}], 
        RowBox[{"-", "0.31326168751822303`"}]},
       {
        RowBox[{"-", "1.3132616875182226`"}], 
        RowBox[{"-", "0.3132616875182226`"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"-", "1.3132616875182226`"}], 
        RowBox[{"-", "0.3132616875182226`"}]},
       {
        RowBox[{"-", "1.3132616875182226`"}], 
        RowBox[{"-", "0.3132616875182226`"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5741617395346007`*^9, 3.5741617766214867`*^9, {3.574162213220913*^9, 
   3.5741622269958897`*^9}, 3.5741623036708727`*^9, 3.5744123532547283`*^9, {
   3.574412552672085*^9, 3.5744125560885286`*^9}, 3.574413388390009*^9, 
   3.5745147386147327`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"LogNormDensC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x0", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Sigma]", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "sqrt2pi", "}"}], ",", 
       RowBox[{
        RowBox[{"sqrt2pi", "=", "2.506628274631000502415765284811"}], ";", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x", "-", "x0"}], ")"}], "2"], 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Sigma]", "2"]}]]}], "-", 
         RowBox[{"Log", "[", 
          RowBox[{"sqrt2pi", " ", "\[Sigma]"}], "]"}]}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"sqrt2pi", ",", "_Real"}], "}"}], "}"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.5744134518516226`*^9, {3.5744135062287292`*^9, 3.574413507414345*^9}, {
   3.574413578878861*^9, 3.5744136713256464`*^9}, {3.574413903205424*^9, 
   3.574413908765108*^9}, {3.5744985606118937`*^9, 3.574498696318033*^9}, 
   3.5744987290160522`*^9, {3.574514749160468*^9, 3.574514756258559*^9}, 
   3.575267042417303*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LogBivariateNormDensC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Mu]1", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Mu]2", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Sigma]1", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Sigma]2", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Rho]", ",", "_Real"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Rho]", "\[NotEqual]", "1"}], " ", "&&", 
        RowBox[{"\[Rho]", "\[NotEqual]", 
         RowBox[{"-", "1"}]}]}], ",", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              RowBox[{"x", "-", "\[Mu]1"}], "\[Sigma]1"], ")"}], "2"]}], "-", 
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox[
             RowBox[{"y", "-", "\[Mu]2"}], "\[Sigma]2"], ")"}], "2"], "+", 
          RowBox[{"2", " ", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"x", "-", "\[Mu]1"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"y", "-", "\[Mu]2"}], ")"}]}], 
            RowBox[{"\[Sigma]1", " ", "\[Sigma]2"}]], " ", "\[Rho]"}]}], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SuperscriptBox["\[Rho]", "2"]}], ")"}]}]], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"2", " ", "\[Pi]", " ", "\[Sigma]1", " ", "\[Sigma]2", 
          SqrtBox[
           RowBox[{"1", "-", " ", 
            SuperscriptBox["\[Rho]", "2"]}]]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Rho]", "\[Equal]", "1"}], " ", "&&", " ", 
          RowBox[{
           FractionBox[
            RowBox[{"\[Mu]1", "-", "x"}], "\[Sigma]1"], "\[Equal]", 
           FractionBox[
            RowBox[{"\[Mu]2", "-", "y"}], "\[Sigma]2"]}]}], ",", 
         RowBox[{"LogNormDensC", "[", 
          RowBox[{"\[Mu]1", ",", "\[Sigma]1", ",", "x"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Rho]", "\[Equal]", 
             RowBox[{"-", "1"}]}], " ", "&&", " ", 
            RowBox[{
             FractionBox[
              RowBox[{"\[Mu]1", "-", "x"}], "\[Sigma]1"], "\[Equal]", 
             FractionBox[
              RowBox[{"\[Mu]2", "-", "y"}], "\[Sigma]2"]}]}], ",", 
           RowBox[{"LogNormDensC", "[", 
            RowBox[{"\[Mu]1", ",", "\[Sigma]1", ",", "x"}], "]"}], ",", "0"}],
           "]"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.567510263001601*^9, 3.567510308881201*^9}, {
   3.5675104006716013`*^9, 3.567510405367201*^9}, {3.567510584314801*^9, 
   3.567510609586801*^9}, 3.568222669902218*^9, {3.5682227044331927`*^9, 
   3.5682227176649494`*^9}, {3.5682229155212665`*^9, 3.568222919856514*^9}, {
   3.5734861528558536`*^9, 3.5734861585499263`*^9}, {3.5734862285948243`*^9, 
   3.5734862598420253`*^9}, {3.573486290886423*^9, 3.5734863256904693`*^9}, 
   3.574413454130058*^9, {3.574413700108015*^9, 3.574413788467548*^9}, {
   3.5744138491055255`*^9, 3.5744138561724157`*^9}, 3.574413918733636*^9, {
   3.5745147673503017`*^9, 3.574514772872772*^9}, 3.574684984144478*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"biSymetricToFlatIndexC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i1", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j1", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "_Integer"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i1", ">=", "j1"}], ",", 
          RowBox[{
           RowBox[{"i", "=", "i1"}], ";", 
           RowBox[{"j", "=", "j1"}]}], ",", 
          RowBox[{
           RowBox[{"i", "=", "j1"}], ";", 
           RowBox[{"j", "=", "i1"}]}]}], "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", ">", "2"}], ",", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{"k", ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", 
               RowBox[{"i", "-", "2"}]}], "}"}]}], "]"}], "+", "j"}], ",", 
          "j"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "_Integer"}], "}"}]}], "}"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5681142417156916`*^9, 3.5681143021036787`*^9}, {
  3.5681143660640883`*^9, 3.5681143676084986`*^9}, {3.5681149960013323`*^9, 
  3.568115094250762*^9}, {3.568115128586582*^9, 3.5681151364646325`*^9}, {
  3.568115186416153*^9, 3.5681151904877787`*^9}, {3.5681176829917755`*^9, 
  3.568117683849781*^9}, {3.5681177570142508`*^9, 3.5681177991657205`*^9}, {
  3.5681178315827284`*^9, 3.568117837526366*^9}, {3.568117881877451*^9, 
  3.568117903280788*^9}, {3.5681179485366783`*^9, 3.5681179541995144`*^9}, {
  3.5681180315448103`*^9, 3.5681180909499907`*^9}, {3.5681181535843925`*^9, 
  3.5681181946906557`*^9}, {3.5682909653498077`*^9, 3.568291107734952*^9}, {
  3.575266952341748*^9, 3.5752670127145224`*^9}, {3.575267052791436*^9, 
  3.5752670978136134`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlatToSymetricIndexC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "_Integer"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"eps", ",", "i", ",", "j"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eps", "=", "k"}], ";", 
        RowBox[{"i", "=", "1"}], ";", 
        RowBox[{"j", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"eps", ">", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"eps", "=", 
            RowBox[{"eps", "-", 
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}]}]}], ";", 
           RowBox[{"i", "=", 
            RowBox[{"i", "+", "1"}]}]}]}], "]"}], ";", 
        RowBox[{"j", "=", "eps"}], ";", 
        RowBox[{"{", 
         RowBox[{"i", ",", "j"}], "}"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"eps", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "_Integer"}], "}"}]}], "}"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.568118229962482*^9, 3.5681182584482646`*^9}, {
   3.5681182902724686`*^9, 3.56811833892918*^9}, {3.5681183710341864`*^9, 
   3.5681184452906623`*^9}, {3.5681186440671363`*^9, 3.568118644160737*^9}, {
   3.5681187055003304`*^9, 3.568118722020836*^9}, {3.5681187671519256`*^9, 
   3.5681188146854305`*^9}, {3.5681188712669926`*^9, 3.568118875603821*^9}, {
   3.575267112852206*^9, 3.5752672433478794`*^9}, 3.5752840992815633`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LogMultivariateNormDensC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Sigma]", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Rho]", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"NbDim", ",", "\[CapitalSigma]", ",", "aa"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NbDim", "=", 
         RowBox[{"Length", "[", "\[Mu]", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[CapitalSigma]", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "\[Equal]", "j"}], ",", 
             RowBox[{
              RowBox[{"\[Sigma]", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"\[Sigma]", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"\[Rho]", "[", 
               RowBox[{"[", 
                RowBox[{"biSymetricToFlatIndexC", "[", 
                 RowBox[{"i", ",", "j", ",", "NbDim"}], "]"}], "]"}], 
               StyleBox["]",
                FontWeight->"Plain"]}], 
              RowBox[{"\[Sigma]", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", 
              RowBox[{"\[Sigma]", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NbDim"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "NbDim"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"-", "0.5"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Inverse", "[", "\[CapitalSigma]", "]"}], ".", 
              RowBox[{"(", 
               RowBox[{"x", "-", "\[Mu]"}], ")"}]}], ")"}], ".", 
            RowBox[{"(", 
             RowBox[{"x", "-", "\[Mu]"}], ")"}]}], "+", 
           RowBox[{"Log", "[", 
            RowBox[{"Det", "[", "\[CapitalSigma]", "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{"Length", "[", "\[CapitalSigma]", "]"}], 
            "1.837877066409345"}]}], ")"}]}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"NbDim", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[CapitalSigma]", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"biSymetricToFlatIndexC", "[", "_", "]"}], ",", "_Real"}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.575280250032214*^9, 3.575280380808691*^9}, {
  3.575280429014309*^9, 3.575280474878897*^9}, {3.5752805386525145`*^9, 
  3.5752805869195337`*^9}, {3.575280640147416*^9, 3.575280641894638*^9}, {
  3.5752806750294633`*^9, 3.5752806820807533`*^9}, {3.5752822703650956`*^9, 
  3.5752822852476864`*^9}, {3.5752823576014137`*^9, 3.575282357710615*^9}, {
  3.5752829891907215`*^9, 3.5752830416073933`*^9}, {3.5752834386588936`*^9, 
  3.5752834859118996`*^9}, {3.575283941594742*^9, 3.5752839519220743`*^9}, {
  3.5752839902049646`*^9, 3.5752839938554115`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"LogMultivariateNormDens", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.2", ",", "0.3", ",", "0.4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.3", ",", "0.3", ",", "0.4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.05", ",", 
       RowBox[{"-", "0.05"}], ",", "0.05"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.05", ",", 
       RowBox[{"-", "0.05"}], ",", "0.05"}], "}"}]}], "]"}], ",", 
   RowBox[{"LogMultivariateNormDensC", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.2", ",", "0.3", ",", "0.4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.3", ",", "0.3", ",", "0.4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.05", ",", 
       RowBox[{"-", "0.05"}], ",", "0.05"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.05", ",", 
       RowBox[{"-", "0.05"}], ",", "0.05"}], "}"}]}], "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.568291251641183*^9, 3.568291278438716*^9}, {
  3.5752677446915064`*^9, 3.5752677616177235`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.5616164875919429`"}], ",", "0.6107637299271635`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.568291269267191*^9, 3.5682912804698315`*^9}, 
   3.5682913246633596`*^9, {3.575267758700486*^9, 3.5752677628345394`*^9}, 
   3.5752678100719447`*^9, 3.57526856157081*^9, 3.575268604627362*^9, 
   3.5752687014734035`*^9, 3.5752688454008484`*^9, {3.575269050232475*^9, 
   3.5752690908553953`*^9}, 3.5752806486339245`*^9, 3.575280688274033*^9, 
   3.5752823126104374`*^9, 3.575282366806735*^9, {3.5752829988628454`*^9, 
   3.5752830352893124`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "=", "1"}], ",", 
     RowBox[{"y", "=", "0.5"}], ",", 
     RowBox[{"\[Mu]1", "=", "0.2"}], ",", 
     RowBox[{"\[Mu]2", "=", "0.1"}], ",", 
     RowBox[{"\[Sigma]1", "=", "0.3"}], ",", 
     RowBox[{"\[Sigma]2", "=", "0.6"}], ",", 
     RowBox[{"\[Rho]", "=", "0.1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"LogBivariateNormDensC", "[", 
      RowBox[{
      "x", ",", "y", ",", "\[Mu]1", ",", "\[Mu]2", ",", "\[Sigma]1", ",", 
       "\[Sigma]2", ",", "\[Rho]"}], "]"}], ",", 
     RowBox[{"LogMultivariateNormDens", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.2", ",", "0.1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.3", ",", "0.6"}], "}"}], ",", 
       RowBox[{"{", "0.1", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0.5"}], "}"}]}], "]"}], ",", 
     RowBox[{"LogMultivariateNormDensC", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.2", ",", "0.1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.3", ",", "0.6"}], "}"}], ",", 
       RowBox[{"{", "0.1", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0.5"}], "}"}]}], "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.575283138921441*^9, 3.575283207016314*^9}, {
  3.575283239277528*^9, 3.5752833342155547`*^9}, {3.575284258216401*^9, 
  3.575284260806034*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "3.7544171067543055`"}], ",", 
   RowBox[{"-", "3.7544171067543037`"}], ",", 
   RowBox[{"-", "3.7544171067543037`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.575283207889925*^9, {3.5752833154173136`*^9, 3.575283335713174*^9}, 
   3.575283573834627*^9, 3.5752836689178457`*^9, 3.5752839635286226`*^9, {
   3.5752841837098455`*^9, 3.5752841993256454`*^9}, 3.5752842627248583`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AddLogC", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", "_Real"}], "}"}]}], "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"a", "\[Equal]", "0"}], ",", "b", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"b", "\[Equal]", "0"}], ",", "a", ",", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "biggest", ",", "ap", ",", "bp", ",", "sum", ",", " ", 
              "logCutoff"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"biggest", "=", 
              RowBox[{"Max", "[", 
               RowBox[{"a", ",", "b"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"logCutoff", "=", 
              RowBox[{"-", "69.07755278982138"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"ap", "=", 
              RowBox[{"a", "-", "biggest"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"bp", "=", 
              RowBox[{"b", "-", "biggest"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"LogRC", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"ap", "<", "logCutoff"}], ",", "0.0", ",", 
                  RowBox[{"ExpRC", "[", "ap", "]"}]}], "]"}], "+", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"bp", "<", "logCutoff"}], ",", "0.0", ",", 
                  RowBox[{"ExpRC", "[", "bp", "]"}]}], "]"}]}], "]"}], "+", 
              "biggest"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}],
       ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ExpRC", "[", "_", "]"}], ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"LogRC", "[", "_", "]"}], ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ap", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"bp", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"logCutoff", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"biggest", ",", "_Real"}], "}"}]}], "}"}], ",", 
      RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
      RowBox[{"CompilationOptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], 
         ",", " ", 
         RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
        "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5735599208269873`*^9, 3.573559931029518*^9}, {
   3.573559973696065*^9, 3.5735599892806644`*^9}, {3.573560020496665*^9, 
   3.573560056299124*^9}, {3.573560147716296*^9, 3.5735603261513834`*^9}, {
   3.573563501613714*^9, 3.573563532548911*^9}, {3.574415175398984*^9, 
   3.5744152603888736`*^9}, {3.5744152958637285`*^9, 3.574415304521839*^9}, {
   3.574514794947055*^9, 3.574514836583989*^9}, 3.5745921161139927`*^9, {
   3.574592411742993*^9, 3.5745924973100896`*^9}, {3.5745927167113028`*^9, 
   3.5745927365703573`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CompilePrint", "[", "AddLogC", "]"}]], "Input",
 CellChangeTimes->{{3.5745921195304365`*^9, 3.5745921326346045`*^9}}],

Cell[BoxData["\<\"\\n\\t\\t2 arguments\\n\\t\\t4 Boolean registers\\n\\t\\t5 \
Integer registers\\n\\t\\t13 Real registers\\n\\t\\tUnderflow checking off\\n\
\\t\\tOverflow checking off\\n\\t\\tInteger overflow checking \
on\\n\\t\\tRuntimeAttributes -> {}\\n\\n\\t\\tR0 = A1\\n\\t\\tR1 = \
A2\\n\\t\\tI0 = 0\\n\\t\\tR12 = -1.23456789\\n\\t\\tI3 = 99\\n\\t\\tI2 = \
10\\n\\t\\tR3 = 7.\\n\\t\\tI1 = -1000\\n\\t\\tR4 = \
-69.07755278982138\\n\\t\\tR8 = 0.\\n\\t\\tResult = R10\\n\\n1\\tR2 = \
I0\\n2\\tB0 = R0 == R2 (tol R3)\\n3\\tif[ !B0] goto 6\\n4\\tR10 = \
R1\\n5\\tgoto 56\\n6\\tR2 = I0\\n7\\tB1 = R1 == R2 (tol R3)\\n8\\tif[ !B1] \
goto 11\\n9\\tR7 = R0\\n10\\tgoto 55\\n11\\tR2 = MaxR[ R0, R1]]\\n12\\tR5 = - \
R2\\n13\\tR6 = R0 + R5\\n14\\tR5 = - R2\\n15\\tR7 = R1 + R5\\n16\\tB2 = R6 < \
R4 (tol R3)\\n17\\tif[ !B2] goto 20\\n18\\tR5 = R8\\n19\\tgoto 29\\n20\\tR5 = \
R6\\n21\\tR9 = I1\\n22\\tB3 = R5 < R9 (tol R3)\\n23\\tif[ !B3] goto \
26\\n24\\tR10 = R8\\n25\\tgoto 28\\n26\\tR9 = Exp[ R5]\\n27\\tR10 = \
R9\\n28\\tR5 = R10\\n29\\tB2 = R7 < R4 (tol R3)\\n30\\tif[ !B2] goto \
33\\n31\\tR10 = R8\\n32\\tgoto 42\\n33\\tR10 = R7\\n34\\tR9 = I1\\n35\\tB3 = \
R10 < R9 (tol R3)\\n36\\tif[ !B3] goto 39\\n37\\tR11 = R8\\n38\\tgoto 41\\n39\
\\tR9 = Exp[ R10]\\n40\\tR11 = R9\\n41\\tR10 = R11\\n42\\tR5 = R5 + \
R10\\n43\\tR10 = I0\\n44\\tB2 = R5 == R10 (tol R3)\\n45\\tif[ !B2] goto \
51\\n46\\tI4 = Power[ I2, I3]\\n47\\tR11 = I4\\n48\\tR9 = R12 * \
R11\\n49\\tR10 = R9\\n50\\tgoto 53\\n51\\tR11 = Log[ R5]\\n52\\tR10 = \
R11\\n53\\tR10 = R10 + R2\\n54\\tR7 = R10\\n55\\tR10 = \
R7\\n56\\tReturn\\n\"\>"], "Output",
 CellChangeTimes->{{3.5745921268781304`*^9, 3.5745921336486173`*^9}, 
   3.57459250355017*^9, 3.574592748020904*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"AddLogC", "[", 
    RowBox[{"1", ",", "2.3"}], "]"}], ",", 
   RowBox[{"AddLog", "[", 
    RowBox[{"1", ",", "2.3"}], "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.574415327126529*^9, 3.5744153441775475`*^9}, {
  3.5744157278852773`*^9, 3.5744157386182146`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.541008453832992`", ",", "2.5410084538329922`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.574415345659567*^9, {3.574415732409335*^9, 3.574415739273423*^9}, 
   3.574514843995084*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize2C", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"M", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sum", ",", "l"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"l", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"M", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sum", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"M", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "l"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "l"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "/", 
           RowBox[{"sum", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}]}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sum", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "_Integer"}], "}"}]}], "}"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.570431844282255*^9, 3.5704319345132756`*^9}, 
   3.5704428612469387`*^9, {3.5744196710403814`*^9, 3.574419856433158*^9}, {
   3.574419900581724*^9, 3.574419935650974*^9}, 3.5744199697374105`*^9, {
   3.5744200110311403`*^9, 3.574420116036086*^9}, 3.574684994378209*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize2LogRC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"M", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sum", ",", "l"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"l", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"M", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sum", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"M", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "l"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "l"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"LogRC", "[", 
            RowBox[{"M", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "-", 
           RowBox[{"LogRC", "[", 
            RowBox[{"sum", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}]}]}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sum", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LogRC", "[", "_", "]"}], ",", "_Real"}], "}"}]}], "}"}], 
     ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.570431844282255*^9, 3.5704319345132756`*^9}, 
   3.5704428612469387`*^9, {3.5744196710403814`*^9, 3.574419856433158*^9}, {
   3.574419900581724*^9, 3.574419935650974*^9}, 3.5744199697374105`*^9, {
   3.5744200110311403`*^9, 3.574420116036086*^9}, {3.574587372660349*^9, 
   3.574587420147358*^9}, {3.574587459943468*^9, 3.5745874668387566`*^9}, {
   3.574587500410387*^9, 3.5745875085692916`*^9}, 3.5746850012734976`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "F", "}"}], ",", 
   RowBox[{
    RowBox[{"F", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"10.1", ",", "2.2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"30.3", ",", "4.4"}], "}"}]}], "}"}]}], ";", "\n", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"MNormalize2", "[", "F", "]"}], ",", 
      RowBox[{"MNormalize2C", "[", "F", "]"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5744202372496405`*^9, 3.5744202590119195`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.8211382113821137`", ",", "0.17886178861788618`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0.8731988472622478`", ",", "0.12680115273775217`"}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.8211382113821137`", ",", "0.17886178861788618`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0.8731988472622478`", ",", "0.12680115273775217`"}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.5744202555174747`*^9, 3.574420260244335*^9}, 
   3.57451485223199*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "F", "}"}], ",", 
   RowBox[{
    RowBox[{"F", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"10.1", ",", "2.2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"30.3", ",", "4.4"}], "}"}]}], "}"}]}], ";", "\n", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{"MNormalize2", "[", "F", "]"}], "]"}], ",", 
      RowBox[{"MNormalize2LogRC", "[", "F", "]"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5744202372496405`*^9, 3.5744202590119195`*^9}, {
  3.574587536306447*^9, 3.574587550097024*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.19706383853115814`"}], ",", 
       RowBox[{"-", "1.7211419020141017`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.13559197443749005`"}], ",", 
       RowBox[{"-", "2.065135146028598`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.19706383853115828`"}], ",", 
       RowBox[{"-", "1.7211419020141019`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.13559197443749005`"}], ",", 
       RowBox[{"-", "2.065135146028598`"}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.5744202555174747`*^9, 3.574420260244335*^9}, 
   3.57451485223199*^9, 3.5745875533418655`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "F", "}"}], ",", 
   RowBox[{
    RowBox[{"F", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"10.1", ",", "2.2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"30.3", ",", "4.4"}], "}"}]}], "}"}]}], ";", "\n", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Timing", "[", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"MNormalize2", "[", "F", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "100000"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{"Timing", "[", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"MNormalize2C", "[", "F", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "100000"}], "}"}]}], "]"}], "]"}]}], 
     "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.574420172072005*^9, 3.574420219824217*^9}, {
  3.574420280742998*^9, 3.5744202918035398`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.7330000000000005`", ",", "Null"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.24900000000000055`", ",", "Null"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5744202216494403`*^9, {3.5744202835042334`*^9, 3.574420293847166*^9}, 
   3.5745148560696387`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Fonctions auxiliaires", "Subsection",
 CellChangeTimes->{{3.602484557170435*^9, 3.602484567684902*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LogSumExpAuxC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"vec", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"biggest", ",", "vecp", ",", "sum", ",", " ", "logCutoff"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"biggest", "=", 
         RowBox[{"Max", "[", "vec", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"logCutoff", "=", 
         RowBox[{"-", "70.0"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vecp", "=", 
         RowBox[{"vec", "-", "biggest"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sum", "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"vecp", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "<", "logCutoff"}], ",", "0.0",
              ",", 
             RowBox[{"ExpRC", "[", 
              RowBox[{"vecp", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "vec", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"LogRC", "[", "sum", "]"}], "+", "biggest"}]}]}], "]"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ExpRC", "[", "_", "]"}], ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LogRC", "[", "_", "]"}], ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"biggest", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"logCutoff", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"vecp", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"sum", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"biggest", ",", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6035479680594473`*^9, 3.6035480254705954`*^9}, {
   3.6035488622683315`*^9, 3.6035488696584787`*^9}, {3.605264561611968*^9, 
   3.605264595339384*^9}, {3.6052646289419994`*^9, 3.6052646598613977`*^9}, {
   3.605264703136075*^9, 3.605264723322604*^9}, 3.605264794115858*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TensorLogSumExp2C", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tensor", " ", ",", " ", "_Real", ",", " ", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Integer", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"LogSumExpAuxC", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"tensor", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052651873787794`*^9, 3.605265333645317*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TensorLogSumExp3C", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tensor", " ", ",", " ", "_Real", ",", " ", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Integer", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"LogSumExpAuxC", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"tensor", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052651873787794`*^9, 3.605265333645317*^9}, {
  3.605265386233254*^9, 3.6052654595685315`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TensorLogSumExp4C", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tensor", " ", ",", " ", "_Real", ",", " ", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Integer", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"LogSumExpAuxC", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"tensor", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052651873787794`*^9, 3.605265333645317*^9}, {
   3.605265386233254*^9, 3.605265434811965*^9}, 3.605265477056244*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TensorLogSumExp5C", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tensor", " ", ",", " ", "_Real", ",", " ", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Integer", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"LogSumExpAuxC", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"tensor", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "m"}], "]"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052651873787794`*^9, 3.605265333645317*^9}, {
   3.605265386233254*^9, 3.605265437573183*^9}, 3.605265490019927*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TensorLogSumExp6C", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tensor", " ", ",", " ", "_Real", ",", " ", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Integer", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"LogSumExpAuxC", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"tensor", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "o"}], 
            "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"o", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052651873787794`*^9, 3.605265333645317*^9}, {
   3.605265386233254*^9, 3.605265440646408*^9}, 3.6052655051364236`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TensorLogSumExp7C", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tensor", " ", ",", " ", "_Real", ",", " ", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Integer", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"LogSumExpAuxC", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"tensor", "[", 
           RowBox[{"[", 
            RowBox[{
            "i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "o", ",", "p"}],
             "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"o", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052651873787794`*^9, 3.605265333645317*^9}, {
   3.605265386233254*^9, 3.605265388105266*^9}, {3.605265418728262*^9, 
   3.6052654434848285`*^9}, 3.605265520471322*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TensorLogSumExp8C", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tensor", " ", ",", " ", "_Real", ",", " ", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Integer", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"LogSumExpAuxC", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"tensor", "[", 
           RowBox[{"[", 
            RowBox[{
            "i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "o", ",", "p", 
             ",", "q"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"o", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "7", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "8", "]"}], "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052651873787794`*^9, 3.605265333645317*^9}, {
   3.605265386233254*^9, 3.605265388105266*^9}, {3.6052654214582796`*^9, 
   3.6052654458716435`*^9}, 3.6052655345114117`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TensorLogSumExpC", "[", "tensor_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rank", "=", 
       RowBox[{"TensorRank", "[", "tensor", "]"}]}], ",", 
      RowBox[{"dims", "=", 
       RowBox[{"Dimensions", "[", "tensor", "]"}]}]}], "}"}], ",", 
    RowBox[{"Switch", "[", 
     RowBox[{"rank", ",", "\[IndentingNewLine]", "1", ",", 
      RowBox[{"LogSumExpAuxC", "[", "tensor", "]"}], ",", 
      "\[IndentingNewLine]", "2", ",", 
      RowBox[{"TensorLogSumExp2C", "[", 
       RowBox[{"tensor", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", 
      "3", ",", 
      RowBox[{"TensorLogSumExp3C", "[", 
       RowBox[{"tensor", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", 
      "4", ",", 
      RowBox[{"TensorLogSumExp4C", "[", 
       RowBox[{"tensor", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", 
      "5", ",", 
      RowBox[{"TensorLogSumExp5C", "[", 
       RowBox[{"tensor", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", 
      "6", ",", 
      RowBox[{"TensorLogSumExp6C", "[", 
       RowBox[{"tensor", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", 
      "7", ",", 
      RowBox[{"TensorLogSumExp7C", "[", 
       RowBox[{"tensor", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", 
      "8", ",", 
      RowBox[{"TensorLogSumExp8C", "[", 
       RowBox[{"tensor", ",", "dims"}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052648343329163`*^9, 3.605264881086416*^9}, {
   3.6052655575527596`*^9, 3.6052656348512554`*^9}, 3.6052656955200443`*^9, {
   3.6052657263302417`*^9, 3.605265744020755*^9}, 3.6052658176316323`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize1AC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "1"}], "}"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     FractionBox["M", 
      RowBox[{"Plus", "@@", "M"}]], "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052701092112174`*^9, 3.605270140707819*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize2AC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "2"}], "}"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"M", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
        RowBox[{"Plus", "@@", 
         RowBox[{
         "M", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052701092112174`*^9, 3.605270207710249*^9}, 
   3.6052702809215183`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize3AC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "3"}], "}"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"M", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], 
        RowBox[{"Plus", "@@", 
         RowBox[{"M", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}]], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052701092112174`*^9, 3.605270231282*^9}, 
   3.6052717082003937`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize4AC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "4"}], "}"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"M", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j", ",", "k"}], "\[RightDoubleBracket]"}], 
        RowBox[{"Plus", "@@", 
         RowBox[{"M", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j", ",", "k"}], "\[RightDoubleBracket]"}]}]], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052701092112174`*^9, 3.6052702376000404`*^9}, 
   3.605271720540073*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize5AC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "5"}], "}"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"M", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j", ",", "k", ",", "l"}], 
         "\[RightDoubleBracket]"}], 
        RowBox[{"Plus", "@@", 
         RowBox[{"M", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], 
          "\[RightDoubleBracket]"}]}]], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052701092112174`*^9, 3.605270244089682*^9}, 
   3.605271745359832*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize6AC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "6"}], "}"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"M", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "m"}], 
         "\[RightDoubleBracket]"}], 
        RowBox[{"Plus", "@@", 
         RowBox[{"M", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "m"}], 
          "\[RightDoubleBracket]"}]}]], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052701092112174`*^9, 3.605270214496292*^9}, {
   3.605270246726099*^9, 3.605270250298522*^9}, 3.6052717580895133`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize7AC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "7"}], "}"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"M", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "n"}], 
         "\[RightDoubleBracket]"}], 
        RowBox[{"Plus", "@@", 
         RowBox[{"M", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "n"}], 
          "\[RightDoubleBracket]"}]}]], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052701092112174`*^9, 3.605270216009502*^9}, {
   3.605270252841338*^9, 3.6052702571625657`*^9}, 3.6052717679019766`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize8AC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "8"}], "}"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"M", "\[LeftDoubleBracket]", 
         RowBox[{
         "i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "n", ",", "o"}], 
         "\[RightDoubleBracket]"}], 
        RowBox[{"Plus", "@@", 
         RowBox[{"M", "\[LeftDoubleBracket]", 
          RowBox[{
          "i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "n", ",", "o"}], 
          "\[RightDoubleBracket]"}]}]], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"o", ",", "1", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "M", "]"}], "[", 
          RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052701092112174`*^9, 3.6052702176163125`*^9}, {
   3.6052702600953846`*^9, 3.605270263153004*^9}, 3.605271776622432*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalizeC", "[", "M_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"HDim", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "M", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"Switch", "[", 
     RowBox[{"HDim", ",", "\[IndentingNewLine]", "1", ",", 
      RowBox[{"MNormalize1AC", "[", "M", "]"}], ",", "\[IndentingNewLine]", 
      "2", ",", 
      RowBox[{"MNormalize2AC", "[", "M", "]"}], ",", "\[IndentingNewLine]", 
      "3", ",", 
      RowBox[{"MNormalize3AC", "[", "M", "]"}], ",", "\[IndentingNewLine]", 
      "4", ",", 
      RowBox[{"MNormalize4AC", "[", "M", "]"}], ",", "\[IndentingNewLine]", 
      "5", ",", 
      RowBox[{"MNormalize5AC", "[", "M", "]"}], ",", "\[IndentingNewLine]", 
      "6", ",", 
      RowBox[{"MNormalize6AC", "[", "M", "]"}], ",", "\[IndentingNewLine]", 
      "7", ",", 
      RowBox[{"MNormalize7AC", "[", "M", "]"}], ",", "\[IndentingNewLine]", 
      "8", ",", 
      RowBox[{"MNormalize8AC", "[", "M", "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6022452496014614`*^9, 3.602245281322096*^9}, {
   3.6042438697637978`*^9, 3.604243912804474*^9}, {3.604574155274143*^9, 
   3.60457425381878*^9}, 3.6052699328832874`*^9, {3.6052699798707886`*^9, 
   3.6052700712249737`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize1LogAC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "1"}], "}"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"M", "-", 
      RowBox[{"LogSumExpC", "[", "M", "]"}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052701092112174`*^9, 3.605270140707819*^9}, {
  3.6052719344850492`*^9, 3.605271954655979*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize2LogAC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "2"}], "}"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"M", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
        "-", 
        RowBox[{"LogSumExpC", "[", 
         RowBox[{"M", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052701092112174`*^9, 3.605270207710249*^9}, 
   3.6052702809215183`*^9, 3.6052719307722263`*^9, {3.605271967791263*^9, 
   3.6052719709892836`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize3LogAC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "3"}], "}"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"M", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "-", 
        RowBox[{"LogSumExpC", "[", 
         RowBox[{"M", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052701092112174`*^9, 3.605270231282*^9}, 
   3.6052717082003937`*^9, 3.605271929118615*^9, {3.605271984810972*^9, 
   3.6052719887421975`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize4LogAC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "4"}], "}"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"M", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j", ",", "k"}], "\[RightDoubleBracket]"}], "-", 
        RowBox[{"LogSumExpC", "[", 
         RowBox[{"M", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j", ",", "k"}], "\[RightDoubleBracket]"}], 
         "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052701092112174`*^9, 3.6052702376000404`*^9}, 
   3.605271720540073*^9, 3.605271926201397*^9, {3.6052720007542744`*^9, 
   3.6052720040458956`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize5LogAC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "5"}], "}"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"M", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j", ",", "k", ",", "l"}], 
         "\[RightDoubleBracket]"}], "-", 
        RowBox[{"LogSumExpC", "[", 
         RowBox[{"M", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], 
          "\[RightDoubleBracket]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052701092112174`*^9, 3.605270244089682*^9}, 
   3.605271745359832*^9, 3.605271924578986*^9, {3.605272017383981*^9, 
   3.6052720216272087`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize6LogAC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "6"}], "}"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"M", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "m"}], 
         "\[RightDoubleBracket]"}], "-", 
        RowBox[{"LogSumExpC", "[", 
         RowBox[{"M", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "m"}], 
          "\[RightDoubleBracket]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052701092112174`*^9, 3.605270214496292*^9}, {
   3.605270246726099*^9, 3.605270250298522*^9}, 3.6052717580895133`*^9, 
   3.6052719217865686`*^9, {3.6052720368841057`*^9, 3.605272039816925*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize7LogAC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "7"}], "}"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"M", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "n"}], 
         "\[RightDoubleBracket]"}], "-", 
        RowBox[{"LogSumExpC", "[", 
         RowBox[{"M", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "n"}], 
          "\[RightDoubleBracket]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052701092112174`*^9, 3.605270216009502*^9}, {
   3.605270252841338*^9, 3.6052702571625657`*^9}, 3.6052717679019766`*^9, 
   3.6052719199613566`*^9, {3.605272055245424*^9, 3.60527205933265*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize8LogAC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "8"}], "}"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"M", "\[LeftDoubleBracket]", 
         RowBox[{
         "i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "n", ",", "o"}], 
         "\[RightDoubleBracket]"}], "-", 
        RowBox[{"LogSumExpC", "[", 
         RowBox[{"M", "\[LeftDoubleBracket]", 
          RowBox[{
          "i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "n", ",", "o"}], 
          "\[RightDoubleBracket]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"o", ",", "1", ",", 
         RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052701092112174`*^9, 3.6052702176163125`*^9}, {
   3.6052702600953846`*^9, 3.605270263153004*^9}, 3.605271776622432*^9, 
   3.6052719183857465`*^9, {3.6052720737939425`*^9, 3.605272077257165*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalizeLogAC", "[", "M_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"HDim", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "M", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"Switch", "[", 
     RowBox[{"HDim", ",", "\[IndentingNewLine]", "1", ",", 
      RowBox[{"MNormalize1LogAC", "[", "M", "]"}], ",", "\[IndentingNewLine]",
       "2", ",", 
      RowBox[{"MNormalize2LogAC", "[", "M", "]"}], ",", "\[IndentingNewLine]",
       "3", ",", 
      RowBox[{"MNormalize3LogAC", "[", "M", "]"}], ",", "\[IndentingNewLine]",
       "4", ",", 
      RowBox[{"MNormalize4LogAC", "[", "M", "]"}], ",", "\[IndentingNewLine]",
       "5", ",", 
      RowBox[{"MNormalize5LogAC", "[", "M", "]"}], ",", "\[IndentingNewLine]",
       "6", ",", 
      RowBox[{"MNormalize6LogAC", "[", "M", "]"}], ",", "\[IndentingNewLine]",
       "7", ",", 
      RowBox[{"MNormalize7LogAC", "[", "M", "]"}], ",", "\[IndentingNewLine]",
       "8", ",", 
      RowBox[{"MNormalize8LogAC", "[", "M", "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6022452496014614`*^9, 3.602245281322096*^9}, {
   3.6042438697637978`*^9, 3.604243912804474*^9}, {3.604574155274143*^9, 
   3.60457425381878*^9}, 3.6052699328832874`*^9, {3.6052699798707886`*^9, 
   3.6052700712249737`*^9}, {3.6052718878875513`*^9, 3.605271915031725*^9}, 
   3.605272136958748*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize1Log1AC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"LogRC1", "[", "M", "]"}], "-", 
      RowBox[{"LogRC", "[", 
       RowBox[{"Plus", "@@", "M"}], "]"}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605272293006548*^9, 3.6052723279039717`*^9}, 
   3.605272468492073*^9, 3.6052733163727136`*^9, {3.605273584741234*^9, 
   3.6052736063785725`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize2Log1AC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"LogRC1", "[", 
         RowBox[{"M", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         "]"}], "-", 
        RowBox[{"LogRC", "[", 
         RowBox[{"Plus", "@@", 
          RowBox[{
          "M", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605272293006548*^9, 3.605272335017617*^9}, 
   3.605272478819339*^9, {3.6052725600178595`*^9, 3.6052725617182703`*^9}, {
   3.60527331116228*^9, 3.6052733320040135`*^9}, 3.6052736304183264`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize3Log1AC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"LogRC1", "[", 
         RowBox[{"M", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "]"}], "-", 
        RowBox[{"LogRC", "[", 
         RowBox[{"Plus", "@@", 
          RowBox[{"M", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605272293006548*^9, 3.6052723055958285`*^9}, {
   3.6052723390580435`*^9, 3.6052723480281005`*^9}, 3.605272487009392*^9, {
   3.6052725634498816`*^9, 3.605272569752322*^9}, {3.605273308541463*^9, 
   3.6052733409584713`*^9}, 3.605273650636056*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize4Log1AC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"LogRC1", "[", 
         RowBox[{"M", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j", ",", "k"}], "\[RightDoubleBracket]"}], "]"}],
         "-", 
        RowBox[{"LogRC", "[", 
         RowBox[{"Plus", "@@", 
          RowBox[{"M", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j", ",", "k"}], "\[RightDoubleBracket]"}]}], 
         "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605272293006548*^9, 3.6052723055958285`*^9}, {
   3.6052723509141192`*^9, 3.605272354065339*^9}, 3.60527249611985*^9, {
   3.6052725718739357`*^9, 3.6052725736523466`*^9}, {3.6052732776064653`*^9, 
   3.6052732873721275`*^9}, {3.6052733457321014`*^9, 3.6052733540001545`*^9}, 
   3.6052736652845497`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize5Log1AC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"LogRC1", "[", 
         RowBox[{"M", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], 
          "\[RightDoubleBracket]"}], "]"}], "-", 
        RowBox[{"LogRC", "[", 
         RowBox[{"Plus", "@@", 
          RowBox[{"M", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j", ",", "k", ",", "l"}], 
           "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605272293006548*^9, 3.6052723055958285`*^9}, {
   3.6052723567953568`*^9, 3.6052723597437754`*^9}, 3.605272507679524*^9, {
   3.6052725781295757`*^9, 3.605272579923587*^9}, 3.605273295671381*^9, {
   3.605273361925006*^9, 3.605273374779488*^9}, 3.6052736703857827`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize6Log1AC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"LogRC1", "[", 
         RowBox[{"M", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "m"}], 
          "\[RightDoubleBracket]"}], "]"}], "-", 
        RowBox[{"LogRC", "[", 
         RowBox[{"Plus", "@@", 
          RowBox[{"M", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "m"}], 
           "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605272293006548*^9, 3.6052723055958285`*^9}, {
   3.6052723621929913`*^9, 3.605272365391012*^9}, 3.605272516727582*^9, {
   3.605272582404003*^9, 3.6052725862260275`*^9}, 3.605273297449792*^9, {
   3.605273380754326*^9, 3.605273397805236*^9}, 3.605273674769411*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize7Log1AC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"LogRC1", "[", 
         RowBox[{"M", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "n"}], 
          "\[RightDoubleBracket]"}], "]"}], "-", 
        RowBox[{"LogRC", "[", 
         RowBox[{"Plus", "@@", 
          RowBox[{"M", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "n"}], 
           "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605272293006548*^9, 3.6052723055958285`*^9}, {
   3.605272368511032*^9, 3.605272371865053*^9}, 3.60527252582244*^9, {
   3.6052725887532434`*^9, 3.605272590952858*^9}, 3.6052732996494064`*^9, {
   3.605273405246483*^9, 3.6052734240446033`*^9}, 3.605273679636642*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize8Log1AC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"LogRC1", "[", 
         RowBox[{"M", "\[LeftDoubleBracket]", 
          RowBox[{
          "i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "n", ",", "o"}], 
          "\[RightDoubleBracket]"}], "]"}], "-", 
        RowBox[{"LogRC", "[", 
         RowBox[{"Plus", "@@", 
          RowBox[{"M", "\[LeftDoubleBracket]", 
           RowBox[{
           "i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "n", ",", "o"}], 
           "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"o", ",", "1", ",", 
         RowBox[{"dims", "[", 
          RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605272293006548*^9, 3.6052723055958285`*^9}, 
   3.6052725351357*^9, {3.605272596568894*^9, 3.6052725988465085`*^9}, 
   3.6052733015370183`*^9, {3.605273430939848*^9, 3.6052734522651844`*^9}, 
   3.6052736933491297`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalizeLog1AC", "[", "M_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"HDim", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"Dimensions", "[", "M", "]"}], "]"}]}], ",", 
      RowBox[{"dims", "=", 
       RowBox[{"Dimensions", "[", "M", "]"}]}]}], "}"}], ",", 
    RowBox[{"Switch", "[", 
     RowBox[{"HDim", ",", "\[IndentingNewLine]", "1", ",", 
      RowBox[{"MNormalize1Log1AC", "[", 
       RowBox[{"M", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", "2", 
      ",", 
      RowBox[{"MNormalize2Log1AC", "[", 
       RowBox[{"M", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", "3", 
      ",", 
      RowBox[{"MNormalize3Log1AC", "[", 
       RowBox[{"M", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", "4", 
      ",", 
      RowBox[{"MNormalize4Log1AC", "[", 
       RowBox[{"M", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", "5", 
      ",", 
      RowBox[{"MNormalize5Log1AC", "[", 
       RowBox[{"M", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", "6", 
      ",", 
      RowBox[{"MNormalize6Log1AC", "[", 
       RowBox[{"M", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", "7", 
      ",", 
      RowBox[{"MNormalize7Log1AC", "[", 
       RowBox[{"M", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", "8", 
      ",", 
      RowBox[{"MNormalize8Log1AC", "[", 
       RowBox[{"M", ",", "dims"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6022452496014614`*^9, 3.602245281322096*^9}, {
   3.603538272594675*^9, 3.6035384210773783`*^9}, {3.6042439941433954`*^9, 
   3.6042440412559605`*^9}, {3.6045574553249607`*^9, 
   3.6045575104411135`*^9}, {3.6045729602477913`*^9, 
   3.6045730795816174`*^9}, {3.6052721684241495`*^9, 
   3.6052722534446945`*^9}, {3.605272388245158*^9, 3.605272435591462*^9}, {
   3.6052732097772303`*^9, 3.6052732535823107`*^9}, 3.6052734650416665`*^9, {
   3.605273700088373*^9, 3.6052737105248404`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FNormalize1Log", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "norm", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"norm", "=", 
         RowBox[{"LogSumExpC", "[", "M", "]"}]}], ";", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ExpRC", "[", 
           RowBox[{
            RowBox[{"M", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", "norm"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052738824223423`*^9, 3.605273893342412*^9}, {
   3.6052739765845456`*^9, 3.605273998720693*^9}, 3.605274029640091*^9, {
   3.6052741387795973`*^9, 3.60527414077641*^9}, {3.6052743820803623`*^9, 
   3.60527445294202*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FNormalize2Log", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "norm", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"norm", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"LogSumExpC", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"M", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{"dims", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ExpRC", "[", 
           RowBox[{
            RowBox[{"M", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "-", 
            RowBox[{"norm", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052738824223423`*^9, 3.605273923903008*^9}, {
  3.6052740087515574`*^9, 3.60527405439745*^9}, {3.6052741428824244`*^9, 
  3.605274144645235*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FNormalize3Log", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "norm", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"norm", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"LogSumExpC", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"M", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", 
                RowBox[{"dims", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ExpRC", "[", 
           RowBox[{
            RowBox[{"M", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "-", 
            RowBox[{"norm", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052738824223423`*^9, 3.605273893342412*^9}, {
   3.605273926539425*^9, 3.6052739299870467`*^9}, {3.6052740096563635`*^9, 
   3.605274032853712*^9}, 3.60527406378871*^9, {3.6052741468448496`*^9, 
   3.605274150526473*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FNormalize4Log", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "norm", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"norm", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"LogSumExpC", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"M", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "1", ",", 
                RowBox[{"dims", "[", 
                 RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ExpRC", "[", 
           RowBox[{
            RowBox[{"M", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}], "-", 
            RowBox[{"norm", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052738824223423`*^9, 3.605273893342412*^9}, {
   3.6052739327014647`*^9, 3.605273935930685*^9}, {3.6052740106391697`*^9, 
   3.605274034304521*^9}, 3.605274073757174*^9, {3.6052741533968916`*^9, 
   3.6052741554249043`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FNormalize5Log", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "norm", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"norm", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"LogSumExpC", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"M", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "o"}], "]"}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"o", ",", "1", ",", 
                RowBox[{"dims", "[", 
                 RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ExpRC", "[", 
           RowBox[{
            RowBox[{"M", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "o"}], "]"}], 
             "]"}], "-", 
            RowBox[{"norm", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052738824223423`*^9, 3.605273893342412*^9}, {
   3.6052739385827017`*^9, 3.605273941811923*^9}, {3.605274011528375*^9, 
   3.6052740359269314`*^9}, 3.605274084365242*^9, {3.605274158981727*^9, 
   3.605274161087741*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FNormalize6Log", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "norm", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"norm", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"LogSumExpC", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"M", "[", 
               RowBox[{"[", 
                RowBox[{
                "i", ",", "j", ",", "k", ",", "l", ",", "o", ",", "p"}], 
                "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"p", ",", "1", ",", 
                RowBox[{"dims", "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ExpRC", "[", 
           RowBox[{
            RowBox[{"M", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "o", ",", "p"}],
               "]"}], "]"}], "-", 
            RowBox[{"norm", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "o"}], "]"}], 
             "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"p", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052738824223423`*^9, 3.605273893342412*^9}, {
   3.60527394447954*^9, 3.6052739477243605`*^9}, {3.605274012433181*^9, 
   3.605274037377741*^9}, 3.605274095456913*^9, {3.6052741636929574`*^9, 
   3.6052741655181694`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FNormalize7Log", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "norm", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"norm", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"LogSumExpC", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"M", "[", 
               RowBox[{"[", 
                RowBox[{
                "i", ",", "j", ",", "k", ",", "l", ",", "o", ",", "p", ",", 
                 "q"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"q", ",", "1", ",", 
                RowBox[{"dims", "[", 
                 RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"p", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ExpRC", "[", 
           RowBox[{
            RowBox[{"M", "[", 
             RowBox[{"[", 
              RowBox[{
              "i", ",", "j", ",", "k", ",", "l", ",", "o", ",", "p", ",", 
               "q"}], "]"}], "]"}], "-", 
            RowBox[{"norm", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "o", ",", "p"}],
               "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"p", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052738824223423`*^9, 3.605273893342412*^9}, {
   3.605273951187583*^9, 3.6052739539020004`*^9}, {3.605274013681189*^9, 
   3.605274039109352*^9}, 3.6052741065953846`*^9, {3.605274168263787*^9, 
   3.6052741704010005`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FNormalize8Log", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "norm", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"norm", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"LogSumExpC", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"M", "[", 
               RowBox[{"[", 
                RowBox[{
                "i", ",", "j", ",", "k", ",", "l", ",", "o", ",", "p", ",", 
                 "q", ",", "r"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"r", ",", "1", ",", 
                RowBox[{"dims", "[", 
                 RowBox[{"[", "8", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"p", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"q", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ExpRC", "[", 
           RowBox[{
            RowBox[{"M", "[", 
             RowBox[{"[", 
              RowBox[{
              "i", ",", "j", ",", "k", ",", "l", ",", "o", ",", "p", ",", "q",
                ",", "r"}], "]"}], "]"}], "-", 
            RowBox[{"norm", "[", 
             RowBox[{"[", 
              RowBox[{
              "i", ",", "j", ",", "k", ",", "l", ",", "o", ",", "p", ",", 
               "q"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"p", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "1", ",", 
            RowBox[{"dims", "[", 
             RowBox[{"[", "8", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052738824223423`*^9, 3.605273893342412*^9}, {
   3.605273956226415*^9, 3.605273959440036*^9}, {3.6052740146639953`*^9, 
   3.6052740405757613`*^9}, 3.605274115752643*^9, {3.6052741726006145`*^9, 
   3.6052741745506268`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FNormalizeLogC", "[", "M_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"HDim", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"Dimensions", "[", "M", "]"}], "]"}]}], ",", 
      RowBox[{"dims", "=", 
       RowBox[{"Dimensions", "[", "M", "]"}]}]}], "}"}], ",", 
    RowBox[{"Switch", "[", 
     RowBox[{"HDim", ",", "\[IndentingNewLine]", "1", ",", 
      RowBox[{"FNormalize1Log", "[", 
       RowBox[{"M", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", "2", 
      ",", 
      RowBox[{"FNormalize2Log", "[", 
       RowBox[{"M", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", "3", 
      ",", 
      RowBox[{"FNormalize3Log", "[", 
       RowBox[{"M", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", "4", 
      ",", 
      RowBox[{"FNormalize4Log", "[", 
       RowBox[{"M", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", "5", 
      ",", 
      RowBox[{"FNormalize5Log", "[", 
       RowBox[{"M", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", "6", 
      ",", 
      RowBox[{"FNormalize6Log", "[", 
       RowBox[{"M", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", "7", 
      ",", 
      RowBox[{"FNormalize7Log", "[", 
       RowBox[{"M", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", "8", 
      ",", 
      RowBox[{"FNormalize8Log", "[", 
       RowBox[{"M", ",", "dims"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60527381807193*^9, 3.6052738554185686`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FNormalize1", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "norm", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"norm", "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        FractionBox["M", "norm"]}]}], "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052738824223423`*^9, 3.605273893342412*^9}, {
   3.6052739765845456`*^9, 3.605273998720693*^9}, 3.605274029640091*^9, {
   3.6052741387795973`*^9, 3.60527414077641*^9}, {3.6052743820803623`*^9, 
   3.60527445294202*^9}, 3.6053338876557627`*^9, 3.6053339263440104`*^9, 
   3.6053339966380615`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FNormalize2", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "norm", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"norm", "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        FractionBox["M", "norm"]}]}], "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052738824223423`*^9, 3.605273923903008*^9}, {
   3.6052740087515574`*^9, 3.60527405439745*^9}, {3.6052741428824244`*^9, 
   3.605274144645235*^9}, 3.6053338948162084`*^9, 3.6053339291052284`*^9, 
   3.6053345888022575`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FNormalize3", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "norm", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"norm", "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        FractionBox["M", "norm"]}]}], "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052738824223423`*^9, 3.605273893342412*^9}, {
   3.605273926539425*^9, 3.6052739299870467`*^9}, {3.6052740096563635`*^9, 
   3.605274032853712*^9}, 3.60527406378871*^9, {3.6052741468448496`*^9, 
   3.605274150526473*^9}, 3.605333903755066*^9, 3.6053339344872627`*^9, 
   3.6053345996443267`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FNormalize4", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "norm", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"norm", "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        FractionBox["M", "norm"]}]}], "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052738824223423`*^9, 3.605273893342412*^9}, {
   3.6052739327014647`*^9, 3.605273935930685*^9}, {3.6052740106391697`*^9, 
   3.605274034304521*^9}, 3.605274073757174*^9, {3.6052741533968916`*^9, 
   3.6052741554249043`*^9}, 3.6053339070934873`*^9, 3.60533393710808*^9, 
   3.6053346158528304`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FNormalize5", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "norm", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"norm", "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "o"}], "]"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        FractionBox["M", "norm"]}]}], "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052738824223423`*^9, 3.605273893342412*^9}, {
   3.6052739385827017`*^9, 3.605273941811923*^9}, {3.605274011528375*^9, 
   3.6052740359269314`*^9}, 3.605274084365242*^9, {3.605274158981727*^9, 
   3.605274161087741*^9}, 3.6053339097767043`*^9, 3.605333940103299*^9, 
   3.6053346269289017`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FNormalize6", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "norm", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"norm", "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "l", ",", "o", ",", "p"}], 
             "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"p", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        FractionBox["M", "norm"]}]}], "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052738824223423`*^9, 3.605273893342412*^9}, {
   3.60527394447954*^9, 3.6052739477243605`*^9}, {3.605274012433181*^9, 
   3.605274037377741*^9}, 3.605274095456913*^9, {3.6052741636929574`*^9, 
   3.6052741655181694`*^9}, 3.605333912849924*^9, 3.6053339433481197`*^9, 
   3.605334638519776*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FNormalize7", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "norm", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"norm", "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"[", 
             RowBox[{
             "i", ",", "j", ",", "k", ",", "l", ",", "o", ",", "p", ",", 
              "q"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"p", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"q", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        FractionBox["M", "norm"]}]}], "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052738824223423`*^9, 3.605273893342412*^9}, {
   3.605273951187583*^9, 3.6052739539020004`*^9}, {3.605274013681189*^9, 
   3.605274039109352*^9}, 3.6052741065953846`*^9, {3.605274168263787*^9, 
   3.6052741704010005`*^9}, 3.6053339161727457`*^9, 3.6053339464057393`*^9, 
   3.605334650999856*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FNormalize8", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"M", " ", ",", " ", "_Real", ",", " ", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "norm", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"norm", "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"[", 
             RowBox[{
             "i", ",", "j", ",", "k", ",", "l", ",", "o", ",", "p", ",", "q", 
              ",", "r"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"o", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"p", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"q", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "7", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"r", ",", "1", ",", 
             RowBox[{"dims", "[", 
              RowBox[{"[", "8", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        FractionBox["M", "norm"]}]}], "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6052738824223423`*^9, 3.605273893342412*^9}, {
   3.605273956226415*^9, 3.605273959440036*^9}, {3.6052740146639953`*^9, 
   3.6052740405757613`*^9}, 3.605274115752643*^9, {3.6052741726006145`*^9, 
   3.6052741745506268`*^9}, {3.605333920743575*^9, 3.6053339487769547`*^9}, 
   3.6053346621851273`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FNormalizeC", "[", "M_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"HDim", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"Dimensions", "[", "M", "]"}], "]"}]}], ",", 
      RowBox[{"dims", "=", 
       RowBox[{"Dimensions", "[", "M", "]"}]}]}], "}"}], ",", 
    RowBox[{"Switch", "[", 
     RowBox[{"HDim", ",", "\[IndentingNewLine]", "1", ",", 
      RowBox[{"FNormalize1", "[", 
       RowBox[{"M", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", "2", 
      ",", 
      RowBox[{"FNormalize2", "[", 
       RowBox[{"M", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", "3", 
      ",", 
      RowBox[{"FNormalize3", "[", 
       RowBox[{"M", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", "4", 
      ",", 
      RowBox[{"FNormalize4", "[", 
       RowBox[{"M", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", "5", 
      ",", 
      RowBox[{"FNormalize5", "[", 
       RowBox[{"M", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", "6", 
      ",", 
      RowBox[{"FNormalize6", "[", 
       RowBox[{"M", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", "7", 
      ",", 
      RowBox[{"FNormalize7", "[", 
       RowBox[{"M", ",", "dims"}], "]"}], ",", "\[IndentingNewLine]", "8", 
      ",", 
      RowBox[{"FNormalize8", "[", 
       RowBox[{"M", ",", "dims"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60527381807193*^9, 3.6052738554185686`*^9}, {
  3.6053337457419815`*^9, 3.6053337703121386`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["BuildMatrixFromLocalCliqueTensor", "Subsection",
 CellChangeTimes->{3.603605552879614*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FromSparseToFlatC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"indexList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dimList", " ", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"value", " ", ",", " ", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", "ind", ",", "nb"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nb", "=", 
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"dimList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "dimList", "]"}]}], "}"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"v", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "nb"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ind", "=", 
         RowBox[{"FromSparseToFlatIndex", "[", 
          RowBox[{"indexList", ",", "dimList"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", "ind", "]"}], "]"}], "=", "value"}], ";", "v"}]}], 
      "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ind", ",", " ", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nb", ",", " ", "_Integer"}], "}"}]}], "}"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.600886047118196*^9, 3.6008860659222717`*^9}, {
   3.6008861225055075`*^9, 3.6008863512505913`*^9}, {3.6008863970162086`*^9, 
   3.600886412874116*^9}, {3.6008864585477285`*^9, 3.6008865293307767`*^9}, {
   3.6008877380659122`*^9, 3.6008877386179442`*^9}, {3.600887769907734*^9, 
   3.6008877728269005`*^9}, {3.6053347347306147`*^9, 
   3.6053348246651917`*^9}, {3.6053348766291246`*^9, 3.605334910715343*^9}, {
   3.6053350033955374`*^9, 3.605335005080348*^9}, {3.605335321512382*^9, 
   3.6053353577982144`*^9}, {3.6053354275618615`*^9, 
   3.6053354587152615`*^9}, {3.605335544640612*^9, 3.605335548322236*^9}, {
   3.605335604031798*^9, 3.605335623500723*^9}, 3.60533565746214*^9, {
   3.6053356879603357`*^9, 3.60533570265563*^9}, {3.6053357529191523`*^9, 
   3.605335805148287*^9}, {3.6053358855356026`*^9, 3.6053359138185835`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FromSparseToFlatIndexC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"indexList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dimList", " ", ",", "_Integer", ",", "1"}], "}"}]}], "}"}], 
     ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "res", "}"}], ",", 
       RowBox[{
        RowBox[{"res", "=", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"indexList", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "-", "1"}], ")"}], "*", " ", 
             RowBox[{"Product", "[", 
              RowBox[{
               RowBox[{"dimList", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", 
                 RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "dimList", "]"}]}], "}"}]}], "]"}], "+", 
          "1"}]}], ";", "res"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"res", ",", "_Integer"}], "}"}], "}"}], "\[IndentingNewLine]", 
     ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6008865481878557`*^9, 3.600886556906354*^9}, {
   3.6008870689026384`*^9, 3.6008871407577486`*^9}, {3.60088717103148*^9, 
   3.6008872527571545`*^9}, {3.600887359052234*^9, 3.6008873884259143`*^9}, {
   3.6053349243342304`*^9, 3.6053349614936686`*^9}, {3.6053472703885293`*^9, 
   3.605347317438431*^9}, 3.605347399182955*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FromSparseToFlatIndexC", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6008872812187824`*^9, 3.600887329404538*^9}, {
   3.600887399243533*^9, 3.6008874550477247`*^9}, 3.605334969246918*^9}],

Cell[BoxData["6.`"], "Output",
 CellChangeTimes->{
  3.6008873039490824`*^9, {3.6008873672257013`*^9, 3.6008874556157575`*^9}, 
   3.6009466498593965`*^9, 3.6018150281752357`*^9, 3.6053349717897344`*^9, 
   3.605347326236887*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"FromSparseToFlatC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"indexList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dimList", " ", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"value", " ", ",", " ", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", "ind", ",", "nb"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nb", "=", 
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"dimList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "dimList", "]"}]}], "}"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"v", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "nb"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ind", "=", 
         RowBox[{"Floor", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"indexList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "-", "1"}], ")"}], "*", " ", 
              RowBox[{"Product", "[", 
               RowBox[{
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", 
                  RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "dimList", "]"}]}], "}"}]}], "]"}], "+",
            "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", "ind", "]"}], "]"}], "=", "value"}], ";", 
        "\[IndentingNewLine]", "v"}]}], "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ind", ",", " ", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nb", ",", " ", "_Integer"}], "}"}]}], "}"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.600886047118196*^9, 3.6008860659222717`*^9}, {
   3.6008861225055075`*^9, 3.6008863512505913`*^9}, {3.6008863970162086`*^9, 
   3.600886412874116*^9}, {3.6008864585477285`*^9, 3.6008865293307767`*^9}, {
   3.6008877380659122`*^9, 3.6008877386179442`*^9}, {3.600887769907734*^9, 
   3.6008877728269005`*^9}, {3.6053347347306147`*^9, 
   3.6053348246651917`*^9}, {3.6053348766291246`*^9, 3.605334910715343*^9}, {
   3.6053350033955374`*^9, 3.605335005080348*^9}, {3.605335321512382*^9, 
   3.6053353577982144`*^9}, {3.6053354275618615`*^9, 
   3.6053354587152615`*^9}, {3.605335544640612*^9, 3.605335548322236*^9}, {
   3.605335604031798*^9, 3.605335623500723*^9}, 3.60533565746214*^9, {
   3.6053356879603357`*^9, 3.60533570265563*^9}, {3.6053357529191523`*^9, 
   3.605335805148287*^9}, {3.6053358855356026`*^9, 3.6053359138185835`*^9}, 
   3.605345868033534*^9, 3.6053471500025578`*^9, 3.6053471802667513`*^9, {
   3.6053472178785925`*^9, 3.6053472344614987`*^9}, {3.6053474348915834`*^9, 
   3.60534743899441*^9}, {3.6053474712242165`*^9, 3.6053474790242662`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FromSparseToFlatIntegerC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"indexList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dimList", " ", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"value", " ", ",", " ", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", "ind", ",", "nb"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nb", "=", 
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"dimList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "dimList", "]"}]}], "}"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"v", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "nb"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ind", "=", 
         RowBox[{"Floor", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"indexList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "-", "1"}], ")"}], "*", " ", 
              RowBox[{"Product", "[", 
               RowBox[{
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", 
                  RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "dimList", "]"}]}], "}"}]}], "]"}], "+",
            "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", "ind", "]"}], "]"}], "=", "value"}], ";", 
        "\[IndentingNewLine]", "v"}]}], "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ind", ",", " ", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nb", ",", " ", "_Integer"}], "}"}]}], "}"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.600886047118196*^9, 3.6008860659222717`*^9}, {
   3.6008861225055075`*^9, 3.6008863512505913`*^9}, {3.6008863970162086`*^9, 
   3.600886412874116*^9}, {3.6008864585477285`*^9, 3.6008865293307767`*^9}, {
   3.6008877380659122`*^9, 3.6008877386179442`*^9}, {3.600887769907734*^9, 
   3.6008877728269005`*^9}, {3.6053347347306147`*^9, 
   3.6053348246651917`*^9}, {3.6053348766291246`*^9, 3.605334910715343*^9}, {
   3.6053350033955374`*^9, 3.605335005080348*^9}, {3.605335321512382*^9, 
   3.6053353577982144`*^9}, {3.6053354275618615`*^9, 
   3.6053354587152615`*^9}, {3.605335544640612*^9, 3.605335548322236*^9}, {
   3.605335604031798*^9, 3.605335623500723*^9}, 3.60533565746214*^9, {
   3.6053356879603357`*^9, 3.60533570265563*^9}, {3.6053357529191523`*^9, 
   3.605335805148287*^9}, {3.6053358855356026`*^9, 3.6053359138185835`*^9}, 
   3.605345868033534*^9, 3.6053471500025578`*^9, 3.6053471802667513`*^9, {
   3.6053472178785925`*^9, 3.6053472344614987`*^9}, {3.6053474348915834`*^9, 
   3.60534743899441*^9}, {3.6053474712242165`*^9, 3.6053474790242662`*^9}, {
   3.606743677942975*^9, 3.60674368850431*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FromSparseToFlatC", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", "7"}], "]"}]], "Input",
 CellChangeTimes->{{3.600887629906726*^9, 3.600887639558278*^9}, {
   3.6008877853366165`*^9, 3.6008877859796534`*^9}, 3.6053349771093683`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "7", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6008876418764105`*^9, 3.6008877456303453`*^9, {3.6008877787602406`*^9, 
   3.600887787129719*^9}, {3.605334982678604*^9, 3.6053350100411797`*^9}, 
   3.6053353624782443`*^9, 3.605335708739669*^9, 3.6053358187671747`*^9, 
   3.6053359251598563`*^9, 3.6053458757243834`*^9, 3.6053471536997814`*^9, 
   3.6053471885660048`*^9, 3.6053472228706245`*^9, 3.6053474954355717`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"FromSparseToFlat", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1",
      ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "3", ",", "4", ",", "3", ",", "2", ",", "5", ",", "2", ",", "3",
      ",", "4", ",", "3"}], "}"}], ",", "7"}], "]"}]], "Input",
 CellChangeTimes->{{3.600887862762045*^9, 3.6008879195302916`*^9}, {
  3.600887972221306*^9, 3.600887988810254*^9}, {3.601024097909687*^9, 
  3.601024101950139*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FromSparseToFlatIndex", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.600946928756686*^9, 3.6009469774755716`*^9}}],

Cell[BoxData["7"], "Output",
 CellChangeTimes->{3.600946615882537*^9, 3.6009466541338043`*^9, 
  3.6009469413927083`*^9, 3.6009469795815754`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NextIndexC", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"indexList", ",", " ", "_Integer", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"dimList", ",", " ", "_Integer", ",", "1"}], "}"}]}], "}"}], 
      ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"n", ",", "Done", ",", "indexList2", ",", "i"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "dimList", "]"}]}], ";", 
         RowBox[{"Done", "=", "0"}], ";", 
         RowBox[{"i", "=", "1"}], ";", 
         RowBox[{"indexList2", "=", "indexList"}], ";", "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Done", "\[Equal]", "0"}], ")"}], "&&", " ", 
            RowBox[{"(", 
             RowBox[{"i", "\[LessEqual]", "n"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"indexList", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "<", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ",", 
              RowBox[{"Done", "=", "1"}], ",", 
              RowBox[{"i", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Done", "\[Equal]", "1"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"indexList2", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "=", 
                RowBox[{
                 RowBox[{"indexList2", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "+", "1"}]}], ";", 
               RowBox[{"Do", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"indexList2", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "=", "1"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "1", ",", 
                   RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"indexList2", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "=", "0"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", 
                  RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}]}], 
          "]"}], ";", "\[IndentingNewLine]", "indexList2"}]}], "]"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"indexList2", ",", "_Integer", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Done", ",", " ", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", " ", "_Integer"}], "}"}]}], "}"}], ",", 
      RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
      RowBox[{"CompilationOptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], 
         ",", " ", 
         RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
        "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.601017790170096*^9, 3.6010178742395735`*^9}, {
   3.6010179043479595`*^9, 3.6010181142642508`*^9}, {3.601018165354906*^9, 
   3.601018196258902*^9}, {3.6010182353686037`*^9, 3.6010183741823125`*^9}, {
   3.6010184685921445`*^9, 3.601018476454645*^9}, {3.601023589081856*^9, 
   3.6010236275519485`*^9}, {3.6010236578501635`*^9, 
   3.6010237949759216`*^9}, {3.6010238728521194`*^9, 3.601023912507828*^9}, {
   3.6053516447589865`*^9, 3.605351817358493*^9}, {3.6053519096018844`*^9, 
   3.605351961846619*^9}, {3.605352022405813*^9, 3.605352077006163*^9}, {
   3.6053523101808577`*^9, 3.6053523583227663`*^9}, 3.605352425761999*^9, {
   3.6053526475174203`*^9, 3.6053526555514717`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"II", "=", 
  RowBox[{"{", 
   RowBox[{"1", ",", "1", ",", "2"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6010238120581408`*^9, 3.601023813836563*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{{3.601023815365383*^9, 3.601023831371188*^9}, 
   3.60102391727174*^9, 3.6010240003804283`*^9, 3.605352672040777*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"II", "=", 
  RowBox[{"NextIndexC", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "3", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.601018409592188*^9, {3.6010238231030817`*^9, 3.6010238264415245`*^9}, 
   3.6053527007293615`*^9, 3.6053528687736387`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{{3.601023764056325*^9, 3.6010237974875536`*^9}, {
   3.6010238334460144`*^9, 3.601023846440981*^9}, {3.601023919689771*^9, 
   3.601023944750115*^9}, {3.6010239967299814`*^9, 3.601024027334382*^9}, {
   3.6053526770484095`*^9, 3.605352701821368*^9}, 3.6053528705208497`*^9}]
}, Open  ]],

Cell["CliqueTensor = {nodeList1, nodelist2, principalNode, tensor}", "Text",
 CellChangeTimes->{{3.6009610183517*^9, 3.600961043389744*^9}, {
   3.600961106866255*^9, 3.600961134041503*^9}, {3.600961216206847*^9, 
   3.6009612544737144`*^9}, 3.600963058985284*^9}],

Cell["\<\
Le tensor est une distribution de probabilit\[EAcute] pour principalNode  \
conditional to nodeList1e t nodelist2,\
\>", "Text",
 CellChangeTimes->{{3.6009650087913184`*^9, 3.600965082610648*^9}}],

Cell["\<\
Contrainte : TensorRank[tensor] = Length[nodeList1] + Length[nodeList2] + 1\
\>", "Text",
 CellChangeTimes->{{3.600963113164179*^9, 3.60096321039915*^9}}],

Cell["\<\
On connait les ditribution conditionnelles de tous les noeuds presents cit\
\[EAcute]\
\>", "Text",
 CellChangeTimes->{{3.600965103623885*^9, 3.600965198629052*^9}}],

Cell["\<\
Contrainte : Apply[Union, Table[CliqueTensorList[[i, 1]], {i, 1, \
Length[CliqueTensorList]}]] = Apply[Union, Table[CliqueTensorList[[i, 3]], \
{i, 1, Length[CliqueTensorList]}]]\
\>", "Text",
 CellChangeTimes->{{3.600964583425371*^9, 3.600964722172015*^9}, 
   3.6009647902193346`*^9}],

Cell["\<\
On connait les ditribution conditionnelles de tous les noeuds pass\[EAcute]s \
cit\[EAcute]\
\>", "Text",
 CellChangeTimes->{{3.600965103623885*^9, 3.6009652139638786`*^9}}],

Cell["\<\
Contrainte : Apply[Union, Table[CliqueTensorList[[i, 2]], {i, 1, \
Length[CliqueTensorList]}]] = Apply[Union, Table[CliqueTensorList[[i, 3]], \
{i, 1, Length[CliqueTensorList]}]]\
\>", "Text",
 CellChangeTimes->{{3.600964583425371*^9, 3.600964722172015*^9}, 
   3.6009647902193346`*^9, {3.6009652228714943`*^9, 3.6009652233550954`*^9}}],

Cell["\<\
Il y a  consistence entre les dimensions des tenseurs pour les memes noeuds\
\>", "Text",
 CellChangeTimes->{{3.6009653829745755`*^9, 3.6009654291506567`*^9}, {
  3.600966070122983*^9, 3.600966071339785*^9}}],

Cell["\<\
un Tenseur est declar\[EAcute] comme un vecteur  de dimension 1 \
\>", "Text",
 CellChangeTimes->{{3.605358469339695*^9, 3.60535850598433*^9}, {
  3.605417025379011*^9, 3.605417033709464*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"lectureTenseur", "[", 
   RowBox[{"tenseur_", ",", "index_", ",", " ", "dimList_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rank", ",", "ind", ",", "block"}], "}"}], ",", 
    RowBox[{
     RowBox[{"rank", "=", 
      RowBox[{"Length", "[", "dimList", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ind", "=", 
      RowBox[{"index", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", 
     RowBox[{"block", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"block", "*=", 
         RowBox[{"dimList", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", 
        RowBox[{"ind", "+=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"index", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", "1"}], ")"}], " ", 
          "*", "block"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"rank", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tenseur", "[", 
      RowBox[{"[", "ind", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6053585212100277`*^9, 3.605358589413665*^9}, {
   3.6053586244670897`*^9, 3.6053588298424063`*^9}, {3.6053588617602105`*^9, 
   3.605359001287505*^9}, {3.6053590317701006`*^9, 3.605359073032365*^9}, 
   3.605361043723814*^9, {3.6053616076518292`*^9, 3.605361608213433*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"lectureTenseurC", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"vecteur", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"index", ",", "_Integer", ",", "1"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"dimList", ",", "_Integer", ",", "1"}], "}"}]}], "}"}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"rank", ",", "ind", ",", "block"}], "}"}], ",", 
        RowBox[{
         RowBox[{"rank", "=", 
          RowBox[{"Length", "[", "dimList", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ind", "=", 
          RowBox[{"index", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", 
         RowBox[{"block", "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"block", "*=", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", 
            RowBox[{"ind", "+=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"index", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", "1"}], ")"}], 
              " ", "*", "block"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"rank", "-", "1"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"vecteur", "[", 
          RowBox[{"[", "ind", "]"}], "]"}]}]}], "]"}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"block", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"rank", ",", " ", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ind", ",", " ", "_Integer"}], "}"}]}], "}"}], ",", 
      RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
      RowBox[{"CompilationOptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], 
         ",", " ", 
         RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
        "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6053585212100277`*^9, 3.605358589413665*^9}, {
   3.6053586244670897`*^9, 3.6053588298424063`*^9}, {3.6053588617602105`*^9, 
   3.605359001287505*^9}, {3.6053590317701006`*^9, 3.605359073032365*^9}, 
   3.605361043723814*^9, {3.6053616076518292`*^9, 3.605361608213433*^9}, {
   3.6053616547017307`*^9, 3.605361804509491*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ecritureTenseur", "[", 
   RowBox[{"tenseur_", ",", "index_", ",", " ", "dimList_", ",", "value_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rank", ",", "ind", ",", "block", ",", "tenseur2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tenseur2", "=", "tenseur"}], ";", "\[IndentingNewLine]", 
     RowBox[{"rank", "=", 
      RowBox[{"Length", "[", "dimList", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ind", "=", 
      RowBox[{"index", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", 
     RowBox[{"block", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"block", "*=", 
         RowBox[{"dimList", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", 
        RowBox[{"ind", "+=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"index", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", "1"}], ")"}], " ", 
          "*", "block"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"rank", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tenseur2", "[", 
       RowBox[{"[", "ind", "]"}], "]"}], "=", "value"}], ";", "tenseur2"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.605359084420438*^9, 3.605359099334133*^9}, {
   3.605360320238371*^9, 3.6053603233115907`*^9}, {3.6053603571170073`*^9, 
   3.605360397458866*^9}, 3.6053606105718317`*^9, {3.605360768272848*^9, 
   3.6053608579422235`*^9}, {3.6053609057253294`*^9, 3.605360925943059*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TenseurIndexC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"index", ",", "_Integer", ",", "1"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"dimList", ",", "_Integer", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rank", ",", "ind", ",", "block"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rank", "=", 
         RowBox[{"Length", "[", "dimList", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ind", "=", 
         RowBox[{"index", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"block", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"block", "*=", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", 
           RowBox[{"ind", "+=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"index", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", "1"}], ")"}], 
             " ", "*", "block"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"rank", "-", "1"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "ind"}]}], "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"block", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"rank", ",", " ", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ind", ",", " ", "_Integer"}], "}"}]}], "}"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605359084420438*^9, 3.605359099334133*^9}, {
   3.605360320238371*^9, 3.6053603233115907`*^9}, {3.6053603571170073`*^9, 
   3.605360397458866*^9}, 3.6053606105718317`*^9, {3.605360768272848*^9, 
   3.6053608579422235`*^9}, {3.6053609057253294`*^9, 3.605360925943059*^9}, {
   3.6053618510913897`*^9, 3.6053618518245945`*^9}, {3.6053618879388256`*^9, 
   3.6053619382803483`*^9}, {3.605361974176179*^9, 3.605362016702051*^9}, 
   3.60536205085067*^9, {3.6054171076539383`*^9, 3.6054171087927456`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6053593242875757`*^9, 3.605359325613584*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dimlist", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "4", ",", "5"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Random", "[", "]"}], ")"}], "&"}], ",", "dimlist"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<a=\>\"", ",", 
    RowBox[{"a", "//", "MatrixForm"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"0", "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"Apply", "[", 
       RowBox[{"Times", ",", "dimlist"}], "]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ind", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"1", "&"}], ",", 
     RowBox[{"Length", "[", "dimlist", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ind", "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", ">", "0"}], ",", " ", 
    RowBox[{
     RowBox[{"v", "=", 
      RowBox[{"Apply", "[", 
       RowBox[{"Part", ",", 
        RowBox[{"Insert", "[", 
         RowBox[{"ind", ",", "a", ",", "1"}], "]"}]}], "]"}]}], " ", ";", 
     RowBox[{
      RowBox[{"b", "[", 
       RowBox[{"[", 
        RowBox[{"TenseurIndexC", "[", 
         RowBox[{"ind", ",", "dimlist"}], "]"}], "]"}], "]"}], "=", "v"}], 
     ";", 
     RowBox[{"ind", "=", 
      RowBox[{"NextIndexC", "[", 
       RowBox[{"ind", ",", "dimlist"}], "]"}]}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a1", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", "0", ")"}], "&"}], ",", "dimlist"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ind", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"1", "&"}], ",", 
     RowBox[{"Length", "[", "dimlist", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ind", "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", ">", "0"}], ",", " ", 
    RowBox[{
     RowBox[{"v", "=", 
      RowBox[{"lectureTenseurC", "[", 
       RowBox[{"b", ",", "ind", ",", "dimlist"}], "]"}]}], ";", 
     RowBox[{"a1", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"a1", ",", 
        RowBox[{"ind", "\[Rule]", "v"}]}], "]"}]}], ";", 
     RowBox[{"ind", "=", 
      RowBox[{"NextIndexC", "[", 
       RowBox[{"ind", ",", "dimlist"}], "]"}]}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<a1=\>\"", ",", 
    RowBox[{"a1", "//", "MatrixForm"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6053591342783575`*^9, 3.605359182716668*^9}, {
   3.6053593328364305`*^9, 3.6053594733149366`*^9}, {3.6053595592402873`*^9, 
   3.605359614792243*^9}, {3.605359675913435*^9, 3.6053597008891954`*^9}, {
   3.6053598277804084`*^9, 3.6053598636450386`*^9}, {3.605359895235241*^9, 
   3.605359928151452*^9}, {3.6053601183010707`*^9, 3.6053601223570967`*^9}, {
   3.605360249289116*^9, 3.6053602888509693`*^9}, {3.6053603327964516`*^9, 
   3.605360332890052*^9}, {3.6053609523384285`*^9, 3.6053610361733656`*^9}, {
   3.6053612762589045`*^9, 3.605361351061384*^9}, {3.605361388111622*^9, 
   3.605361413102982*^9}, {3.605361484863442*^9, 3.605361502179553*^9}, {
   3.605361546608638*^9, 3.6053615528486776`*^9}, {3.605361626839952*^9, 
   3.6053616323467875`*^9}, 3.605361823182811*^9, {3.6053620701167936`*^9, 
   3.6053620850772896`*^9}, {3.6054171173104005`*^9, 3.605417135188115*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"a=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.7632262136547555`", "0.6244702410476424`", 
            "0.015635615722950972`", "0.9412559051171911`", 
            "0.1596849796723629`"},
           {"0.40845207630022046`", "0.374612602897169`", 
            "0.16295679163203816`", "0.032225425723828804`", 
            "0.46309003305265195`"},
           {"0.10051995442432403`", "0.4623890089632328`", 
            "0.21057751825385784`", "0.7300632068103551`", 
            "0.45503001203198734`"},
           {"0.88773454865927`", "0.7191109860474184`", 
            "0.028907165276906774`", "0.014307167371061037`", 
            "0.1946687132020164`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.38537407888011876`", "0.4576377314634129`", 
            "0.36031201852770245`", "0.1400817326117388`", 
            "0.6221478652253633`"},
           {"0.8331674904157705`", "0.3446764028047515`", 
            "0.19882582749454766`", "0.46246288555300036`", 
            "0.4247154141155501`"},
           {"0.9700637999075824`", "0.03586903586250949`", 
            "0.43023745982917155`", "0.9616253810628981`", 
            "0.8695438454832585`"},
           {"0.5734800268992767`", "0.21965994157531374`", 
            "0.23156217425254305`", "0.4145138334512711`", 
            "0.6857454782400066`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.5005489555278954`", "0.2026550089756363`", 
            "0.40020666608021005`", "0.49107676503799025`", 
            "0.11517487664777655`"},
           {"0.7450172775122234`", "0.03989464755250759`", 
            "0.3509950324262514`", "0.4930270114224133`", 
            "0.9118497870964528`"},
           {"0.6952182447477561`", "0.15216920493170377`", 
            "0.03056412586941292`", "0.4871343729809028`", 
            "0.7251544448401737`"},
           {"0.11630016906919427`", "0.6003266660402413`", 
            "0.5255089919180047`", "0.8556105993569152`", 
            "0.5428201421699176`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]},
       {
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.3806667244649276`", "0.2939468176654616`", 
            "0.4410967659056441`", "0.8570746639299109`", 
            "0.8801177689370323`"},
           {"0.09129180868982534`", "0.04089009982543406`", 
            "0.36599789889192075`", "0.7649428922892557`", 
            "0.34627453117760193`"},
           {"0.0009954522729264776`", "0.015002866465669343`", 
            "0.27191588086684243`", "0.4344247440811491`", 
            "0.3057772075251704`"},
           {"0.8628336615339656`", "0.24135175499742953`", 
            "0.9472903711002464`", "0.5806227626849968`", 
            "0.7465334924647713`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.6410250889571881`", "0.4217813791822417`", 
            "0.7250121633280815`", "0.2037133502948537`", 
            "0.2603583644922605`"},
           {"0.12783456151678002`", "0.28391539742243743`", 
            "0.3466386863649427`", "0.38024059555522827`", 
            "0.0365427528269547`"},
           {"0.24302529759700336`", "0.980640787473022`", 
            "0.6152977032659726`", "0.6902682216493528`", 
            "0.2420298453240769`"},
           {"0.9656379210073526`", "0.34338182239913007`", 
            "0.25584347756820364`", "0.9362526377989066`", 
            "0.10280425947338703`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.10203006740170056`", "0.3085531064679573`", 
            "0.35562987511390975`", "0.3562707670086157`", 
            "0.4610049784445124`"},
           {"0.8867717272857156`", "0.6306177117858283`", 
            "0.15255741671376202`", "0.20064661395225186`", 
            "0.7589371657689357`"},
           {"0.3467023143633908`", "0.8059187303488193`", 
            "0.8204060183970237`", "0.7223944129419809`", 
            "0.10367701676638741`"},
           {"0.8252779428757974`", "0.20510831513105107`", 
            "0.03212619129262818`", "0.8616471714423105`", 
            "0.8596400218684447`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["a=", 
   MatrixForm[CompressedData["
1:eJwVxnsw2wcAB3ClqnVOF3pKDXWsrfSod3va+jI21fMIGqsJlXaUVoa6i7H2
zGM13dpVu57HNauJ0gydehanpcKSbImgTSIRr+AXQmI7Skdt9sfn7mN/MS0y
caeenp7+NoNt/99wW7j1JXpMqhpjWyMGnA0VSoK7knn6d1Hx2LOFa6vF26yG
pjvpXMxTU533Ocrx/HiRQ+07KR6A9pir4CKhj6wYza3EbkduQiBbiUHT0c36
rg5EdEyReKVKuJIt/D1XBMhgPClooBE4a2rp4W2nhGVdz5nI5EXgvtp4VZ9A
/Y5lQ2k5C8ShJ7nmobfxFZFwk1jgYXMP3XidI0NSQAFXF6xEJWfD4fO9UvSJ
yC/ctb34LUXIrlKrIK1ijIdxFmC0msZy3itB7InzS3aZfFzaH6h9X6ZEv+7L
H4tdFKiNXznVZ6yDhUpnx4irwtqL8Sb9YgXGE6mlVf1aiE7FsEJHNCi2N+X/
HTONl1G1jkM2f6JtqjnsNVuIiKsVRolFcmQwQ7+p/GsWz/z9fXN3TiJvapVR
vszHATLr6ubDURzKvnJayJjAg9lveVbXu9EgOZntIiUgMjA5bcaoBpdEHW9m
SmBUc5Pce3sCEg9RxYTzEjr6Lak+mIOLJmIwKKcPvgtHuB4hj6DOcq7xcp6A
2WVHyyxPAuKZOtPR/m5IiGeBk14qWET3nlwXTyKQ/EeOE10DUuzv53nxUxB+
9MGalCYDpesIZZd4GMfnN5aWfMZQOZMtO8zQwHvo0+5Fp0X4kdu/mItvB7G+
avaDrhrWlOLM/FQpCvZ5F6bkqOFl01ZDc5LAje3b7RNOwbSgqGa44w7+zZ9V
ki4PobjVKoMlVMCt+fu78pIRJFT3R1MfatCu/iSANSPCkC1z1oOiRdE1e1fm
T9MYOLzsWaEi8Nk9O5OgghkwS1Kisrbk+PhMdGuIB4HX7uz0IHMBprZc7Ns4
Ypytz9s1TetBWG3j9bqjw3ASxxmdOyYBk/ZLzRhVhl9pZZSu1ipcFLNXMq0H
YeS3wE+m6/C8/MBgYaMKrllP6Q0Wc/gwyin3zT8iKA5ScvPmtEhvDO9Ze/cG
0hMBkd0XxDj2deF+3uoS5KqoQHpEJ84tN+VU23bCeyO6iPpyBBTSgIj9SoIr
HE/CQShBUiljl3WeEpMtb63SEhaR1GPibugygx0HB+L0ivpg7HZDwH/Khyg4
usw7WI0bo8lEvKsEi49emVsI5rH75zA7rt8CDLghKrkNAdf+2Jb7tzoxe0EW
3JC8AJDEfu/9BHATzljJrlViwqHXgnVPgz34TnA0X4P/AE/o5tE=
    "]]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6053614292022853`*^9, {3.605361486626253*^9, 3.605361503458761*^9}, 
   3.6053615555162945`*^9, {3.605361613860669*^9, 3.6053616333295937`*^9}, {
   3.605361826708433*^9, 3.605361830046855*^9}, 3.605362101192193*^9, {
   3.605417121428827*^9, 3.60541713598372*^9}, 3.606819163583969*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"a1=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.7632262136547555`", "0.6244702410476424`", 
            "0.015635615722950972`", "0.9412559051171911`", 
            "0.1596849796723629`"},
           {"0.40845207630022046`", "0.374612602897169`", 
            "0.16295679163203816`", "0.032225425723828804`", 
            "0.46309003305265195`"},
           {"0.10051995442432403`", "0.4623890089632328`", 
            "0.21057751825385784`", "0.7300632068103551`", 
            "0.45503001203198734`"},
           {"0.88773454865927`", "0.7191109860474184`", 
            "0.028907165276906774`", "0.014307167371061037`", 
            "0.1946687132020164`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.38537407888011876`", "0.4576377314634129`", 
            "0.36031201852770245`", "0.1400817326117388`", 
            "0.6221478652253633`"},
           {"0.8331674904157705`", "0.3446764028047515`", 
            "0.19882582749454766`", "0.46246288555300036`", 
            "0.4247154141155501`"},
           {"0.9700637999075824`", "0.03586903586250949`", 
            "0.43023745982917155`", "0.9616253810628981`", 
            "0.8695438454832585`"},
           {"0.5734800268992767`", "0.21965994157531374`", 
            "0.23156217425254305`", "0.4145138334512711`", 
            "0.6857454782400066`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.5005489555278954`", "0.2026550089756363`", 
            "0.40020666608021005`", "0.49107676503799025`", 
            "0.11517487664777655`"},
           {"0.7450172775122234`", "0.03989464755250759`", 
            "0.3509950324262514`", "0.4930270114224133`", 
            "0.9118497870964528`"},
           {"0.6952182447477561`", "0.15216920493170377`", 
            "0.03056412586941292`", "0.4871343729809028`", 
            "0.7251544448401737`"},
           {"0.11630016906919427`", "0.6003266660402413`", 
            "0.5255089919180047`", "0.8556105993569152`", 
            "0.5428201421699176`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]},
       {
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.3806667244649276`", "0.2939468176654616`", 
            "0.4410967659056441`", "0.8570746639299109`", 
            "0.8801177689370323`"},
           {"0.09129180868982534`", "0.04089009982543406`", 
            "0.36599789889192075`", "0.7649428922892557`", 
            "0.34627453117760193`"},
           {"0.0009954522729264776`", "0.015002866465669343`", 
            "0.27191588086684243`", "0.4344247440811491`", 
            "0.3057772075251704`"},
           {"0.8628336615339656`", "0.24135175499742953`", 
            "0.9472903711002464`", "0.5806227626849968`", 
            "0.7465334924647713`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.6410250889571881`", "0.4217813791822417`", 
            "0.7250121633280815`", "0.2037133502948537`", 
            "0.2603583644922605`"},
           {"0.12783456151678002`", "0.28391539742243743`", 
            "0.3466386863649427`", "0.38024059555522827`", 
            "0.0365427528269547`"},
           {"0.24302529759700336`", "0.980640787473022`", 
            "0.6152977032659726`", "0.6902682216493528`", 
            "0.2420298453240769`"},
           {"0.9656379210073526`", "0.34338182239913007`", 
            "0.25584347756820364`", "0.9362526377989066`", 
            "0.10280425947338703`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.10203006740170056`", "0.3085531064679573`", 
            "0.35562987511390975`", "0.3562707670086157`", 
            "0.4610049784445124`"},
           {"0.8867717272857156`", "0.6306177117858283`", 
            "0.15255741671376202`", "0.20064661395225186`", 
            "0.7589371657689357`"},
           {"0.3467023143633908`", "0.8059187303488193`", 
            "0.8204060183970237`", "0.7223944129419809`", 
            "0.10367701676638741`"},
           {"0.8252779428757974`", "0.20510831513105107`", 
            "0.03212619129262818`", "0.8616471714423105`", 
            "0.8596400218684447`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["a1=", 
   MatrixForm[CompressedData["
1:eJwVxnsw2wcAB3ClqnVOF3pKDXWsrfSod3va+jI21fMIGqsJlXaUVoa6i7H2
zGM13dpVu57HNauJ0gydehanpcKSbImgTSIRr+AXQmI7Skdt9sfn7mN/MS0y
caeenp7+NoNt/99wW7j1JXpMqhpjWyMGnA0VSoK7knn6d1Hx2LOFa6vF26yG
pjvpXMxTU533Ocrx/HiRQ+07KR6A9pir4CKhj6wYza3EbkduQiBbiUHT0c36
rg5EdEyReKVKuJIt/D1XBMhgPClooBE4a2rp4W2nhGVdz5nI5EXgvtp4VZ9A
/Y5lQ2k5C8ShJ7nmobfxFZFwk1jgYXMP3XidI0NSQAFXF6xEJWfD4fO9UvSJ
yC/ctb34LUXIrlKrIK1ijIdxFmC0msZy3itB7InzS3aZfFzaH6h9X6ZEv+7L
H4tdFKiNXznVZ6yDhUpnx4irwtqL8Sb9YgXGE6mlVf1aiE7FsEJHNCi2N+X/
HTONl1G1jkM2f6JtqjnsNVuIiKsVRolFcmQwQ7+p/GsWz/z9fXN3TiJvapVR
vszHATLr6ubDURzKvnJayJjAg9lveVbXu9EgOZntIiUgMjA5bcaoBpdEHW9m
SmBUc5Pce3sCEg9RxYTzEjr6Lak+mIOLJmIwKKcPvgtHuB4hj6DOcq7xcp6A
2WVHyyxPAuKZOtPR/m5IiGeBk14qWET3nlwXTyKQ/EeOE10DUuzv53nxUxB+
9MGalCYDpesIZZd4GMfnN5aWfMZQOZMtO8zQwHvo0+5Fp0X4kdu/mItvB7G+
avaDrhrWlOLM/FQpCvZ5F6bkqOFl01ZDc5LAje3b7RNOwbSgqGa44w7+zZ9V
ki4PobjVKoMlVMCt+fu78pIRJFT3R1MfatCu/iSANSPCkC1z1oOiRdE1e1fm
T9MYOLzsWaEi8Nk9O5OgghkwS1Kisrbk+PhMdGuIB4HX7uz0IHMBprZc7Ns4
Ypytz9s1TetBWG3j9bqjw3ASxxmdOyYBk/ZLzRhVhl9pZZSu1ipcFLNXMq0H
YeS3wE+m6/C8/MBgYaMKrllP6Q0Wc/gwyin3zT8iKA5ScvPmtEhvDO9Ze/cG
0hMBkd0XxDj2deF+3uoS5KqoQHpEJ84tN+VU23bCeyO6iPpyBBTSgIj9SoIr
HE/CQShBUiljl3WeEpMtb63SEhaR1GPibugygx0HB+L0ivpg7HZDwH/Khyg4
usw7WI0bo8lEvKsEi49emVsI5rH75zA7rt8CDLghKrkNAdf+2Jb7tzoxe0EW
3JC8AJDEfu/9BHATzljJrlViwqHXgnVPgz34TnA0X4P/AE/o5tE=
    "]]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6053614292022853`*^9, {3.605361486626253*^9, 3.605361503458761*^9}, 
   3.6053615555162945`*^9, {3.605361613860669*^9, 3.6053616333295937`*^9}, {
   3.605361826708433*^9, 3.605361830046855*^9}, 3.605362101192193*^9, {
   3.605417121428827*^9, 3.60541713598372*^9}, 3.6068191635995693`*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindNodePositionC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"globalNodeList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nodeName", ",", "_Integer"}], "}"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"globalNodeList", ",", "nodeName"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.605352986507199*^9, 3.6053530681269217`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CliqueProbabilityC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nodeList1", ",", " ", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nodeList2", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"principalNode", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"TensorVecteur", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"TensorDimList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"index1", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"index2", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"globalNodeList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dimList", ",", "_Integer", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "rank", ",", "indexList", ",", "nodeName", ",", "nodePosition", ",", 
         "nodeState", ",", "dimlistattendue", ",", "v"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rank", "=", 
         RowBox[{"Length", "[", "TensorDimList", "]"}]}], ";", 
        RowBox[{"nodePosition", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "on", " ", "suppose", " ", "que", " ", "dimList", " ", "sont", " ", 
          "la", " ", "liste", " ", "des", " ", "dimensions", " ", "attendue", 
          " ", "pour", " ", "les", " ", "neuds", " ", "de", "  ", 
          "globalNodeList"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"indexList", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "rank"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"dimlistattendue", "=", "indexList"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"nodePosition", "=", 
            RowBox[{"FindNodePositionC", "[", 
             RowBox[{"globalNodeList", ",", 
              RowBox[{"nodeList1", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{
            "je", " ", "cherche", " ", "seulement", " ", "les", " ", "etats", 
             " ", "concern\[EAcute]s", " ", "par", " ", "nodeList1"}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"dimlistattendue", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "nodePosition", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"nodeState", "=", 
            RowBox[{"index1", "[", 
             RowBox[{"[", "nodePosition", "]"}], "]"}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{
            "je", " ", "le", " ", "cherche", " ", "ds", " ", "index1", " ", 
             "car", " ", 
             RowBox[{"c", "'"}], "est", " ", "f", 
             RowBox[{"(", 
              RowBox[{"t", "-", "1"}], ")"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"indexList", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", "nodeState"}], ";"}], " ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "je", " ", "construit", " ", "les", " ", "etat", " ", 
            "associ\[EAcute]", " ", "aux", " ", "nodelist1"}], " ", "*)"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "nodeList1", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"nodePosition", "=", 
            RowBox[{"FindNodePositionC", "[", 
             RowBox[{"globalNodeList", ",", 
              RowBox[{"nodeList2", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"dimlistattendue", "[", 
             RowBox[{"[", 
              RowBox[{"j", "+", 
               RowBox[{"Length", "[", "nodeList1", "]"}]}], "]"}], "]"}], "=", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "nodePosition", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"nodeState", "=", 
            RowBox[{"index2", "[", 
             RowBox[{"[", "nodePosition", "]"}], "]"}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{
            "je", " ", "le", " ", "cherche", " ", "ds", " ", "index2", " ", 
             "car", " ", 
             RowBox[{"c", "'"}], "est", " ", "f", 
             RowBox[{"(", "t", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"indexList", "[", 
             RowBox[{"[", 
              RowBox[{"j", "+", 
               RowBox[{"Length", "[", "nodeList1", "]"}]}], "]"}], "]"}], "=",
             "nodeState"}], ";"}], 
          RowBox[{"(*", " ", 
           RowBox[{
           "je", " ", "construit", " ", "les", " ", "etat", " ", 
            "associ\[EAcute]", " ", "aux", " ", "nodelist2"}], " ", "*)"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "nodeList2", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nodePosition", "=", 
         RowBox[{"FindNodePositionC", "[", 
          RowBox[{"globalNodeList", ",", "principalNode"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dimlistattendue", "[", 
          RowBox[{"[", 
           RowBox[{"1", "+", 
            RowBox[{"Length", "[", "nodeList1", "]"}], "+", 
            RowBox[{"Length", "[", "nodeList2", "]"}]}], "]"}], "]"}], "=", 
         RowBox[{"dimList", "[", 
          RowBox[{"[", "nodePosition", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nodeState", "=", 
         RowBox[{"index2", "[", 
          RowBox[{"[", "nodePosition", "]"}], "]"}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
         "je", " ", "le", " ", "cherche", " ", "ds", " ", "index2", " ", 
          "car", " ", 
          RowBox[{"c", "'"}], "est", " ", "f", 
          RowBox[{"(", "t", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"indexList", "[", 
          RowBox[{"[", 
           RowBox[{"1", "+", 
            RowBox[{"Length", "[", "nodeList1", "]"}], "+", 
            RowBox[{"Length", "[", "nodeList2", "]"}]}], "]"}], "]"}], "=", 
         "nodeState"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "je", " ", "construit", " ", "l", " ", "etat", " ", 
          "associ\[EAcute]", " ", "a", " ", "principalNode"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"lectureTenseurC", "[", 
         RowBox[{"TensorVecteur", ",", "indexList", ",", "TensorDimList"}], 
         "]"}]}]}], "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"indexList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dimlistattendue", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"indexList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"nodeState", ",", " ", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nodePosition", ",", " ", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"v", ",", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6010322991625185`*^9, 3.601032332718549*^9}, {
   3.6010323644961567`*^9, 3.6010323713602448`*^9}, 3.60103252467901*^9, {
   3.601032918792073*^9, 3.601032972144757*^9}, {3.601033025591042*^9, 
   3.6010330369323874`*^9}, {3.601033095885543*^9, 3.6010331546358967`*^9}, {
   3.6010332980173345`*^9, 3.6010333784363656`*^9}, {3.6010335788209343`*^9, 
   3.601033579195339*^9}, {3.601033610052535*^9, 3.6010336720373397`*^9}, {
   3.601033714469884*^9, 3.601034030623537*^9}, {3.601034076581726*^9, 
   3.6010341133669977`*^9}, {3.601034316653204*^9, 3.6010343167780056`*^9}, {
   3.6010344308466682`*^9, 3.6010345314991584`*^9}, {3.6010345710456653`*^9, 
   3.601034571170467*^9}, {3.6010358305742235`*^9, 3.6010358567669587`*^9}, {
   3.6010363772520313`*^9, 3.6010364287794924`*^9}, {3.601036744316348*^9, 
   3.6010367586529317`*^9}, {3.6010375180082664`*^9, 
   3.6010375982556953`*^9}, {3.601037824364994*^9, 3.6010378340839195`*^9}, {
   3.6011117319937534`*^9, 3.601111738873891*^9}, {3.6011152039301915`*^9, 
   3.601115279411701*^9}, {3.6011153415129433`*^9, 3.6011153699235115`*^9}, {
   3.601117216033433*^9, 3.601117262754367*^9}, {3.6011218228545685`*^9, 
   3.6011218358848286`*^9}, {3.6025071699599333`*^9, 3.602507220834265*^9}, {
   3.6025072915339184`*^9, 3.602507303967198*^9}, {3.602507363965183*^9, 
   3.6025073720772347`*^9}, {3.602507543740735*^9, 3.6025075576404243`*^9}, {
   3.602507606109935*^9, 3.6025076207584286`*^9}, {3.602507658229869*^9, 
   3.602507683346836*^9}, {3.6025088655928197`*^9, 3.602508869804847*^9}, {
   3.6025113989902706`*^9, 3.6025114476781826`*^9}, {3.602511702623824*^9, 
   3.6025118117933235`*^9}, {3.602511844678334*^9, 3.6025118709177027`*^9}, {
   3.602511902211503*^9, 3.602511925892455*^9}, {3.60251198439283*^9, 
   3.602512014469823*^9}, {3.602512328967839*^9, 3.6025123528203917`*^9}, {
   3.602512384472995*^9, 3.6025124735027657`*^9}, 3.6025129815044217`*^9, {
   3.602515006879212*^9, 3.602515028148779*^9}, {3.604055611351656*^9, 
   3.6040556126932817`*^9}, {3.604055831596691*^9, 3.604055997708686*^9}, {
   3.604056038144663*^9, 3.604056039626692*^9}, {3.604056087176406*^9, 
   3.6040561325732794`*^9}, {3.604056167215547*^9, 3.6040564234358745`*^9}, {
   3.6040564600029774`*^9, 3.604056513590008*^9}, {3.6040565486126814`*^9, 
   3.6040565800784864`*^9}, {3.6040566425732884`*^9, 
   3.6040566868625402`*^9}, {3.60405797364989*^9, 3.6040579917930384`*^9}, {
   3.604058040516777*^9, 3.604058075102642*^9}, {3.604058447575405*^9, 
   3.604058457871603*^9}, {3.6040608850259037`*^9, 3.6040608861023245`*^9}, {
   3.604064529027112*^9, 3.60406465166107*^9}, {3.604064686948949*^9, 
   3.604064706620927*^9}, {3.6040652254085054`*^9, 3.6040652397919817`*^9}, 
   3.6053530869406424`*^9, {3.60535602835967*^9, 3.6053561422248*^9}, {
   3.6053569279014034`*^9, 3.605356928182205*^9}, {3.6053569775721216`*^9, 
   3.6053570657750874`*^9}, {3.605357180404622*^9, 3.605357190903489*^9}, {
   3.6053572258945136`*^9, 3.6053572442558312`*^9}, {3.605357317233099*^9, 
   3.6053573702110386`*^9}, {3.605357405030462*^9, 3.6053574347954526`*^9}, {
   3.6054181782368546`*^9, 3.6054182695442395`*^9}, {3.6054183130217185`*^9, 
   3.6054183341910543`*^9}, {3.6054184198824034`*^9, 
   3.6054185191458397`*^9}, {3.6054185629197206`*^9, 3.60541856600854*^9}, {
   3.607066309058405*^9, 3.607066425650073*^9}, {3.6070664829543505`*^9, 
   3.607066493104932*^9}, {3.6070665325301867`*^9, 3.6070665330732174`*^9}, {
   3.6070722111689863`*^9, 3.607072217128327*^9}, {3.6070724194498987`*^9, 
   3.6070724382479744`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CliqueProbabilityCNoL1", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nodeList2", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"principalNode", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"TensorVecteur", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"TensorDimList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"index1", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"index2", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"globalNodeList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dimList", ",", "_Integer", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "rank", ",", "indexList", ",", "nodeName", ",", "nodePosition", ",", 
         "nodeState", ",", "dimlistattendue", ",", "v"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rank", "=", 
         RowBox[{"Length", "[", "TensorDimList", "]"}]}], ";", 
        RowBox[{"nodePosition", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "on", " ", "suppose", " ", "que", " ", "dimList", " ", "sont", " ", 
          "la", " ", "liste", " ", "des", " ", "dimensions", " ", "attendue", 
          " ", "pour", " ", "les", " ", "neuds", " ", "de", "  ", 
          "globalNodeList"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"indexList", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "rank"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"dimlistattendue", "=", "indexList"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"nodePosition", "=", 
            RowBox[{"FindNodePositionC", "[", 
             RowBox[{"globalNodeList", ",", 
              RowBox[{"nodeList2", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"dimlistattendue", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "nodePosition", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"nodeState", "=", 
            RowBox[{"index2", "[", 
             RowBox[{"[", "nodePosition", "]"}], "]"}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{
            "je", " ", "le", " ", "cherche", " ", "ds", " ", "index2", " ", 
             "car", " ", 
             RowBox[{"c", "'"}], "est", " ", "f", 
             RowBox[{"(", "t", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"indexList", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", "nodeState"}], ";"}], 
          RowBox[{"(*", " ", 
           RowBox[{
           "je", " ", "construit", " ", "les", " ", "etat", " ", 
            "associ\[EAcute]", " ", "aux", " ", "nodelist2"}], " ", "*)"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "nodeList2", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nodePosition", "=", 
         RowBox[{"FindNodePositionC", "[", 
          RowBox[{"globalNodeList", ",", "principalNode"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dimlistattendue", "[", 
          RowBox[{"[", 
           RowBox[{"1", "+", 
            RowBox[{"Length", "[", "nodeList2", "]"}]}], "]"}], "]"}], "=", 
         RowBox[{"dimList", "[", 
          RowBox[{"[", "nodePosition", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nodeState", "=", 
         RowBox[{"index2", "[", 
          RowBox[{"[", "nodePosition", "]"}], "]"}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
         "je", " ", "le", " ", "cherche", " ", "ds", " ", "index2", " ", 
          "car", " ", 
          RowBox[{"c", "'"}], "est", " ", "f", 
          RowBox[{"(", "t", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"indexList", "[", 
          RowBox[{"[", 
           RowBox[{"1", "+", 
            RowBox[{"Length", "[", "nodeList2", "]"}]}], "]"}], "]"}], "=", 
         "nodeState"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "je", " ", "construit", " ", "l", " ", "etat", " ", 
          "associ\[EAcute]", " ", "a", " ", "principalNode"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"lectureTenseurC", "[", 
         RowBox[{"TensorVecteur", ",", "indexList", ",", "TensorDimList"}], 
         "]"}]}]}], "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"indexList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dimlistattendue", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"indexList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"nodeState", ",", " ", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nodePosition", ",", " ", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"v", ",", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6010322991625185`*^9, 3.601032332718549*^9}, {
   3.6010323644961567`*^9, 3.6010323713602448`*^9}, 3.60103252467901*^9, {
   3.601032918792073*^9, 3.601032972144757*^9}, {3.601033025591042*^9, 
   3.6010330369323874`*^9}, {3.601033095885543*^9, 3.6010331546358967`*^9}, {
   3.6010332980173345`*^9, 3.6010333784363656`*^9}, {3.6010335788209343`*^9, 
   3.601033579195339*^9}, {3.601033610052535*^9, 3.6010336720373397`*^9}, {
   3.601033714469884*^9, 3.601034030623537*^9}, {3.601034076581726*^9, 
   3.6010341133669977`*^9}, {3.601034316653204*^9, 3.6010343167780056`*^9}, {
   3.6010344308466682`*^9, 3.6010345314991584`*^9}, {3.6010345710456653`*^9, 
   3.601034571170467*^9}, {3.6010358305742235`*^9, 3.6010358567669587`*^9}, {
   3.6010363772520313`*^9, 3.6010364287794924`*^9}, {3.601036744316348*^9, 
   3.6010367586529317`*^9}, {3.6010375180082664`*^9, 
   3.6010375982556953`*^9}, {3.601037824364994*^9, 3.6010378340839195`*^9}, {
   3.6011117319937534`*^9, 3.601111738873891*^9}, {3.6011152039301915`*^9, 
   3.601115279411701*^9}, {3.6011153415129433`*^9, 3.6011153699235115`*^9}, {
   3.601117216033433*^9, 3.601117262754367*^9}, {3.6011218228545685`*^9, 
   3.6011218358848286`*^9}, {3.6025071699599333`*^9, 3.602507220834265*^9}, {
   3.6025072915339184`*^9, 3.602507303967198*^9}, {3.602507363965183*^9, 
   3.6025073720772347`*^9}, {3.602507543740735*^9, 3.6025075576404243`*^9}, {
   3.602507606109935*^9, 3.6025076207584286`*^9}, {3.602507658229869*^9, 
   3.602507683346836*^9}, {3.6025088655928197`*^9, 3.602508869804847*^9}, {
   3.6025113989902706`*^9, 3.6025114476781826`*^9}, {3.602511702623824*^9, 
   3.6025118117933235`*^9}, {3.602511844678334*^9, 3.6025118709177027`*^9}, {
   3.602511902211503*^9, 3.602511925892455*^9}, {3.60251198439283*^9, 
   3.602512014469823*^9}, {3.602512328967839*^9, 3.6025123528203917`*^9}, {
   3.602512384472995*^9, 3.6025124735027657`*^9}, 3.6025129815044217`*^9, {
   3.602515006879212*^9, 3.602515028148779*^9}, {3.604055611351656*^9, 
   3.6040556126932817`*^9}, {3.604055831596691*^9, 3.604055997708686*^9}, {
   3.604056038144663*^9, 3.604056039626692*^9}, {3.604056087176406*^9, 
   3.6040561325732794`*^9}, {3.604056167215547*^9, 3.6040564234358745`*^9}, {
   3.6040564600029774`*^9, 3.604056513590008*^9}, {3.6040565486126814`*^9, 
   3.6040565800784864`*^9}, {3.6040566425732884`*^9, 
   3.6040566868625402`*^9}, {3.60405797364989*^9, 3.6040579917930384`*^9}, {
   3.604058040516777*^9, 3.604058075102642*^9}, {3.604058447575405*^9, 
   3.604058457871603*^9}, {3.6040608850259037`*^9, 3.6040608861023245`*^9}, {
   3.604064529027112*^9, 3.60406465166107*^9}, {3.604064686948949*^9, 
   3.604064706620927*^9}, {3.6040652254085054`*^9, 3.6040652397919817`*^9}, 
   3.6053530869406424`*^9, {3.60535602835967*^9, 3.6053561422248*^9}, {
   3.6053569279014034`*^9, 3.605356928182205*^9}, {3.6053569775721216`*^9, 
   3.6053570657750874`*^9}, {3.605357180404622*^9, 3.605357190903489*^9}, {
   3.6053572258945136`*^9, 3.6053572442558312`*^9}, {3.605357317233099*^9, 
   3.6053573702110386`*^9}, {3.605357405030462*^9, 3.6053574347954526`*^9}, {
   3.6054181782368546`*^9, 3.6054182695442395`*^9}, {3.6054183130217185`*^9, 
   3.6054183341910543`*^9}, {3.6054184198824034`*^9, 
   3.6054185191458397`*^9}, {3.6054185629197206`*^9, 3.60541856600854*^9}, {
   3.607066309058405*^9, 3.607066425650073*^9}, {3.6070664829543505`*^9, 
   3.607066493104932*^9}, {3.6070665325301867`*^9, 3.6070665330732174`*^9}, {
   3.6070705431615815`*^9, 3.607070620106982*^9}, {3.607070655382*^9, 
   3.6070706839806356`*^9}, {3.60707223099012*^9, 3.607072243875857*^9}, {
   3.6070725356045427`*^9, 3.6070725361945763`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CliqueProbabilityCNoL2", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nodeList1", ",", " ", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"principalNode", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"TensorVecteur", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"TensorDimList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"index1", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"index2", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"globalNodeList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dimList", ",", "_Integer", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "rank", ",", "indexList", ",", "nodeName", ",", "nodePosition", ",", 
         "nodeState", ",", "dimlistattendue", ",", "v"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rank", "=", 
         RowBox[{"Length", "[", "TensorDimList", "]"}]}], ";", 
        RowBox[{"nodePosition", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "on", " ", "suppose", " ", "que", " ", "dimList", " ", "sont", " ", 
          "la", " ", "liste", " ", "des", " ", "dimensions", " ", "attendue", 
          " ", "pour", " ", "les", " ", "neuds", " ", "de", "  ", 
          "globalNodeList"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"indexList", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "rank"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"dimlistattendue", "=", "indexList"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"nodePosition", "=", 
            RowBox[{"FindNodePositionC", "[", 
             RowBox[{"globalNodeList", ",", 
              RowBox[{"nodeList1", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{
            "je", " ", "cherche", " ", "seulement", " ", "les", " ", "etats", 
             " ", "concern\[EAcute]s", " ", "par", " ", "nodeList1"}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"dimlistattendue", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "nodePosition", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"nodeState", "=", 
            RowBox[{"index1", "[", 
             RowBox[{"[", "nodePosition", "]"}], "]"}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{
            "je", " ", "le", " ", "cherche", " ", "ds", " ", "index1", " ", 
             "car", " ", 
             RowBox[{"c", "'"}], "est", " ", "f", 
             RowBox[{"(", 
              RowBox[{"t", "-", "1"}], ")"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"indexList", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", "nodeState"}], ";"}], " ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "je", " ", "construit", " ", "les", " ", "etat", " ", 
            "associ\[EAcute]", " ", "aux", " ", "nodelist1"}], " ", "*)"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "nodeList1", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nodePosition", "=", 
         RowBox[{"FindNodePositionC", "[", 
          RowBox[{"globalNodeList", ",", "principalNode"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dimlistattendue", "[", 
          RowBox[{"[", 
           RowBox[{"1", "+", 
            RowBox[{"Length", "[", "nodeList1", "]"}]}], "]"}], "]"}], "=", 
         RowBox[{"dimList", "[", 
          RowBox[{"[", "nodePosition", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nodeState", "=", 
         RowBox[{"index2", "[", 
          RowBox[{"[", "nodePosition", "]"}], "]"}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
         "je", " ", "le", " ", "cherche", " ", "ds", " ", "index2", " ", 
          "car", " ", 
          RowBox[{"c", "'"}], "est", " ", "f", 
          RowBox[{"(", "t", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"indexList", "[", 
          RowBox[{"[", 
           RowBox[{"1", "+", 
            RowBox[{"Length", "[", "nodeList1", "]"}]}], "]"}], "]"}], "=", 
         "nodeState"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "je", " ", "construit", " ", "l", " ", "etat", " ", 
          "associ\[EAcute]", " ", "a", " ", "principalNode"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"lectureTenseurC", "[", 
         RowBox[{"TensorVecteur", ",", "indexList", ",", "TensorDimList"}], 
         "]"}]}]}], "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"indexList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dimlistattendue", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"indexList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"nodeState", ",", " ", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nodePosition", ",", " ", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"v", ",", "_Real"}], "}"}]}], "}"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6010322991625185`*^9, 3.601032332718549*^9}, {
   3.6010323644961567`*^9, 3.6010323713602448`*^9}, 3.60103252467901*^9, {
   3.601032918792073*^9, 3.601032972144757*^9}, {3.601033025591042*^9, 
   3.6010330369323874`*^9}, {3.601033095885543*^9, 3.6010331546358967`*^9}, {
   3.6010332980173345`*^9, 3.6010333784363656`*^9}, {3.6010335788209343`*^9, 
   3.601033579195339*^9}, {3.601033610052535*^9, 3.6010336720373397`*^9}, {
   3.601033714469884*^9, 3.601034030623537*^9}, {3.601034076581726*^9, 
   3.6010341133669977`*^9}, {3.601034316653204*^9, 3.6010343167780056`*^9}, {
   3.6010344308466682`*^9, 3.6010345314991584`*^9}, {3.6010345710456653`*^9, 
   3.601034571170467*^9}, {3.6010358305742235`*^9, 3.6010358567669587`*^9}, {
   3.6010363772520313`*^9, 3.6010364287794924`*^9}, {3.601036744316348*^9, 
   3.6010367586529317`*^9}, {3.6010375180082664`*^9, 
   3.6010375982556953`*^9}, {3.601037824364994*^9, 3.6010378340839195`*^9}, {
   3.6011117319937534`*^9, 3.601111738873891*^9}, {3.6011152039301915`*^9, 
   3.601115279411701*^9}, {3.6011153415129433`*^9, 3.6011153699235115`*^9}, {
   3.601117216033433*^9, 3.601117262754367*^9}, {3.6011218228545685`*^9, 
   3.6011218358848286`*^9}, {3.6025071699599333`*^9, 3.602507220834265*^9}, {
   3.6025072915339184`*^9, 3.602507303967198*^9}, {3.602507363965183*^9, 
   3.6025073720772347`*^9}, {3.602507543740735*^9, 3.6025075576404243`*^9}, {
   3.602507606109935*^9, 3.6025076207584286`*^9}, {3.602507658229869*^9, 
   3.602507683346836*^9}, {3.6025088655928197`*^9, 3.602508869804847*^9}, {
   3.6025113989902706`*^9, 3.6025114476781826`*^9}, {3.602511702623824*^9, 
   3.6025118117933235`*^9}, {3.602511844678334*^9, 3.6025118709177027`*^9}, {
   3.602511902211503*^9, 3.602511925892455*^9}, {3.60251198439283*^9, 
   3.602512014469823*^9}, {3.602512328967839*^9, 3.6025123528203917`*^9}, {
   3.602512384472995*^9, 3.6025124735027657`*^9}, 3.6025129815044217`*^9, {
   3.602515006879212*^9, 3.602515028148779*^9}, {3.604055611351656*^9, 
   3.6040556126932817`*^9}, {3.604055831596691*^9, 3.604055997708686*^9}, {
   3.604056038144663*^9, 3.604056039626692*^9}, {3.604056087176406*^9, 
   3.6040561325732794`*^9}, {3.604056167215547*^9, 3.6040564234358745`*^9}, {
   3.6040564600029774`*^9, 3.604056513590008*^9}, {3.6040565486126814`*^9, 
   3.6040565800784864`*^9}, {3.6040566425732884`*^9, 
   3.6040566868625402`*^9}, {3.60405797364989*^9, 3.6040579917930384`*^9}, {
   3.604058040516777*^9, 3.604058075102642*^9}, {3.604058447575405*^9, 
   3.604058457871603*^9}, {3.6040608850259037`*^9, 3.6040608861023245`*^9}, {
   3.604064529027112*^9, 3.60406465166107*^9}, {3.604064686948949*^9, 
   3.604064706620927*^9}, {3.6040652254085054`*^9, 3.6040652397919817`*^9}, 
   3.6053530869406424`*^9, {3.60535602835967*^9, 3.6053561422248*^9}, {
   3.6053569279014034`*^9, 3.605356928182205*^9}, {3.6053569775721216`*^9, 
   3.6053570657750874`*^9}, {3.605357180404622*^9, 3.605357190903489*^9}, {
   3.6053572258945136`*^9, 3.6053572442558312`*^9}, {3.605357317233099*^9, 
   3.6053573702110386`*^9}, {3.605357405030462*^9, 3.6053574347954526`*^9}, {
   3.6054181782368546`*^9, 3.6054182695442395`*^9}, {3.6054183130217185`*^9, 
   3.6054183341910543`*^9}, {3.6054184198824034`*^9, 
   3.6054185191458397`*^9}, {3.6054185629197206`*^9, 3.60541856600854*^9}, {
   3.607066309058405*^9, 3.607066425650073*^9}, {3.6070664829543505`*^9, 
   3.607066493104932*^9}, {3.6070665325301867`*^9, 3.6070665330732174`*^9}, {
   3.6070707160984726`*^9, 3.607070755517728*^9}, {3.6070712690360994`*^9, 
   3.6070712700051546`*^9}, {3.6070722574376326`*^9, 
   3.6070722645730405`*^9}, {3.6070725292581797`*^9, 3.6070725485242815`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nodeList1", "=", 
      RowBox[{"{", 
       RowBox[{"4", ",", "1"}], "}"}]}], ",", 
     RowBox[{"nodeList2", "=", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"principalNode", "=", "7"}], ",", "dimList", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"tensor", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"9", ",", "10", ",", "11", ",", "12"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"13", ",", "14", ",", "15", ",", "16"}], "}"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"17", ",", "18", ",", "19", ",", "20"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"21", ",", "22", ",", "23", ",", "24"}], "}"}]}], "}"}]}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"index1", "=", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1", ",", "2", ",", "1", ",", "2"}], "}"}]}], ",", 
     RowBox[{"index2", "=", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2", ",", "2", ",", "1", ",", "1"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"globalNodeList", "=", 
      RowBox[{"{", 
       RowBox[{"4", ",", "7", ",", "3", ",", "5", ",", "1"}], "}"}]}]}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dimList", "=", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2", ",", "0", ",", "0", ",", "4"}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"CliqueProbability", "[", 
     RowBox[{
     "nodeList1", ",", "nodeList2", ",", "principalNode", ",", "tensor", ",", 
      "index1", ",", "index2", ",", "globalNodeList", ",", "dimList"}], 
     "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.601035397325469*^9, 3.6010357945845613`*^9}, {
  3.60103715472641*^9, 3.601037201932615*^9}, {3.6010372443963594`*^9, 
  3.601037311477219*^9}, {3.6010376336369495`*^9, 3.6010376655081577`*^9}, {
  3.6010376995633945`*^9, 3.601037707597498*^9}, {3.6010378505109296`*^9, 
  3.601037850807334*^9}, {3.60103788252254*^9, 3.6010378946438956`*^9}, {
  3.6040556953124704`*^9, 3.604055722925001*^9}, {3.6040557759192204`*^9, 
  3.6040557974320345`*^9}, {3.6040571555273547`*^9, 3.604057198646584*^9}, {
  3.6040572309548054`*^9, 3.604057231625618*^9}, {3.6058814993074713`*^9, 
  3.605881508152728*^9}}],

Cell[BoxData["14"], "Output",
 CellChangeTimes->{3.60405726967475*^9, 3.6058789902551603`*^9, 
  3.6058815107111444`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nodeList1", "=", 
      RowBox[{"{", 
       RowBox[{"4", ",", "1"}], "}"}]}], ",", 
     RowBox[{"nodeList2", "=", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"principalNode", "=", "7"}], ",", "dimList", ",", 
     "TensorDimList", ",", "TensorVectorList", ",", "Localdimlist", ",", 
     "RankVectorList", ",", "TotalDimVectorList", ",", "DimensionVectorList", 
     ",", "ind", ",", "dimtotale", ",", "NbNodes", ",", "v", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"tensor", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"9", ",", "10", ",", "11", ",", "12"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"13", ",", "14", ",", "15", ",", "16"}], "}"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"17", ",", "18", ",", "19", ",", "20"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"21", ",", "22", ",", "23", ",", "24"}], "}"}]}], "}"}]}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"index1", "=", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1", ",", "2", ",", "1", ",", "2"}], "}"}]}], ",", 
     RowBox[{"index2", "=", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2", ",", "2", ",", "1", ",", "1"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"globalNodeList", "=", 
      RowBox[{"{", 
       RowBox[{"4", ",", "7", ",", "3", ",", "5", ",", "1"}], "}"}]}]}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dimList", "=", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2", ",", "0", ",", "0", ",", "4"}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"dimtotale", "=", "50"}], ";", 
    RowBox[{"NbNodes", "=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"RankVectorList", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "NbNodes"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"TotalDimVectorList", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "NbNodes"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"DimensionVectorList", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "NbNodes"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "dimtotale"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"TensorVectorList", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "NbNodes"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dimtotale", "*", "dimtotale"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Localdimlist", "=", 
        RowBox[{"Dimensions", "[", "tensor", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RankVectorList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"Length", "[", "Localdimlist", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TotalDimVectorList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"Product", "[", 
         RowBox[{
          RowBox[{"Localdimlist", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "Localdimlist", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"DimensionVectorList", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
          RowBox[{"Localdimlist", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "Localdimlist", "]"}]}], "}"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"ind", "=", 
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{"1", "&"}], ",", 
          RowBox[{"Length", "[", "Localdimlist", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ind", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", ">", "0"}], ",", " ", 
         RowBox[{
          RowBox[{"v", "=", 
           RowBox[{"Apply", "[", 
            RowBox[{"Part", ",", 
             RowBox[{"Insert", "[", 
              RowBox[{"ind", ",", "tensor", ",", "1"}], "]"}]}], "]"}]}], " ",
           ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"TensorVectorList", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", 
              RowBox[{"TenseurIndexC", "[", 
               RowBox[{"ind", ",", "Localdimlist"}], "]"}]}], "]"}], "]"}], 
           "=", "v"}], ";", 
          RowBox[{"ind", "=", 
           RowBox[{"NextIndexC", "[", 
            RowBox[{"ind", ",", "Localdimlist"}], "]"}]}]}]}], "]"}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "1"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"CliqueProbabilityC", "[", 
     RowBox[{"nodeList1", ",", "nodeList2", ",", "principalNode", ",", 
      RowBox[{"TensorVectorList", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"DimensionVectorList", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "index1", ",", "index2", ",", 
      "globalNodeList", ",", "dimList"}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.601035397325469*^9, 3.6010357945845613`*^9}, {
   3.60103715472641*^9, 3.601037201932615*^9}, {3.6010372443963594`*^9, 
   3.601037311477219*^9}, {3.6010376336369495`*^9, 3.6010376655081577`*^9}, {
   3.6010376995633945`*^9, 3.601037707597498*^9}, {3.6010378505109296`*^9, 
   3.601037850807334*^9}, {3.60103788252254*^9, 3.6010378946438956`*^9}, {
   3.6040556953124704`*^9, 3.604055722925001*^9}, {3.6040557759192204`*^9, 
   3.6040557974320345`*^9}, {3.6040571555273547`*^9, 3.604057198646584*^9}, {
   3.6040572309548054`*^9, 3.604057231625618*^9}, {3.605879098863057*^9, 
   3.6058791008754697`*^9}, {3.605879153494607*^9, 3.605879196894085*^9}, {
   3.6058792372203436`*^9, 3.6058793624579463`*^9}, {3.605879393907748*^9, 
   3.605879446292884*^9}, {3.6058797724281797`*^9, 3.605879785547864*^9}, 
   3.6058800063204794`*^9, {3.605881429465824*^9, 3.6058814551903887`*^9}}],

Cell[BoxData["14.`"], "Output",
 CellChangeTimes->{
  3.6058794498965073`*^9, 3.6058796348976984`*^9, 3.6058797902278943`*^9, 
   3.605880010797708*^9, {3.605881440261093*^9, 3.6058814575928044`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"AssocListC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"assocList", ",", "_Real", ",", "2"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"key", ",", "_Real"}], "}"}]}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"assocList", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "==", " ", "key"}], " ", 
         "&"}]}], " ", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6059582492505703`*^9, 3.6059583823818235`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AssocListC", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2.35"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3.58"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "2.8745"}], "}"}]}], "}"}], ",", "2"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6059583934578943`*^9, 3.6059584165460424`*^9}, {
  3.605958452161071*^9, 3.605958456872301*^9}}],

Cell[BoxData["3.58`"], "Output",
 CellChangeTimes->{3.6059584585259113`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"AssocListC1", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"assocList", ",", "_Real", ",", "3"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"key", ",", "_Real"}], "}"}]}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"assocList", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "==", " ", "key"}], " ", 
         "&"}]}], " ", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6059582492505703`*^9, 3.6059583823818235`*^9}, {
  3.6059587665254946`*^9, 3.6059587700667176`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VectorProbabilityC", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nodeName", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"vector", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"index1", ",", "_Integer", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"globalNodeList", ",", "_Integer", ",", "1"}], "}"}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"vector", "[", 
       RowBox[{"[", 
        RowBox[{"index1", "[", 
         RowBox[{"[", 
          RowBox[{"FindNodePositionC", "[", 
           RowBox[{"globalNodeList", ",", "nodeName"}], "]"}], "]"}], "]"}], 
        "]"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
      RowBox[{"CompilationOptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], 
         ",", " ", 
         RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
        "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6010322991625185`*^9, 3.601032332718549*^9}, {
   3.6010323644961567`*^9, 3.6010323713602448`*^9}, 3.60103252467901*^9, {
   3.601032918792073*^9, 3.601032972144757*^9}, {3.601033025591042*^9, 
   3.6010330369323874`*^9}, {3.601033095885543*^9, 3.6010331546358967`*^9}, {
   3.6010332980173345`*^9, 3.6010333784363656`*^9}, {3.6010335788209343`*^9, 
   3.601033579195339*^9}, {3.601033610052535*^9, 3.6010336720373397`*^9}, {
   3.601033714469884*^9, 3.601034030623537*^9}, {3.601034076581726*^9, 
   3.6010341133669977`*^9}, {3.601034316653204*^9, 3.6010343167780056`*^9}, {
   3.6010344308466682`*^9, 3.6010345314991584`*^9}, {3.6010345710456653`*^9, 
   3.601034571170467*^9}, {3.6010358305742235`*^9, 3.6010358567669587`*^9}, {
   3.6010363772520313`*^9, 3.6010364287794924`*^9}, {3.601036744316348*^9, 
   3.6010367586529317`*^9}, {3.6010375180082664`*^9, 
   3.6010375982556953`*^9}, {3.601037824364994*^9, 3.6010378340839195`*^9}, {
   3.6011117319937534`*^9, 3.601111738873891*^9}, {3.6011152039301915`*^9, 
   3.601115279411701*^9}, {3.6011153415129433`*^9, 3.6011153699235115`*^9}, {
   3.601117216033433*^9, 3.601117262754367*^9}, {3.6011218228545685`*^9, 
   3.6011218358848286`*^9}, {3.60112279752802*^9, 3.6011228245631666`*^9}, {
   3.6011228559975696`*^9, 3.6011228592112107`*^9}, {3.601123192384682*^9, 
   3.6011232526170545`*^9}, {3.601123305142928*^9, 3.6011234356230006`*^9}, {
   3.601123476422734*^9, 3.6011234852836475`*^9}, {3.6011235156728373`*^9, 
   3.601123533441465*^9}, {3.6034479490492992`*^9, 3.60344795923623*^9}, {
   3.6059588635893173`*^9, 3.605959018872712*^9}, {3.6059592348485017`*^9, 
   3.6059592436001577`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VectorProbabilityLogC", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nodeName", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"vector", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"index1", ",", "_Integer", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"globalNodeList", ",", "_Integer", ",", "1"}], "}"}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Log", "[", 
       RowBox[{"vector", "[", 
        RowBox[{"[", 
         RowBox[{"index1", "[", 
          RowBox[{"[", 
           RowBox[{"FindNodePositionC", "[", 
            RowBox[{"globalNodeList", ",", "nodeName"}], "]"}], "]"}], "]"}], 
         "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
      RowBox[{"CompilationOptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], 
         ",", " ", 
         RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
        "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6010322991625185`*^9, 3.601032332718549*^9}, {
   3.6010323644961567`*^9, 3.6010323713602448`*^9}, 3.60103252467901*^9, {
   3.601032918792073*^9, 3.601032972144757*^9}, {3.601033025591042*^9, 
   3.6010330369323874`*^9}, {3.601033095885543*^9, 3.6010331546358967`*^9}, {
   3.6010332980173345`*^9, 3.6010333784363656`*^9}, {3.6010335788209343`*^9, 
   3.601033579195339*^9}, {3.601033610052535*^9, 3.6010336720373397`*^9}, {
   3.601033714469884*^9, 3.601034030623537*^9}, {3.601034076581726*^9, 
   3.6010341133669977`*^9}, {3.601034316653204*^9, 3.6010343167780056`*^9}, {
   3.6010344308466682`*^9, 3.6010345314991584`*^9}, {3.6010345710456653`*^9, 
   3.601034571170467*^9}, {3.6010358305742235`*^9, 3.6010358567669587`*^9}, {
   3.6010363772520313`*^9, 3.6010364287794924`*^9}, {3.601036744316348*^9, 
   3.6010367586529317`*^9}, {3.6010375180082664`*^9, 
   3.6010375982556953`*^9}, {3.601037824364994*^9, 3.6010378340839195`*^9}, {
   3.6011117319937534`*^9, 3.601111738873891*^9}, {3.6011152039301915`*^9, 
   3.601115279411701*^9}, {3.6011153415129433`*^9, 3.6011153699235115`*^9}, {
   3.601117216033433*^9, 3.601117262754367*^9}, {3.6011218228545685`*^9, 
   3.6011218358848286`*^9}, {3.60112279752802*^9, 3.6011228245631666`*^9}, {
   3.6011228559975696`*^9, 3.6011228592112107`*^9}, {3.601123192384682*^9, 
   3.6011232526170545`*^9}, {3.601123305142928*^9, 3.6011234356230006`*^9}, {
   3.601123476422734*^9, 3.6011234852836475`*^9}, {3.6011235156728373`*^9, 
   3.601123533441465*^9}, {3.6034479490492992`*^9, 3.60344795923623*^9}, {
   3.6059588635893173`*^9, 3.605959018872712*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BuildVectorTensoriallyLogC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"namedVectorList", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"globalNodeList", ",", "_Integer", ",", "1"}], "}"}]}], "}"}],
      ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "dimList", ",", "dimtotale", ",", "nClique", ",", "V", ",", 
         "CurrentSate1", ",", "index1", ",", "probalistLog"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"index1", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"nClique", "=", 
         RowBox[{"Length", "[", "namedVectorList", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dimList", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"namedVectorList", ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"#1", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], " ", "==", " ", 
                 RowBox[{"globalNodeList", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], " ", "&"}]}], " ", "]"}], 
             "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nClique"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dimtotale", "=", 
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"dimList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nClique"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"V", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "dimtotale"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"CurrentSate1", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nClique"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "CurrentSate1", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"index1", "=", 
            RowBox[{"Floor", "[", 
             RowBox[{"FromSparseToFlatIndexC", "[", 
              RowBox[{"CurrentSate1", ",", "dimList"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"probalistLog", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"VectorProbabilityC", "[", 
               RowBox[{
                RowBox[{"namedVectorList", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"namedVectorList", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"2", ";;", 
                    RowBox[{"dimList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], "]"}], ",", 
                "CurrentSate1", ",", "globalNodeList"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "nClique"}], "}"}]}], "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"V", "[", 
             RowBox[{"[", "index1", "]"}], "]"}], "=", 
            RowBox[{"LogSumExpC", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"probalistLog", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "nClique"}], "}"}]}], "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"V", "[", 
             RowBox[{"[", "index1", "]"}], "]"}], "=", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"probalistLog", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "nClique"}], "}"}]}], "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"CurrentSate1", "=", 
            RowBox[{"Floor", "[", 
             RowBox[{"NextIndexC", "[", 
              RowBox[{"CurrentSate1", ",", "dimList"}], "]"}], "]"}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", "V"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dimList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dimtotale", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"CurrentSate1", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"CurrentSate1", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nClique", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"index1", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"probalistLog", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"V", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"VectorProbabilityC", "[", "_", "]"}], ",", "_Real"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FromSparseToFlatIndexC", "[", "_", "]"}], ",", "_Integer"}],
         "}"}]}], "}"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6011220804197197`*^9, 3.601122120560522*^9}, {
   3.601122177212655*^9, 3.601122280614723*^9}, {3.6011223385758824`*^9, 
   3.6011224162674365`*^9}, {3.601122735267622*^9, 3.6011227689328537`*^9}, {
   3.6029148835525017`*^9, 3.602914894160638*^9}, {3.6029151235313787`*^9, 
   3.6029151258714085`*^9}, {3.602915190971043*^9, 3.6029151959943075`*^9}, {
   3.6029152655243993`*^9, 3.602915269112445*^9}, {3.6029157813824244`*^9, 
   3.6029157818192296`*^9}, {3.603388713836795*^9, 3.603388732390856*^9}, {
   3.60344790154669*^9, 3.6034479111720133`*^9}, {3.603447970671176*^9, 
   3.6034479711703825`*^9}, {3.603448009812078*^9, 3.603448019733805*^9}, {
   3.6034491521055226`*^9, 3.6034491526827297`*^9}, {3.603466274105462*^9, 
   3.603466290532473*^9}, {3.6034663801088214`*^9, 3.6034664140704565`*^9}, {
   3.6034664872977953`*^9, 3.6034664878282022`*^9}, 3.6040491980547667`*^9, {
   3.6059581178353276`*^9, 3.6059582224495983`*^9}, {3.605958818224226*^9, 
   3.6059588438239903`*^9}, 3.605959029730382*^9, {3.6059606271831684`*^9, 
   3.6059607516719666`*^9}, {3.6059610904745436`*^9, 
   3.6059611447316914`*^9}, {3.605961245726739*^9, 3.6059613285628757`*^9}, {
   3.6059613808232107`*^9, 3.605961419417858*^9}, {3.605961506294815*^9, 
   3.6059615095396357`*^9}, {3.6059618120251803`*^9, 3.605961863973513*^9}, {
   3.605961915609844*^9, 3.6059619157970457`*^9}, {3.605961946747644*^9, 
   3.605961953252886*^9}, {3.6059705597526054`*^9, 3.605970578223124*^9}, {
   3.605970617582176*^9, 3.605970642667137*^9}, {3.6060230107189713`*^9, 
   3.6060230324031105`*^9}, {3.6060232138020735`*^9, 3.606023235345811*^9}}],

Cell["\<\
namedVectorList a une structure paticuliere :
   namedVectorList[[i]] = { nodename, data1, ..., dataN}\
\>", "Text",
 CellChangeTimes->{{3.6060230732909727`*^9, 3.606023133164156*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BuildVectorTensoriallyC2", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"namedVectorList", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"globalNodeList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dimList", ",", "_Integer", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "dimtotale", ",", "nClique", ",", "V", ",", "CurrentSate1", ",", 
         "index1", ",", "probalistLog", ",", "dimproduct", ",", "k", ",", 
         "l"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"index1", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"nClique", "=", 
         RowBox[{"Length", "[", "namedVectorList", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dimtotale", "=", 
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"dimList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nClique"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"V", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "dimtotale"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"CurrentSate1", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nClique"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dimproduct", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nClique"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"probalistLog", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nClique"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dimproduct", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"dimproduct", "[", 
             RowBox[{"[", 
              RowBox[{"i", "-", "1"}], "]"}], "]"}], "*", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", 
              RowBox[{"i", "-", "1"}], "]"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "nClique"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"CurrentSate1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"index1", "=", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"CurrentSate1", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "-", "1"}], ")"}], "*", 
                RowBox[{"dimproduct", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "dimList", "]"}]}], "}"}]}], "]"}], 
             "+", "1"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"l", "=", 
               RowBox[{"Floor", "[", 
                RowBox[{"namedVectorList", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"k", "=", 
               RowBox[{"FindNodePositionC", "[", 
                RowBox[{"globalNodeList", ",", "l"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"l", "=", 
               RowBox[{"CurrentSate1", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"probalistLog", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "=", 
               RowBox[{"namedVectorList", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", 
                  RowBox[{"1", "+", "l"}]}], "]"}], "]"}]}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "nClique"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"V", "[", 
             RowBox[{"[", "index1", "]"}], "]"}], "=", 
            RowBox[{"Product", "[", 
             RowBox[{
              RowBox[{"probalistLog", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "nClique"}], "}"}]}], "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"CurrentSate1", "=", 
            RowBox[{"Floor", "[", 
             RowBox[{"NextIndexC", "[", 
              RowBox[{"CurrentSate1", ",", "dimList"}], "]"}], "]"}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", "V"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dimList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dimtotale", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"CurrentSate1", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"CurrentSate1", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dimproduct", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nClique", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"index1", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"probalistLog", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"V", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"VectorProbabilityC", "[", "_", "]"}], ",", "_Real"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FromSparseToFlatIndexC", "[", "_", "]"}], ",", "_Integer"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"AssocListC1", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6011220804197197`*^9, 3.601122120560522*^9}, {
   3.601122177212655*^9, 3.601122280614723*^9}, {3.6011223385758824`*^9, 
   3.6011224162674365`*^9}, {3.601122735267622*^9, 3.6011227689328537`*^9}, {
   3.6029148835525017`*^9, 3.602914894160638*^9}, {3.6029151235313787`*^9, 
   3.6029151258714085`*^9}, {3.602915190971043*^9, 3.6029151959943075`*^9}, {
   3.6029152655243993`*^9, 3.602915269112445*^9}, {3.6029157813824244`*^9, 
   3.6029157818192296`*^9}, {3.603388713836795*^9, 3.603388732390856*^9}, {
   3.60344790154669*^9, 3.6034479111720133`*^9}, {3.603447970671176*^9, 
   3.6034479711703825`*^9}, {3.603448009812078*^9, 3.603448019733805*^9}, {
   3.6034491521055226`*^9, 3.6034491526827297`*^9}, {3.603466274105462*^9, 
   3.603466290532473*^9}, {3.6034663801088214`*^9, 3.6034664140704565`*^9}, {
   3.6034664872977953`*^9, 3.6034664878282022`*^9}, 3.6040491980547667`*^9, {
   3.6059581178353276`*^9, 3.6059582224495983`*^9}, {3.605958818224226*^9, 
   3.6059588438239903`*^9}, 3.605959029730382*^9, {3.6059606271831684`*^9, 
   3.6059607516719666`*^9}, {3.6059610904745436`*^9, 
   3.6059611447316914`*^9}, {3.605961245726739*^9, 3.6059613285628757`*^9}, {
   3.6059613808232107`*^9, 3.605961419417858*^9}, {3.605961506294815*^9, 
   3.6059615095396357`*^9}, {3.6059618120251803`*^9, 3.605961863973513*^9}, {
   3.605961915609844*^9, 3.6059619157970457`*^9}, {3.605961946747644*^9, 
   3.605961953252886*^9}, 3.6059631147111363`*^9, {3.6059631692958865`*^9, 
   3.6059632097001452`*^9}, {3.6059683621299133`*^9, 
   3.6059684150610523`*^9}, {3.6059684764318457`*^9, 3.605968499504394*^9}, {
   3.6059685613441906`*^9, 3.6059688541424675`*^9}, {3.6059688866374755`*^9, 
   3.6059688867778764`*^9}, {3.605969250603409*^9, 3.6059692766399755`*^9}, {
   3.605969358135898*^9, 3.6059694942155704`*^9}, {3.6059695259149733`*^9, 
   3.6059695792829156`*^9}, {3.6059696123551273`*^9, 
   3.6059696204671793`*^9}, {3.6059696548810005`*^9, 
   3.6059696550214014`*^9}, {3.6059705207055554`*^9, 3.6059705208459563`*^9}, 
   3.605970694693471*^9, {3.606022863672429*^9, 3.606022863734829*^9}, {
   3.6060229238576145`*^9, 3.606022945104951*^9}, {3.6060574247629194`*^9, 
   3.6060574608459506`*^9}, {3.60605758240193*^9, 3.6060575948664093`*^9}, {
   3.606057637267482*^9, 3.606057643897524*^9}, {3.606057822206667*^9, 
   3.6060578604269123`*^9}, {3.6060594472126937`*^9, 3.606059454919143*^9}, {
   3.60612371919379*^9, 3.6061237195737977`*^9}, {3.6061239747789016`*^9, 
   3.6061239842590914`*^9}, {3.6061245625316563`*^9, 
   3.6061245650917077`*^9}, {3.6061307504258842`*^9, 
   3.6061308428577332`*^9}, {3.606137286451985*^9, 3.606137293052117*^9}, {
   3.606138444507146*^9, 3.6061384672176*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BuildVectorTensoriallyLogC2", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"namedVectorList", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"globalNodeList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dimList", ",", "_Integer", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "dimtotale", ",", "nClique", ",", "V", ",", "CurrentSate1", ",", 
         "index1", ",", "probalistLog", ",", "dimproduct", ",", "k", ",", 
         "l"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"index1", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"nClique", "=", 
         RowBox[{"Length", "[", "namedVectorList", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dimtotale", "=", 
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"dimList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nClique"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"V", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "dimtotale"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"CurrentSate1", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nClique"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dimproduct", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nClique"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"probalistLog", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nClique"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dimproduct", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"dimproduct", "[", 
             RowBox[{"[", 
              RowBox[{"i", "-", "1"}], "]"}], "]"}], "*", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", 
              RowBox[{"i", "-", "1"}], "]"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "nClique"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"CurrentSate1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"index1", "=", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"CurrentSate1", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "-", "1"}], ")"}], "*", 
                RowBox[{"dimproduct", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "dimList", "]"}]}], "}"}]}], "]"}], 
             "+", "1"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"l", "=", 
               RowBox[{"Floor", "[", 
                RowBox[{"namedVectorList", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"k", "=", 
               RowBox[{"FindNodePositionC", "[", 
                RowBox[{"globalNodeList", ",", "l"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"l", "=", 
               RowBox[{"CurrentSate1", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"probalistLog", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "=", 
               RowBox[{"namedVectorList", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", 
                  RowBox[{"1", "+", "l"}]}], "]"}], "]"}]}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "nClique"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"V", "[", 
             RowBox[{"[", "index1", "]"}], "]"}], "=", 
            RowBox[{"LogSumExpC", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"probalistLog", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "nClique"}], "}"}]}], "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"V", "[", 
             RowBox[{"[", "index1", "]"}], "]"}], "=", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"probalistLog", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "nClique"}], "}"}]}], "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"CurrentSate1", "=", 
            RowBox[{"Floor", "[", 
             RowBox[{"NextIndexC", "[", 
              RowBox[{"CurrentSate1", ",", "dimList"}], "]"}], "]"}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", "V"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dimList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dimtotale", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"CurrentSate1", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"CurrentSate1", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dimproduct", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nClique", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"index1", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"probalistLog", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"V", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"VectorProbabilityC", "[", "_", "]"}], ",", "_Real"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FromSparseToFlatIndexC", "[", "_", "]"}], ",", "_Integer"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"AssocListC1", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6011220804197197`*^9, 3.601122120560522*^9}, {
   3.601122177212655*^9, 3.601122280614723*^9}, {3.6011223385758824`*^9, 
   3.6011224162674365`*^9}, {3.601122735267622*^9, 3.6011227689328537`*^9}, {
   3.6029148835525017`*^9, 3.602914894160638*^9}, {3.6029151235313787`*^9, 
   3.6029151258714085`*^9}, {3.602915190971043*^9, 3.6029151959943075`*^9}, {
   3.6029152655243993`*^9, 3.602915269112445*^9}, {3.6029157813824244`*^9, 
   3.6029157818192296`*^9}, {3.603388713836795*^9, 3.603388732390856*^9}, {
   3.60344790154669*^9, 3.6034479111720133`*^9}, {3.603447970671176*^9, 
   3.6034479711703825`*^9}, {3.603448009812078*^9, 3.603448019733805*^9}, {
   3.6034491521055226`*^9, 3.6034491526827297`*^9}, {3.603466274105462*^9, 
   3.603466290532473*^9}, {3.6034663801088214`*^9, 3.6034664140704565`*^9}, {
   3.6034664872977953`*^9, 3.6034664878282022`*^9}, 3.6040491980547667`*^9, {
   3.6059581178353276`*^9, 3.6059582224495983`*^9}, {3.605958818224226*^9, 
   3.6059588438239903`*^9}, 3.605959029730382*^9, {3.6059606271831684`*^9, 
   3.6059607516719666`*^9}, {3.6059610904745436`*^9, 
   3.6059611447316914`*^9}, {3.605961245726739*^9, 3.6059613285628757`*^9}, {
   3.6059613808232107`*^9, 3.605961419417858*^9}, {3.605961506294815*^9, 
   3.6059615095396357`*^9}, {3.6059618120251803`*^9, 3.605961863973513*^9}, {
   3.605961915609844*^9, 3.6059619157970457`*^9}, {3.605961946747644*^9, 
   3.605961953252886*^9}, 3.6059631147111363`*^9, {3.6059631692958865`*^9, 
   3.6059632097001452`*^9}, {3.6059683621299133`*^9, 
   3.6059684150610523`*^9}, {3.6059684764318457`*^9, 3.605968499504394*^9}, {
   3.6059685613441906`*^9, 3.6059688541424675`*^9}, {3.6059688866374755`*^9, 
   3.6059688867778764`*^9}, {3.605969250603409*^9, 3.6059692766399755`*^9}, {
   3.605969358135898*^9, 3.6059694942155704`*^9}, {3.6059695259149733`*^9, 
   3.6059695792829156`*^9}, {3.6059696123551273`*^9, 
   3.6059696204671793`*^9}, {3.6059696548810005`*^9, 
   3.6059696550214014`*^9}, {3.6059705207055554`*^9, 3.6059705208459563`*^9}, 
   3.605970694693471*^9, {3.606022863672429*^9, 3.606022863734829*^9}, {
   3.6060229238576145`*^9, 3.606022945104951*^9}, {3.6060574247629194`*^9, 
   3.6060574608459506`*^9}, {3.60605758240193*^9, 3.6060575948664093`*^9}, {
   3.606057637267482*^9, 3.606057643897524*^9}, {3.606057822206667*^9, 
   3.6060578604269123`*^9}, {3.6060594472126937`*^9, 3.606059454919143*^9}, {
   3.6061239196677995`*^9, 3.6061239236878796`*^9}, {3.6063843135150704`*^9, 
   3.606384316431237*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BuildGammaVectorLogC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nodeNameList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"emissionNodeList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"thetaList", ",", "_Real", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"HistoricalDataList", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dimList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "_Integer"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "namedVectorList", ",", "nodename", ",", "probavector", ",", "dimMax",
          ",", "pos", ",", "ntik", ",", "numberState", ",", "NumberOfStates", 
         ",", "NumberOfNodes", ",", "NbParammax", ",", "NumberOfStateMax"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NbParammax", "=", "5"}], ";", 
        RowBox[{"NumberOfStateMax", "=", "10"}], ";", "\[IndentingNewLine]", 
        RowBox[{"NumberOfNodes", "=", 
         RowBox[{"Length", "[", "nodeNameList", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dimMax", "=", 
         RowBox[{"Max", "[", "dimList", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"NumberOfStates", "=", 
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"dimList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NumberOfNodes"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"namedVectorList", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NumberOfNodes"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"dimMax", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"probavector", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NumberOfStateMax"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"nodename", "=", 
            RowBox[{"nodeNameList", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"numberState", "=", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"pos", "=", 
            RowBox[{"Position", "[", 
             RowBox[{"emissionNodeList", ",", "nodename"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "pos", "]"}], ">", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ntik", "=", 
               RowBox[{"pos", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"probavector", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"HistoricalDataList", "[", 
                    RowBox[{"[", 
                    RowBox[{"ntik", ",", "n"}], "]"}], "]"}], "-", 
                    RowBox[{"thetaList", "[", 
                    RowBox[{"[", 
                    RowBox[{"ntik", ",", "j", ",", "1"}], "]"}], "]"}]}], 
                    ")"}], "^", "2"}]}], "/", 
                   RowBox[{
                    RowBox[{"thetaList", "[", 
                    RowBox[{"[", 
                    RowBox[{"ntik", ",", "j", ",", "2"}], "]"}], "]"}], "^", 
                    "2"}]}], "-", 
                  RowBox[{"Log", "[", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"2", " ", "Pi"}], "]"}], " ", 
                    RowBox[{"thetaList", "[", 
                    RowBox[{"[", 
                    RowBox[{"ntik", ",", "j", ",", "2"}], "]"}], "]"}]}], 
                    ")"}], "]"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", "numberState"}], "}"}]}], 
               "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"probavector", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "=", 
                 RowBox[{"-", 
                  RowBox[{"N", "[", 
                   RowBox[{"Log", "[", 
                    RowBox[{"dimList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", "numberState"}], "}"}]}], "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"namedVectorList", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", "nodename"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"namedVectorList", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "=", 
              RowBox[{"probavector", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "NumberOfNodes"}], "}"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"BuildVectorTensoriallyLogC2", "[", 
         RowBox[{"namedVectorList", ",", "nodeNameList", ",", "dimList"}], 
         "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"namedVectorList", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nodename", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"probavector", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dimMax", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"pos", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ntik", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"numberState", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"NumberOfStates", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"NumberOfNodes", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"NbParammax", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"NumberOfStateMax", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"BuildVectorTensoriallyLogC2", "[", "_", "]"}], ",", "_Real",
          ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.606054383993484*^9, 3.6060544336330023`*^9}, 
   3.606054480870105*^9, 3.6060545349088516`*^9, {3.60605551804996*^9, 
   3.606055529250832*^9}, 3.606055571683104*^9, {3.606055797510152*^9, 
   3.6060558274155436`*^9}, {3.6060558979123955`*^9, 3.606055902420824*^9}, {
   3.606056550782917*^9, 3.606056569019434*^9}, {3.606056632714642*^9, 
   3.6060566408578944`*^9}, {3.606056750479797*^9, 3.606056795423685*^9}, {
   3.6060569340929737`*^9, 3.6060569535150986`*^9}, {3.60605703329401*^9, 
   3.606057097160819*^9}, {3.6060571609340277`*^9, 3.6060571656764584`*^9}, {
   3.6060572305884743`*^9, 3.606057234738101*^9}, {3.6060574716880198`*^9, 
   3.6060574747144394`*^9}, {3.6060578697557716`*^9, 
   3.6060578874774857`*^9}, {3.606058174488125*^9, 3.606058189698223*^9}, {
   3.6060582361397204`*^9, 3.6060582868244452`*^9}, {3.6060591401247253`*^9, 
   3.606059178001768*^9}, {3.6060593899135265`*^9, 3.6060593909743333`*^9}, {
   3.606383585284418*^9, 3.6063835971160946`*^9}, {3.6063965030259967`*^9, 
   3.6063965113414726`*^9}, {3.6063966098291054`*^9, 3.606396615419425*^9}, {
   3.606465254545142*^9, 3.606465259708808*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize3", "[", "M_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"M", "\[LeftDoubleBracket]", 
      RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], 
     RowBox[{"Plus", "@@", 
      RowBox[{"M", "\[LeftDoubleBracket]", 
       RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}]], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{
       RowBox[{"Dimensions", "[", "M", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", 
      RowBox[{
       RowBox[{"Dimensions", "[", "M", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.601922935906269*^9, 3.601922938626552*^9}, {
  3.601923128308861*^9, 3.601923152402019*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalize2", "[", "M_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"M", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
     RowBox[{"Plus", "@@", 
      RowBox[{"M", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]], 
    ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{
       RowBox[{"Dimensions", "[", "M", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.601922935906269*^9, 3.601922938626552*^9}, {
  3.601923128308861*^9, 3.601923152402019*^9}, {3.601923646346136*^9, 
  3.601923678272503*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "A", ",", "B", ",", "F", ",", "A1", ",", "B1", ",", "F1", ",", "G2", ",", 
     "nodeNameList", ",", "emissionNodeList", ",", "emissionTikerList", ",", 
     "thetaList", ",", "HistoricalDataList", ",", "NumberOfStateServer", ",", 
     "dimList", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1.", ",", "2."}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3.", ",", "4."}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"10.", ",", "2."}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"30.", ",", "4."}], "}"}]}], "}"}]}], "}"}]}], ";", 
    RowBox[{"B", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1.1", ",", "0.92"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3.3", ",", "4.456789"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"11", ",", "0.92"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"33", ",", "4.456789"}], "}"}]}], "}"}]}], "}"}]}], ";", 
    RowBox[{"F", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"10.1", ",", "2.2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"30.3", ",", "4.4"}], "}"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"A1", "=", 
     RowBox[{"MNormalize3", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"B1", "=", 
     RowBox[{"MNormalize3", "[", "B", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"F1", "=", 
     RowBox[{"MNormalize2", "[", "F", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"G2", "=", 
     RowBox[{"BuildMatrixFromLocalCliqueTensor", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "3", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", "3", ",", "B1"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "2", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", "2", ",", "A1"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "}"}], ",", "1", ",", "F1"}], "}"}]}], 
       "\[IndentingNewLine]", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"nodeNameList", "=", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"emissionNodeList", "=", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"dimList", "=", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "2"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"HistoricalDataList", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"GetHistory", "[", 
        RowBox[{"\"\<SPXT\>\"", ",", "10"}], "]"}], ",", 
       RowBox[{"GetHistory", "[", 
        RowBox[{"\"\<VIX\>\"", ",", "10"}], "]"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"thetaList", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1695", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1695", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"16", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"15", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"15", ",", "3"}], "}"}]}], "}"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"n", "=", "3"}], ";", "\[IndentingNewLine]", 
    RowBox[{"BuildGammaVectorLogC", "[", 
     RowBox[{
     "nodeNameList", ",", "emissionNodeList", ",", "thetaList", ",", 
      "HistoricalDataList", ",", "dimList", ",", "n"}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.601725465768187*^9, 3.601725533578105*^9}, {
   3.60172562706312*^9, 3.6017257164276*^9}, {3.6017257481687326`*^9, 
   3.601725777498764*^9}, {3.6017258852505903`*^9, 3.601725984692656*^9}, {
   3.601726052779583*^9, 3.601726109810478*^9}, {3.6017262874795732`*^9, 
   3.6017263373420687`*^9}, {3.6017264514709253`*^9, 3.601726467872196*^9}, {
   3.601726645654334*^9, 3.601726711711973*^9}, {3.601726871663035*^9, 
   3.601726940160584*^9}, {3.601726988197237*^9, 3.601727016619625*^9}, {
   3.601727128061441*^9, 3.601727174453053*^9}, {3.6017272053029118`*^9, 
   3.601727328946898*^9}, {3.601727417359145*^9, 3.601727424381797*^9}, {
   3.601727506192213*^9, 3.601727511816321*^9}, {3.6017278329956017`*^9, 
   3.601727916817307*^9}, {3.60172810613264*^9, 3.601728112787984*^9}, {
   3.601728204610825*^9, 3.6017282372737703`*^9}, {3.601728614854721*^9, 
   3.6017286193179417`*^9}, {3.601728658348229*^9, 3.601728670554747*^9}, {
   3.601728714964184*^9, 3.601728745929097*^9}, {3.601728834015621*^9, 
   3.6017289098703203`*^9}, {3.60173197495368*^9, 3.601731984392928*^9}, 
   3.601732084654662*^9, {3.601906055362743*^9, 3.60190606987576*^9}, {
   3.601906127698427*^9, 3.6019061287617607`*^9}, {3.6025152060826902`*^9, 
   3.602515232143875*^9}, {3.6060267640193567`*^9, 3.606026790555127*^9}, {
   3.6060273478317137`*^9, 3.6060273513261366`*^9}, {3.606054649163984*^9, 
   3.6060546741865444`*^9}, {3.606054733700926*^9, 3.606054766617137*^9}, {
   3.606054816116254*^9, 3.606054842917226*^9}, {3.6060551138489647`*^9, 
   3.6060551177801895`*^9}, {3.6060552209748507`*^9, 3.6060552662151413`*^9}, 
   3.6060592925689025`*^9, 3.6060597450966034`*^9, {3.606059818931876*^9, 
   3.606059829399544*^9}, {3.6060598957779694`*^9, 3.6060599010508027`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "14.393124246969291`"}], ",", 
   RowBox[{"-", "7.164396427529237`"}], ",", 
   RowBox[{"-", "13.791571427529236`"}], ",", 
   RowBox[{"-", "6.562843608089181`"}], ",", 
   RowBox[{"-", "14.194314313415179`"}], ",", 
   RowBox[{"-", "6.965586493975123`"}], ",", 
   RowBox[{"-", "14.393124246969291`"}], ",", 
   RowBox[{"-", "7.164396427529237`"}], ",", 
   RowBox[{"-", "13.791571427529236`"}], ",", 
   RowBox[{"-", "6.562843608089181`"}], ",", 
   RowBox[{"-", "14.194314313415179`"}], ",", 
   RowBox[{"-", "6.965586493975123`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6060552706455693`*^9, 3.606055592774439*^9, 3.606059297716935*^9, {
   3.6060598110538263`*^9, 3.606059833049967*^9}, 3.6060599031412163`*^9, 
   3.6061177887950487`*^9, 3.606123936798142*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"StructuringChangeStateConditionC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"CurrentSate1", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"CurrentSate2", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"StructuringPositionList", ",", "_Integer", ",", "1"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"ControlledSubPositionList", ",", "_Integer", ",", "1"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"StructuringSuperPositionList", ",", "_Integer", ",", "1"}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"result", "=", "0"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"CurrentSate1", "[", 
                  RowBox[{"[", 
                   RowBox[{"StructuringPositionList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ">", "1"}], 
                ")"}], "&&", " ", "\[IndentingNewLine]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"CurrentSate1", "[", 
                  RowBox[{"[", 
                   RowBox[{"ControlledSubPositionList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "!=", 
                 RowBox[{"CurrentSate2", "[", 
                  RowBox[{"[", 
                   RowBox[{"ControlledSubPositionList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ")"}]}], 
              ")"}], ",", "  ", 
             RowBox[{"result", "=", "1"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"StructuringSuperPositionList", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "\[NotEqual]", "0"}], ")"}], 
             ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"CurrentSate2", "[", 
                    RowBox[{"[", 
                    RowBox[{"StructuringPositionList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ">", "1"}], 
                  ")"}], "&&", " ", "\[IndentingNewLine]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"CurrentSate2", "[", 
                    RowBox[{"[", 
                    RowBox[{"StructuringSuperPositionList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "==", "1"}],
                   " ", ")"}]}], ")"}], ",", "  ", 
               RowBox[{"result", "=", "1"}]}], "]"}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "StructuringPositionList", "]"}]}], 
           "}"}]}], "]"}], ";", "\[IndentingNewLine]", "result"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"result", ",", "_Integer"}], "}"}], "}"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6049318954498434`*^9, 3.604931912547553*^9}, {
   3.604932064336526*^9, 3.6049320648357286`*^9}, {3.6049321357693834`*^9, 
   3.6049321371577926`*^9}, {3.6049324645258913`*^9, 
   3.6049324702823277`*^9}, {3.6050105360476065`*^9, 3.6050105394640284`*^9}, 
   3.6050105758902617`*^9, {3.605011677984138*^9, 3.6050117551578326`*^9}, {
   3.6050119172740717`*^9, 3.605011949425878*^9}, {3.605013270551152*^9, 
   3.605013292204091*^9}, {3.6050135609002132`*^9, 3.605013597466848*^9}, {
   3.6050136280586443`*^9, 3.6050138578789225`*^9}, {3.605014799377158*^9, 
   3.605014799891961*^9}, {3.6050148409358244`*^9, 3.6050148612783546`*^9}, {
   3.605014927001576*^9, 3.6050150069052887`*^9}, {3.6050150584792185`*^9, 
   3.6050150898042192`*^9}, {3.605015136464119*^9, 3.605015137930528*^9}, {
   3.605015405581444*^9, 3.6050154059714465`*^9}, {3.6050154599321923`*^9, 
   3.6050154854861565`*^9}, {3.6051031086717305`*^9, 
   3.6051031161131563`*^9}, {3.60519311998604*^9, 3.6051931405212145`*^9}, 
   3.6051961331383824`*^9, {3.6051962284418335`*^9, 3.605196232280053*^9}, {
   3.6051962979718103`*^9, 3.605196304485183*^9}, {3.606134520279641*^9, 
   3.6061345354492493`*^9}, {3.6061345761288424`*^9, 3.606134642578178*^9}, 
   3.6061346892277117`*^9, {3.6070685127334476`*^9, 3.6070685306054697`*^9}, {
   3.6070688145907125`*^9, 3.607068829622573*^9}, {3.607072294438749*^9, 
   3.607072295085786*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FNormalizeLogB", "[", 
   RowBox[{"tenseur_", ",", "dimList_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"HDim", "=", 
       RowBox[{"Length", "[", "dimList", "]"}]}], ",", "tenseur2", ",", 
      "norm0", ",", "norm1", ",", "norm3", ",", "norm2", ",", "norm4", ",", 
      "norm5", ",", "norm6", ",", "norm7"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tenseur2", "=", "tenseur"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{"HDim", ",", "\[IndentingNewLine]", "1", ",", 
       RowBox[{
        RowBox[{"norm0", "=", 
         RowBox[{"LogSumExpC", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"tenseur", 
             StyleBox["[",
              FontWeight->"Plain"], 
             RowBox[{"[", 
              RowBox[{"TenseurIndexC", "[", 
               RowBox[{
                RowBox[{"{", "i11", "}"}], ",", "dimList"}], "]"}], "]"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i11", ",", "1", ",", 
              RowBox[{"dimList", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"tenseur2", "[", 
            RowBox[{"[", 
             RowBox[{"TenseurIndexC", "[", 
              RowBox[{
               RowBox[{"{", "i1", "}"}], ",", "dimList"}], "]"}], "]"}], 
            "]"}], "=", 
           RowBox[{"ExpRC", "[", 
            RowBox[{
             RowBox[{"tenseur", "[", 
              RowBox[{"[", 
               RowBox[{"TenseurIndexC", "[", 
                RowBox[{
                 RowBox[{"{", "i1", "}"}], ",", "dimList"}], "]"}], "]"}], 
              "]"}], "-", "norm0"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "2", ",", 
       RowBox[{
        RowBox[{"norm1", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"LogSumExpC", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"tenseur", 
               StyleBox["[",
                FontWeight->"Plain"], 
               RowBox[{"[", 
                RowBox[{"TenseurIndexC", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i1", ",", "i2"}], "}"}], ",", "dimList"}], "]"}], 
                "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i2", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i1", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"tenseur2", "[", 
            RowBox[{"[", 
             RowBox[{"TenseurIndexC", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i1", ",", "i2"}], "}"}], ",", "dimList"}], "]"}], 
             "]"}], "]"}], "=", 
           RowBox[{"ExpRC", "[", 
            RowBox[{
             RowBox[{"tenseur", "[", 
              RowBox[{"[", 
               RowBox[{"TenseurIndexC", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i1", ",", "i2"}], "}"}], ",", "dimList"}], "]"}], 
               "]"}], "]"}], "-", 
             RowBox[{"norm1", "[", 
              RowBox[{"[", "i1", "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i2", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "3", ",", 
       RowBox[{
        RowBox[{"norm2", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"LogSumExpC", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"tenseur", 
               StyleBox["[",
                FontWeight->"Plain"], 
               RowBox[{"[", 
                RowBox[{"TenseurIndexC", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i1", ",", "i2", ",", "i3"}], "}"}], ",", 
                  "dimList"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i3", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i1", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i2", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"tenseur2", "[", 
            RowBox[{"[", 
             RowBox[{"TenseurIndexC", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i1", ",", "i2", ",", "i3"}], "}"}], ",", "dimList"}],
               "]"}], "]"}], "]"}], "=", 
           RowBox[{"ExpRC", "[", 
            RowBox[{
             RowBox[{"tenseur", "[", 
              RowBox[{"[", 
               RowBox[{"TenseurIndexC", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i1", ",", "i2", ",", "i3"}], "}"}], ",", 
                 "dimList"}], "]"}], "]"}], "]"}], "-", 
             RowBox[{"norm2", "[", 
              RowBox[{"[", 
               RowBox[{"i1", ",", "i2"}], "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i2", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i3", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "4", ",", 
       RowBox[{
        RowBox[{"norm3", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"LogSumExpC", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"tenseur", 
               StyleBox["[",
                FontWeight->"Plain"], 
               RowBox[{"[", 
                RowBox[{"TenseurIndexC", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4"}], "}"}], 
                  ",", "dimList"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i4", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i1", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i2", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i3", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"tenseur2", "[", 
            RowBox[{"[", 
             RowBox[{"TenseurIndexC", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4"}], "}"}], ",", 
               "dimList"}], "]"}], "]"}], "]"}], "=", 
           RowBox[{"ExpRC", "[", 
            RowBox[{
             RowBox[{"tenseur", "[", 
              RowBox[{"[", 
               RowBox[{"TenseurIndexC", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4"}], "}"}], ",",
                  "dimList"}], "]"}], "]"}], "]"}], "-", 
             RowBox[{"norm3", "[", 
              RowBox[{"[", 
               RowBox[{"i1", ",", "i2", ",", "i3"}], "]"}], "]"}]}], "]"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i2", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i3", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i4", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "5", ",", 
       RowBox[{
        RowBox[{"norm4", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"LogSumExpC", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"tenseur", 
               StyleBox["[",
                FontWeight->"Plain"], 
               RowBox[{"[", 
                RowBox[{"TenseurIndexC", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5"}],
                    "}"}], ",", "dimList"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i5", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i1", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i2", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i3", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i4", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"tenseur2", "[", 
            RowBox[{"[", 
             RowBox[{"TenseurIndexC", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5"}], 
                "}"}], ",", "dimList"}], "]"}], "]"}], "]"}], "=", 
           RowBox[{"ExpRC", "[", 
            RowBox[{
             RowBox[{"tenseur", "[", 
              RowBox[{"[", 
               RowBox[{"TenseurIndexC", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5"}], 
                  "}"}], ",", "dimList"}], "]"}], "]"}], "]"}], "-", 
             RowBox[{"norm4", "[", 
              RowBox[{"[", 
               RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4"}], "]"}], 
              "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i2", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i3", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i4", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i5", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "6", ",", 
       RowBox[{
        RowBox[{"norm5", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"LogSumExpC", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"tenseur", 
               StyleBox["[",
                FontWeight->"Plain"], 
               RowBox[{"[", 
                RowBox[{"TenseurIndexC", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", 
                    "i6"}], "}"}], ",", "dimList"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i6", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i1", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i2", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i3", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i4", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i5", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"tenseur2", "[", 
            RowBox[{"[", 
             RowBox[{"TenseurIndexC", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", "i6"}],
                 "}"}], ",", "dimList"}], "]"}], "]"}], "]"}], "=", 
           RowBox[{"ExpRC", "[", 
            RowBox[{
             RowBox[{"tenseur", "[", 
              RowBox[{"[", 
               RowBox[{"TenseurIndexC", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", 
                   "i6"}], "}"}], ",", "dimList"}], "]"}], "]"}], "]"}], "-", 
             RowBox[{"norm5", "[", 
              RowBox[{"[", 
               RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5"}], 
               "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i2", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i3", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i4", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i5", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i6", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "7", ",", 
       RowBox[{
        RowBox[{"norm6", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"LogSumExpC", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"tenseur", 
               StyleBox["[",
                FontWeight->"Plain"], 
               RowBox[{"[", 
                RowBox[{"TenseurIndexC", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", 
                    "i6", ",", "i7"}], "}"}], ",", "dimList"}], "]"}], "]"}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i7", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i1", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i2", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i3", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i4", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i5", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i6", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"tenseur2", "[", 
            RowBox[{"[", 
             RowBox[{"TenseurIndexC", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", "i6", 
                 ",", "i7"}], "}"}], ",", "dimList"}], "]"}], "]"}], "]"}], 
           "=", 
           RowBox[{"ExpRC", "[", 
            RowBox[{
             RowBox[{"tenseur", "[", 
              RowBox[{"[", 
               RowBox[{"TenseurIndexC", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", "i6",
                    ",", "i7"}], "}"}], ",", "dimList"}], "]"}], "]"}], "]"}],
              "-", 
             RowBox[{"norm6", "[", 
              RowBox[{"[", 
               RowBox[{
               "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", "i6"}], 
               "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i2", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i3", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i4", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i5", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i6", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i7", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "8", ",", 
       RowBox[{
        RowBox[{"norm7", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"LogSumExpC", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"tenseur", 
               StyleBox["[",
                FontWeight->"Plain"], 
               RowBox[{"[", 
                RowBox[{"TenseurIndexC", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", 
                    "i6", ",", "i7", ",", "i8"}], "}"}], ",", "dimList"}], 
                 "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i8", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "8", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i1", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i2", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i3", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i4", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i5", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i6", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i7", ",", "1", ",", 
             RowBox[{"dimList", "[", 
              RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"tenseur2", "[", 
            RowBox[{"[", 
             RowBox[{"TenseurIndexC", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", "i6", 
                 ",", "i7", ",", "i8"}], "}"}], ",", "dimList"}], "]"}], 
             "]"}], "]"}], "=", 
           RowBox[{"ExpRC", "[", 
            RowBox[{
             RowBox[{"tenseur", "[", 
              RowBox[{"[", 
               RowBox[{"TenseurIndexC", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", "i6",
                    ",", "i7", ",", "i8"}], "}"}], ",", "dimList"}], "]"}], 
               "]"}], "]"}], "-", 
             RowBox[{"norm7", "[", 
              RowBox[{"[", 
               RowBox[{
               "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", "i6", 
                ",", "i7"}], "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i2", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i3", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i4", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i5", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i6", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i7", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i8", ",", "1", ",", 
            RowBox[{"dimList", "[", 
             RowBox[{"[", "8", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "tenseur2"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60527381807193*^9, 3.6052738554185686`*^9}, {
   3.6068134002984223`*^9, 3.6068134332148447`*^9}, {3.6068134662092676`*^9, 
   3.606813471201331*^9}, {3.6068136352374344`*^9, 3.6068136367974544`*^9}, {
   3.606813690914548*^9, 3.6068137077315636`*^9}, {3.606813740335982*^9, 
   3.6068137853269587`*^9}, {3.6068139416263623`*^9, 3.606813975400796*^9}, {
   3.606814378735577*^9, 3.606814391028535*^9}, {3.6068144382659407`*^9, 
   3.606814450574498*^9}, {3.606814492773039*^9, 3.6068145291683054`*^9}, {
   3.6068145826613913`*^9, 3.606814597824786*^9}, {3.6068148269687347`*^9, 
   3.6068148287003565`*^9}, {3.606814911250225*^9, 3.606814967176942*^9}, {
   3.6068150185796013`*^9, 3.6068150534764585`*^9}, {3.60681516356707*^9, 
   3.6068152648279676`*^9}, {3.6068153344526606`*^9, 
   3.6068153587577724`*^9}, {3.606816618006916*^9, 3.606816963349544*^9}, {
   3.606817022599104*^9, 3.6068170918327913`*^9}, {3.6068171490231247`*^9, 
   3.6068173697669544`*^9}, {3.6068173997973394`*^9, 3.606817483539213*^9}, 
   3.606819913283781*^9, 3.6070937968596168`*^9, {3.607159087266897*^9, 
   3.6071591360096855`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FNormalizeLogBC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tenseur", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dimList", ",", "_Integer", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"HDim", "=", 
          RowBox[{"Length", "[", "dimList", "]"}]}], ",", "tenseur2", ",", 
         "norm0", ",", "norm1", ",", "norm3", ",", "norm2", ",", "norm4", ",",
          "norm5", ",", "norm6", ",", "norm7"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tenseur2", "=", "tenseur"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Switch", "[", 
         RowBox[{"HDim", ",", "\[IndentingNewLine]", "1", ",", 
          RowBox[{
           RowBox[{"norm0", "=", 
            RowBox[{"LogSumExpC", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"tenseur", 
                StyleBox["[",
                 FontWeight->"Plain"], 
                RowBox[{"[", 
                 RowBox[{"TenseurIndexC", "[", 
                  RowBox[{
                   RowBox[{"{", "i11", "}"}], ",", "dimList"}], "]"}], "]"}], 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i11", ",", "1", ",", 
                 RowBox[{"dimList", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
           ";", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"tenseur2", "[", 
               RowBox[{"[", 
                RowBox[{"TenseurIndexC", "[", 
                 RowBox[{
                  RowBox[{"{", "i1", "}"}], ",", "dimList"}], "]"}], "]"}], 
               "]"}], "=", 
              RowBox[{"ExpRC", "[", 
               RowBox[{
                RowBox[{"tenseur", "[", 
                 RowBox[{"[", 
                  RowBox[{"TenseurIndexC", "[", 
                   RowBox[{
                    RowBox[{"{", "i1", "}"}], ",", "dimList"}], "]"}], "]"}], 
                 "]"}], "-", "norm0"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "2", ",", 
          RowBox[{
           RowBox[{"norm1", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"LogSumExpC", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"tenseur", 
                  StyleBox["[",
                   FontWeight->"Plain"], 
                  RowBox[{"[", 
                   RowBox[{"TenseurIndexC", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i1", ",", "i2"}], "}"}], ",", "dimList"}], "]"}],
                    "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i2", ",", "1", ",", 
                   RowBox[{"dimList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"tenseur2", "[", 
               RowBox[{"[", 
                RowBox[{"TenseurIndexC", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i1", ",", "i2"}], "}"}], ",", "dimList"}], "]"}], 
                "]"}], "]"}], "=", 
              RowBox[{"ExpRC", "[", 
               RowBox[{
                RowBox[{"tenseur", "[", 
                 RowBox[{"[", 
                  RowBox[{"TenseurIndexC", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i1", ",", "i2"}], "}"}], ",", "dimList"}], "]"}],
                   "]"}], "]"}], "-", 
                RowBox[{"norm1", "[", 
                 RowBox[{"[", "i1", "]"}], "]"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i2", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "3", ",", 
          RowBox[{
           RowBox[{"norm2", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"LogSumExpC", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"tenseur", 
                  StyleBox["[",
                   FontWeight->"Plain"], 
                  RowBox[{"[", 
                   RowBox[{"TenseurIndexC", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i1", ",", "i2", ",", "i3"}], "}"}], ",", 
                    "dimList"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i3", ",", "1", ",", 
                   RowBox[{"dimList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i2", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"tenseur2", "[", 
               RowBox[{"[", 
                RowBox[{"TenseurIndexC", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i1", ",", "i2", ",", "i3"}], "}"}], ",", 
                  "dimList"}], "]"}], "]"}], "]"}], "=", 
              RowBox[{"ExpRC", "[", 
               RowBox[{
                RowBox[{"tenseur", "[", 
                 RowBox[{"[", 
                  RowBox[{"TenseurIndexC", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i1", ",", "i2", ",", "i3"}], "}"}], ",", 
                    "dimList"}], "]"}], "]"}], "]"}], "-", 
                RowBox[{"norm2", "[", 
                 RowBox[{"[", 
                  RowBox[{"i1", ",", "i2"}], "]"}], "]"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i2", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i3", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "4", ",", 
          RowBox[{
           RowBox[{"norm3", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"LogSumExpC", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"tenseur", 
                  StyleBox["[",
                   FontWeight->"Plain"], 
                  RowBox[{"[", 
                   RowBox[{"TenseurIndexC", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4"}], "}"}], 
                    ",", "dimList"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i4", ",", "1", ",", 
                   RowBox[{"dimList", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i2", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i3", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"tenseur2", "[", 
               RowBox[{"[", 
                RowBox[{"TenseurIndexC", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4"}], "}"}], 
                  ",", "dimList"}], "]"}], "]"}], "]"}], "=", 
              RowBox[{"ExpRC", "[", 
               RowBox[{
                RowBox[{"tenseur", "[", 
                 RowBox[{"[", 
                  RowBox[{"TenseurIndexC", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4"}], "}"}], 
                    ",", "dimList"}], "]"}], "]"}], "]"}], "-", 
                RowBox[{"norm3", "[", 
                 RowBox[{"[", 
                  RowBox[{"i1", ",", "i2", ",", "i3"}], "]"}], "]"}]}], 
               "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i2", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i3", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i4", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "5", ",", 
          RowBox[{
           RowBox[{"norm4", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"LogSumExpC", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"tenseur", 
                  StyleBox["[",
                   FontWeight->"Plain"], 
                  RowBox[{"[", 
                   RowBox[{"TenseurIndexC", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5"}], "}"}],
                     ",", "dimList"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i5", ",", "1", ",", 
                   RowBox[{"dimList", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i2", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i3", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i4", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"tenseur2", "[", 
               RowBox[{"[", 
                RowBox[{"TenseurIndexC", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5"}],
                    "}"}], ",", "dimList"}], "]"}], "]"}], "]"}], "=", 
              RowBox[{"ExpRC", "[", 
               RowBox[{
                RowBox[{"tenseur", "[", 
                 RowBox[{"[", 
                  RowBox[{"TenseurIndexC", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5"}], "}"}],
                     ",", "dimList"}], "]"}], "]"}], "]"}], "-", 
                RowBox[{"norm4", "[", 
                 RowBox[{"[", 
                  RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4"}], "]"}], 
                 "]"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i2", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i3", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i4", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i5", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "6", ",", 
          RowBox[{
           RowBox[{"norm5", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"LogSumExpC", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"tenseur", 
                  StyleBox["[",
                   FontWeight->"Plain"], 
                  RowBox[{"[", 
                   RowBox[{"TenseurIndexC", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", 
                    "i6"}], "}"}], ",", "dimList"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i6", ",", "1", ",", 
                   RowBox[{"dimList", "[", 
                    RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i2", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i3", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i4", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i5", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"tenseur2", "[", 
               RowBox[{"[", 
                RowBox[{"TenseurIndexC", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", 
                    "i6"}], "}"}], ",", "dimList"}], "]"}], "]"}], "]"}], "=", 
              RowBox[{"ExpRC", "[", 
               RowBox[{
                RowBox[{"tenseur", "[", 
                 RowBox[{"[", 
                  RowBox[{"TenseurIndexC", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", 
                    "i6"}], "}"}], ",", "dimList"}], "]"}], "]"}], "]"}], "-", 
                RowBox[{"norm5", "[", 
                 RowBox[{"[", 
                  RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5"}], 
                  "]"}], "]"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i2", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i3", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i4", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i5", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i6", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "7", ",", 
          RowBox[{
           RowBox[{"norm6", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"LogSumExpC", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"tenseur", 
                  StyleBox["[",
                   FontWeight->"Plain"], 
                  RowBox[{"[", 
                   RowBox[{"TenseurIndexC", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", 
                    "i6", ",", "i7"}], "}"}], ",", "dimList"}], "]"}], "]"}], 
                  "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i7", ",", "1", ",", 
                   RowBox[{"dimList", "[", 
                    RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i2", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i3", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i4", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i5", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i6", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"tenseur2", "[", 
               RowBox[{"[", 
                RowBox[{"TenseurIndexC", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", 
                    "i6", ",", "i7"}], "}"}], ",", "dimList"}], "]"}], "]"}], 
               "]"}], "=", 
              RowBox[{"ExpRC", "[", 
               RowBox[{
                RowBox[{"tenseur", "[", 
                 RowBox[{"[", 
                  RowBox[{"TenseurIndexC", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", 
                    "i6", ",", "i7"}], "}"}], ",", "dimList"}], "]"}], "]"}], 
                 "]"}], "-", 
                RowBox[{"norm6", "[", 
                 RowBox[{"[", 
                  RowBox[{
                  "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", 
                   "i6"}], "]"}], "]"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i2", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i3", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i4", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i5", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i6", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i7", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "8", ",", 
          RowBox[{
           RowBox[{"norm7", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"LogSumExpC", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"tenseur", 
                  StyleBox["[",
                   FontWeight->"Plain"], 
                  RowBox[{"[", 
                   RowBox[{"TenseurIndexC", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", 
                    "i6", ",", "i7", ",", "i8"}], "}"}], ",", "dimList"}], 
                    "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i8", ",", "1", ",", 
                   RowBox[{"dimList", "[", 
                    RowBox[{"[", "8", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i2", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i3", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i4", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i5", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i6", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i7", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"tenseur2", "[", 
               RowBox[{"[", 
                RowBox[{"TenseurIndexC", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", 
                    "i6", ",", "i7", ",", "i8"}], "}"}], ",", "dimList"}], 
                 "]"}], "]"}], "]"}], "=", 
              RowBox[{"ExpRC", "[", 
               RowBox[{
                RowBox[{"tenseur", "[", 
                 RowBox[{"[", 
                  RowBox[{"TenseurIndexC", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", 
                    "i6", ",", "i7", ",", "i8"}], "}"}], ",", "dimList"}], 
                   "]"}], "]"}], "]"}], "-", 
                RowBox[{"norm7", "[", 
                 RowBox[{"[", 
                  RowBox[{
                  "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", "i6",
                    ",", "i7"}], "]"}], "]"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i2", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i3", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i4", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i5", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i6", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i7", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "7", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i8", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "8", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "tenseur2"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tenseur2", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"norm0", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"norm1", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"norm2", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"norm3", ",", "_Real", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"norm4", ",", "_Real", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"norm5", ",", "_Real", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"norm6", ",", "_Real", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"norm7", ",", "_Real", ",", "7"}], "}"}]}], "}"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", " ", 
       RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60527381807193*^9, 3.6052738554185686`*^9}, {
   3.6068134002984223`*^9, 3.6068134332148447`*^9}, {3.6068134662092676`*^9, 
   3.606813471201331*^9}, {3.6068136352374344`*^9, 3.6068136367974544`*^9}, {
   3.606813690914548*^9, 3.6068137077315636`*^9}, {3.606813740335982*^9, 
   3.6068137853269587`*^9}, {3.6068139416263623`*^9, 3.606813975400796*^9}, {
   3.606814378735577*^9, 3.606814391028535*^9}, {3.6068144382659407`*^9, 
   3.606814450574498*^9}, {3.606814492773039*^9, 3.6068145291683054`*^9}, {
   3.6068145826613913`*^9, 3.606814597824786*^9}, {3.6068148269687347`*^9, 
   3.6068148287003565`*^9}, {3.606814911250225*^9, 3.606814967176942*^9}, {
   3.6068150185796013`*^9, 3.6068150534764585`*^9}, {3.60681516356707*^9, 
   3.6068152648279676`*^9}, {3.6068153344526606`*^9, 
   3.6068153587577724`*^9}, {3.606816618006916*^9, 3.606816963349544*^9}, {
   3.606817022599104*^9, 3.6068170918327913`*^9}, {3.6068171490231247`*^9, 
   3.6068173697669544`*^9}, {3.6068173997973394`*^9, 3.606817483539213*^9}, 
   3.606819913283781*^9, 3.6070937968596168`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SumC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"vect", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"i", "=", "1"}], 
       RowBox[{"Length", "[", "vect", "]"}]], 
      RowBox[{
      "vect", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.606824919005575*^9, 3.6068249807667675`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LogSumC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"vect", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
     RowBox[{"LogRC", "[", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], 
        RowBox[{"Length", "[", "vect", "]"}]], 
       RowBox[{
       "vect", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
      "]"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.606824919005575*^9, 3.6068250117799644`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MNormalizeLogBC", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tenseur", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dimList", ",", "_Integer", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"HDim", "=", 
          RowBox[{"Length", "[", "dimList", "]"}]}], ",", "tenseur2", ",", 
         "norm0", ",", "norm1", ",", "norm3", ",", "norm2", ",", "norm4", ",",
          "norm5", ",", "norm6", ",", "norm7"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tenseur2", "=", "tenseur"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Switch", "[", 
         RowBox[{"HDim", ",", "\[IndentingNewLine]", "1", ",", 
          RowBox[{
           RowBox[{"norm0", "=", 
            RowBox[{"LogSumC", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"tenseur", 
                StyleBox["[",
                 FontWeight->"Plain"], 
                RowBox[{"[", 
                 RowBox[{"TenseurIndexC", "[", 
                  RowBox[{
                   RowBox[{"{", "i11", "}"}], ",", "dimList"}], "]"}], "]"}], 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i11", ",", "1", ",", 
                 RowBox[{"dimList", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
           ";", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"tenseur2", "[", 
               RowBox[{"[", 
                RowBox[{"TenseurIndexC", "[", 
                 RowBox[{
                  RowBox[{"{", "i1", "}"}], ",", "dimList"}], "]"}], "]"}], 
               "]"}], "=", 
              RowBox[{
               RowBox[{"LogRC", "[", 
                RowBox[{"tenseur", "[", 
                 RowBox[{"[", 
                  RowBox[{"TenseurIndexC", "[", 
                   RowBox[{
                    RowBox[{"{", "i1", "}"}], ",", "dimList"}], "]"}], "]"}], 
                 "]"}], "]"}], "-", "norm0"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "2", ",", 
          RowBox[{
           RowBox[{"norm1", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"LogSumC", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"tenseur", 
                  StyleBox["[",
                   FontWeight->"Plain"], 
                  RowBox[{"[", 
                   RowBox[{"TenseurIndexC", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i1", ",", "i2"}], "}"}], ",", "dimList"}], "]"}],
                    "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i2", ",", "1", ",", 
                   RowBox[{"dimList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"tenseur2", "[", 
               RowBox[{"[", 
                RowBox[{"TenseurIndexC", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i1", ",", "i2"}], "}"}], ",", "dimList"}], "]"}], 
                "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"LogRC", "[", 
                RowBox[{"tenseur", "[", 
                 RowBox[{"[", 
                  RowBox[{"TenseurIndexC", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i1", ",", "i2"}], "}"}], ",", "dimList"}], "]"}],
                   "]"}], "]"}], "]"}], "-", 
               RowBox[{"norm1", "[", 
                RowBox[{"[", "i1", "]"}], "]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i2", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "3", ",", 
          RowBox[{
           RowBox[{"norm2", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"LogSumC", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"tenseur", 
                  StyleBox["[",
                   FontWeight->"Plain"], 
                  RowBox[{"[", 
                   RowBox[{"TenseurIndexC", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i1", ",", "i2", ",", "i3"}], "}"}], ",", 
                    "dimList"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i3", ",", "1", ",", 
                   RowBox[{"dimList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i2", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"tenseur2", "[", 
               RowBox[{"[", 
                RowBox[{"TenseurIndexC", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i1", ",", "i2", ",", "i3"}], "}"}], ",", 
                  "dimList"}], "]"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"LogRC", "[", 
                RowBox[{"tenseur", "[", 
                 RowBox[{"[", 
                  RowBox[{"TenseurIndexC", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i1", ",", "i2", ",", "i3"}], "}"}], ",", 
                    "dimList"}], "]"}], "]"}], "]"}], "]"}], "-", 
               RowBox[{"norm2", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "i2"}], "]"}], "]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i2", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i3", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "4", ",", 
          RowBox[{
           RowBox[{"norm3", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"LogSumC", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"tenseur", 
                  StyleBox["[",
                   FontWeight->"Plain"], 
                  RowBox[{"[", 
                   RowBox[{"TenseurIndexC", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4"}], "}"}], 
                    ",", "dimList"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i4", ",", "1", ",", 
                   RowBox[{"dimList", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i2", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i3", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"tenseur2", "[", 
               RowBox[{"[", 
                RowBox[{"TenseurIndexC", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4"}], "}"}], 
                  ",", "dimList"}], "]"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"LogRC", "[", 
                RowBox[{"tenseur", "[", 
                 RowBox[{"[", 
                  RowBox[{"TenseurIndexC", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4"}], "}"}], 
                    ",", "dimList"}], "]"}], "]"}], "]"}], "]"}], "-", 
               RowBox[{"norm3", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "i2", ",", "i3"}], "]"}], "]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i2", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i3", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i4", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "5", ",", 
          RowBox[{
           RowBox[{"norm4", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"LogSumC", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"tenseur", 
                  StyleBox["[",
                   FontWeight->"Plain"], 
                  RowBox[{"[", 
                   RowBox[{"TenseurIndexC", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5"}], "}"}],
                     ",", "dimList"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i5", ",", "1", ",", 
                   RowBox[{"dimList", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i2", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i3", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i4", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"tenseur2", "[", 
               RowBox[{"[", 
                RowBox[{"TenseurIndexC", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5"}],
                    "}"}], ",", "dimList"}], "]"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"LogRC", "[", 
                RowBox[{"tenseur", "[", 
                 RowBox[{"[", 
                  RowBox[{"TenseurIndexC", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5"}], "}"}],
                     ",", "dimList"}], "]"}], "]"}], "]"}], "]"}], "-", 
               RowBox[{"norm4", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4"}], "]"}], 
                "]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i2", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i3", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i4", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i5", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "6", ",", 
          RowBox[{
           RowBox[{"norm5", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"LogSumC", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"tenseur", 
                  StyleBox["[",
                   FontWeight->"Plain"], 
                  RowBox[{"[", 
                   RowBox[{"TenseurIndexC", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", 
                    "i6"}], "}"}], ",", "dimList"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i6", ",", "1", ",", 
                   RowBox[{"dimList", "[", 
                    RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i2", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i3", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i4", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i5", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"tenseur2", "[", 
               RowBox[{"[", 
                RowBox[{"TenseurIndexC", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", 
                    "i6"}], "}"}], ",", "dimList"}], "]"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"LogRC", "[", 
                RowBox[{"tenseur", "[", 
                 RowBox[{"[", 
                  RowBox[{"TenseurIndexC", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", 
                    "i6"}], "}"}], ",", "dimList"}], "]"}], "]"}], "]"}], 
                "]"}], "-", 
               RowBox[{"norm5", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5"}], 
                 "]"}], "]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i2", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i3", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i4", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i5", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i6", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "7", ",", 
          RowBox[{
           RowBox[{"norm6", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"LogSumC", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"tenseur", 
                  StyleBox["[",
                   FontWeight->"Plain"], 
                  RowBox[{"[", 
                   RowBox[{"TenseurIndexC", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", 
                    "i6", ",", "i7"}], "}"}], ",", "dimList"}], "]"}], "]"}], 
                  "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i7", ",", "1", ",", 
                   RowBox[{"dimList", "[", 
                    RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i2", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i3", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i4", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i5", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i6", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"tenseur2", "[", 
               RowBox[{"[", 
                RowBox[{"TenseurIndexC", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", 
                    "i6", ",", "i7"}], "}"}], ",", "dimList"}], "]"}], "]"}], 
               "]"}], "=", 
              RowBox[{
               RowBox[{"LogRC", "[", 
                RowBox[{"tenseur", "[", 
                 RowBox[{"[", 
                  RowBox[{"TenseurIndexC", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", 
                    "i6", ",", "i7"}], "}"}], ",", "dimList"}], "]"}], "]"}], 
                 "]"}], "]"}], "-", 
               RowBox[{"norm6", "[", 
                RowBox[{"[", 
                 RowBox[{
                 "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", 
                  "i6"}], "]"}], "]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i2", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i3", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i4", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i5", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i6", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i7", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "8", ",", 
          RowBox[{
           RowBox[{"norm7", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"LogSumC", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"tenseur", 
                  StyleBox["[",
                   FontWeight->"Plain"], 
                  RowBox[{"[", 
                   RowBox[{"TenseurIndexC", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", 
                    "i6", ",", "i7", ",", "i8"}], "}"}], ",", "dimList"}], 
                    "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i8", ",", "1", ",", 
                   RowBox[{"dimList", "[", 
                    RowBox[{"[", "8", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i2", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i3", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i4", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i5", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i6", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i7", ",", "1", ",", 
                RowBox[{"dimList", "[", 
                 RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"tenseur2", "[", 
               RowBox[{"[", 
                RowBox[{"TenseurIndexC", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", 
                    "i6", ",", "i7", ",", "i8"}], "}"}], ",", "dimList"}], 
                 "]"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"LogRC", "[", 
                RowBox[{"tenseur", "[", 
                 RowBox[{"[", 
                  RowBox[{"TenseurIndexC", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", 
                    "i6", ",", "i7", ",", "i8"}], "}"}], ",", "dimList"}], 
                   "]"}], "]"}], "]"}], "]"}], "-", 
               RowBox[{"norm7", "[", 
                RowBox[{"[", 
                 RowBox[{
                 "i1", ",", "i2", ",", "i3", ",", "i4", ",", "i5", ",", "i6", 
                  ",", "i7"}], "]"}], "]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i2", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i3", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i4", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i5", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i6", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i7", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "7", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i8", ",", "1", ",", 
               RowBox[{"dimList", "[", 
                RowBox[{"[", "8", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "tenseur2"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tenseur2", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"norm0", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"norm1", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"norm2", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"norm3", ",", "_Real", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"norm4", ",", "_Real", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"norm5", ",", "_Real", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"norm6", ",", "_Real", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"norm7", ",", "_Real", ",", "7"}], "}"}]}], "}"}], ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", " ", 
       RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.60527381807193*^9, 3.6052738554185686`*^9}, {
   3.6068134002984223`*^9, 3.6068134332148447`*^9}, {3.6068134662092676`*^9, 
   3.606813471201331*^9}, {3.6068136352374344`*^9, 3.6068136367974544`*^9}, {
   3.606813690914548*^9, 3.6068137077315636`*^9}, {3.606813740335982*^9, 
   3.6068137853269587`*^9}, {3.6068139416263623`*^9, 3.606813975400796*^9}, {
   3.606814378735577*^9, 3.606814391028535*^9}, {3.6068144382659407`*^9, 
   3.606814450574498*^9}, {3.606814492773039*^9, 3.6068145291683054`*^9}, {
   3.6068145826613913`*^9, 3.606814597824786*^9}, {3.6068148269687347`*^9, 
   3.6068148287003565`*^9}, {3.606814911250225*^9, 3.606814967176942*^9}, {
   3.6068150185796013`*^9, 3.6068150534764585`*^9}, {3.60681516356707*^9, 
   3.6068152648279676`*^9}, {3.6068153344526606`*^9, 
   3.6068153587577724`*^9}, {3.606816618006916*^9, 3.606816963349544*^9}, {
   3.606817022599104*^9, 3.6068170918327913`*^9}, {3.6068171490231247`*^9, 
   3.6068173697669544`*^9}, {3.6068173997973394`*^9, 3.606817483539213*^9}, 
   3.606819913283781*^9, {3.6068250847431*^9, 3.6068251136346707`*^9}, {
   3.6068251527755723`*^9, 3.6068251685941753`*^9}, {3.6068255412829533`*^9, 
   3.6068256364753733`*^9}, {3.607092439477979*^9, 3.607092440568042*^9}, {
   3.6070931579290724`*^9, 3.607093158906128*^9}, 3.607093247353187*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dimlist", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "4", ",", "5"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Random", "[", "]"}], ")"}], "&"}], ",", "dimlist"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<a=\>\"", ",", 
    RowBox[{"a", "//", "MatrixForm"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"0", "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"Apply", "[", 
       RowBox[{"Times", ",", "dimlist"}], "]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ind", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"1", "&"}], ",", 
     RowBox[{"Length", "[", "dimlist", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ind", "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", ">", "0"}], ",", " ", 
    RowBox[{
     RowBox[{"v", "=", 
      RowBox[{"Apply", "[", 
       RowBox[{"Part", ",", 
        RowBox[{"Insert", "[", 
         RowBox[{"ind", ",", "a", ",", "1"}], "]"}]}], "]"}]}], " ", ";", 
     RowBox[{
      RowBox[{"b", "[", 
       RowBox[{"[", 
        RowBox[{"TenseurIndexC", "[", 
         RowBox[{"ind", ",", "dimlist"}], "]"}], "]"}], "]"}], "=", "v"}], 
     ";", 
     RowBox[{"ind", "=", 
      RowBox[{"NextIndexC", "[", 
       RowBox[{"ind", ",", "dimlist"}], "]"}]}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a1", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", "0", ")"}], "&"}], ",", "dimlist"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ind", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"1", "&"}], ",", 
     RowBox[{"Length", "[", "dimlist", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ind", "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", ">", "0"}], ",", " ", 
    RowBox[{
     RowBox[{"v", "=", 
      RowBox[{"lectureTenseurC", "[", 
       RowBox[{"b", ",", "ind", ",", "dimlist"}], "]"}]}], ";", 
     RowBox[{"a1", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"a1", ",", 
        RowBox[{"ind", "\[Rule]", "v"}]}], "]"}]}], ";", 
     RowBox[{"ind", "=", 
      RowBox[{"NextIndexC", "[", 
       RowBox[{"ind", ",", "dimlist"}], "]"}]}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{"FNormalizeLogBC", "[", 
    RowBox[{"b", ",", "dimlist"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"MNormalizeLogBC", "[", 
    RowBox[{"b", ",", "dimlist"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c1", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", "0", ")"}], "&"}], ",", "dimlist"}], "]"}]}], ";", 
  RowBox[{"ind", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"1", "&"}], ",", 
     RowBox[{"Length", "[", "dimlist", "]"}]}], "]"}]}], ";", 
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ind", "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", ">", "0"}], ",", " ", 
    RowBox[{
     RowBox[{"v", "=", 
      RowBox[{"lectureTenseurC", "[", 
       RowBox[{"c", ",", "ind", ",", "dimlist"}], "]"}]}], ";", 
     RowBox[{"c1", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"c1", ",", 
        RowBox[{"ind", "\[Rule]", "v"}]}], "]"}]}], ";", 
     RowBox[{"ind", "=", 
      RowBox[{"NextIndexC", "[", 
       RowBox[{"ind", ",", "dimlist"}], "]"}]}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d1", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", "0", ")"}], "&"}], ",", "dimlist"}], "]"}]}], ";", 
  RowBox[{"ind", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"1", "&"}], ",", 
     RowBox[{"Length", "[", "dimlist", "]"}]}], "]"}]}], ";", 
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ind", "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", ">", "0"}], ",", " ", 
    RowBox[{
     RowBox[{"v", "=", 
      RowBox[{"lectureTenseurC", "[", 
       RowBox[{"d", ",", "ind", ",", "dimlist"}], "]"}]}], ";", 
     RowBox[{"d1", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"d1", ",", 
        RowBox[{"ind", "\[Rule]", "v"}]}], "]"}]}], ";", 
     RowBox[{"ind", "=", 
      RowBox[{"NextIndexC", "[", 
       RowBox[{"ind", ",", "dimlist"}], "]"}]}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<FNormalizeLogBC[b,dimlist]=\>\"", ",", 
    RowBox[{"c1", "//", "MatrixForm"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<FNormalizeLog[a]=\>\"", ",", 
    RowBox[{
     RowBox[{"FNormalizeLog", "[", "a", "]"}], "//", "MatrixForm"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<MNormalizeLogBC[b,dimlist]=\>\"", ",", 
    RowBox[{"d1", "//", "MatrixForm"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<MNormalizeLog1[a]=\>\"", ",", 
     RowBox[{
      RowBox[{"MNormalizeLog1", "[", "a", "]"}], "//", "MatrixForm"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6053591342783575`*^9, 3.605359182716668*^9}, {
   3.6053593328364305`*^9, 3.6053594733149366`*^9}, {3.6053595592402873`*^9, 
   3.605359614792243*^9}, {3.605359675913435*^9, 3.6053597008891954`*^9}, {
   3.6053598277804084`*^9, 3.6053598636450386`*^9}, {3.605359895235241*^9, 
   3.605359928151452*^9}, {3.6053601183010707`*^9, 3.6053601223570967`*^9}, {
   3.605360249289116*^9, 3.6053602888509693`*^9}, {3.6053603327964516`*^9, 
   3.605360332890052*^9}, {3.6053609523384285`*^9, 3.6053610361733656`*^9}, {
   3.6053612762589045`*^9, 3.605361351061384*^9}, {3.605361388111622*^9, 
   3.605361413102982*^9}, {3.605361484863442*^9, 3.605361502179553*^9}, {
   3.605361546608638*^9, 3.6053615528486776`*^9}, {3.605361626839952*^9, 
   3.6053616323467875`*^9}, 3.605361823182811*^9, {3.6053620701167936`*^9, 
   3.6053620850772896`*^9}, {3.6054171173104005`*^9, 3.605417135188115*^9}, {
   3.6068192160006413`*^9, 3.6068192206183004`*^9}, {3.6068194047796617`*^9, 
   3.6068194207542667`*^9}, {3.606819529316058*^9, 3.606819540938207*^9}, {
   3.6068195949460993`*^9, 3.6068196819328146`*^9}, {3.6068197169708643`*^9, 
   3.606819720012903*^9}, {3.6068197617590384`*^9, 3.6068198348771753`*^9}, {
   3.606819876233306*^9, 3.6068198770913167`*^9}, {3.606819942003749*^9, 
   3.6068199718625317`*^9}, {3.6068200287252607`*^9, 3.6068200977259455`*^9}, 
   3.606820190593936*^9, {3.6068252515872393`*^9, 3.606825259184537*^9}, 
   3.6068252974674273`*^9, {3.606825669220194*^9, 3.60682568689522*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"a=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.6400284007720468`", "0.6235030041826585`", 
            "0.32115346257615895`", "0.8398181558252361`", 
            "0.31746451840745776`"},
           {"0.23060827172812334`", "0.45525750847353236`", 
            "0.9852701028651183`", "0.2789614474692343`", 
            "0.2448016707320975`"},
           {"0.8630074418781499`", "0.5130393550786035`", 
            "0.8519655708529925`", "0.7834148938136085`", 
            "0.9272052365903101`"},
           {"0.6489317721042562`", "0.03874239907278208`", 
            "0.704967295512793`", "0.4889711682106107`", "0.958493546520122`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.37214517263946717`", "0.37515311154758924`", 
            "0.37613888891472425`", "0.8073643898104957`", 
            "0.7321167718674204`"},
           {"0.7516501073649308`", "0.05498542633856534`", 
            "0.9675462339852596`", "0.41465225345996265`", 
            "0.5210418356368074`"},
           {"0.599727917865033`", "0.9822761311201413`", 
            "0.13569080599072833`", "0.27624016490470993`", 
            "0.7367204759868831`"},
           {"0.46923677604153774`", "0.2837252351377358`", 
            "0.4928252710911014`", "0.809515239396573`", "0.8203050039372816`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.24498283606495372`", "0.7878579755783084`", 
            "0.3205440711859623`", "0.8618114574171596`", 
            "0.8728376634254865`"},
           {"0.4127048640307192`", "0.944405182271238`", 
            "0.05444706760666383`", "0.14072089155806616`", 
            "0.6610547566657885`"},
           {"0.8894197559326726`", "0.08690083362140417`", 
            "0.7260686380981035`", "0.14001292102898105`", 
            "0.2896918380676397`"},
           {"0.10462470250126285`", "0.5903778321073752`", 
            "0.8637727561242712`", "0.5529713620807566`", 
            "0.6353879264597251`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]},
       {
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.3066525969696394`", "0.3709474850331697`", 
            "0.7434561226841836`", "0.8150829225224435`", 
            "0.06166976090468568`"},
           {"0.5830895094548613`", "0.4229120514982213`", 
            "0.9532714651052839`", "0.18883209747919913`", 
            "0.17038464542414208`"},
           {"0.47850686922698327`", "0.8988243974986201`", 
            "0.04811120592113295`", "0.5093298887583536`", 
            "0.5890871132943106`"},
           {"0.811923563877216`", "0.3220425678230294`", 
            "0.36931696772937256`", "0.2993952752266709`", 
            "0.7072988613759531`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.7316647357156542`", "0.5055442116051014`", 
            "0.7464239131459143`", "0.071910934916228`", 
            "0.4250121387460148`"},
           {"0.13459672657193172`", "0.0029677904617306716`", 
            "0.25682801239378444`", "0.3633423778413291`", 
            "0.5515072171170704`"},
           {"0.5800557389635094`", "0.3035565472885005`", "0.17451028036213`",
             "0.38112257169292835`", "0.10154886973652605`"},
           {"0.40473214978988037`", "0.12639907444099704`", 
            "0.8717926829345747`", "0.5124617564422155`", 
            "0.5928085859126644`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.8043565066179676`", "0.5024757152052022`", 
            "0.21306648121554453`", "0.8855097245367113`", 
            "0.07269177090231345`"},
           {"0.9969315036001007`", "0.4666425680696302`", 
            "0.8135987896204833`", "0.6476796321562986`", 
            "0.862334777028169`"},
           {"0.46367477760789955`", "0.5567707772266989`", 
            "0.28433725431496953`", "0.31082755991109856`", 
            "0.8836190386443902`"},
           {"0.25321422993819837`", "0.1098269739528395`", 
            "0.9297049882181703`", "0.7820701689078642`", 
            "0.8484820801483179`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["a=", 
   MatrixForm[CompressedData["
1:eJwV0v0z2wcAx/F4aLWrtDq6bp20VDu0l3naUH742DmyrNGYeppN7YioOdFx
xTz0UGy1Zlq6TnUrzdbOU+eprBytiI56GJFYIkoiQpp8JeJpVeXMfnjdvf+A
t210UlCsKYlEMt5msu3/3rHtWZqXxDpTBe/L2SUdyzN41NXg08sVYyjO+2y/
XItmkXlz6KdiWLrdZZXkD6H58ZUYw9FJHNrVeCLk2wXExXMouTIh4tPmfKpD
hqGkRffxfyGwuZySJ/xKAdmHpgEBvgRGDudbd+zXYL19PbCmVoePOwOvmfeo
8MP8msuef35Fk6+85GDxHNYbd7cHnJaDykqrWq/Vwy8ldeOUUIKVdj/XPGMp
jI9US6velIJO8ZfqxjSQ8Un2OYlqIOJeYT75BcKWup+Y29chq+WNArt/9TBq
WCmvviJDBjlbF1WnwCDTo3zNeQbRDz6L+JuzADeu+evAc3z4yAu9iAdCaM3G
hO6lajxLHqh/ZTaFWVn2DNdhFJV3LxmlFMlhYMhyrqo1oGzcoBmgxe8Z2etl
nw/jMFmhs3XXYE5dQxu4LIbhJ0rFaikBs+MsH7qeAD0qo5ofL0OyKsfjuqce
nJq0xCxFLVqvcmOPmXSDPXbwzBf2s2C05CfYpM4jxJG99yhaQd2jOb3ircYf
RxLyFgk+jAbKecyiUfg/LvOu72uHQn2c/KVKCUZ4mGDnbwRuRqZvGRqnwTrH
3fdOiArPV4bcXStFeLnXuaC8U4L7FncusfrVoEWv9Toc0MKn45tBamk9Itf/
DK6tUoJ96nrLpsUEwvplDm65eizLuF/fP9mHmRPEluPwU+RdKPafqJhCA9Mk
+qRgHkueRs67eFU4u6p04TAUWDUWeAyNK1FY5G5De61Bj8X7nPCfxRiOuMab
4Umg8SIGP3EUoTNZ4OnCm0OuzaLjYLwa1mMGcgJVgSlssh8q1ejlNdD555tg
z7CisN0mkOceQ03z4kPv4RT1gnkedqzM7qmkEVRYFcSQPpLAV1SZunRvGgUl
N8nCYiUuDj+9kJ4oAuNMVkhE6F84sJ+hY7KksB5NDXp3qw1Wzk/qbNXj2EfK
okupXfCwFPS0zRJgSr53fYutQD7ZsZW+pgTvJW2C3qnByGzGMs1KgXh1uLPA
bwC95bHZb4fOY0dba5HudhMeWhTNPp9bwNqyS3/65CQ4hU7BpN1akBsHef1t
Klj6uhxCGYHvfkx5Ja2bRKR4cclCOI3MACvlDdftv+Q2tFsqEeBpl3Tbfx5+
45SL1R+MIOhW+OQdSgf847R1x7p02IgUmz7aqUFZsJNK8B6B/wCXnet/
    "]]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.606819200852847*^9, 3.606819222349923*^9}, 
   3.6068194234063005`*^9, 3.606819506196562*^9, {3.606819662604167*^9, 
   3.6068196844912477`*^9}, 3.6068197215573225`*^9, 3.6068197863293533`*^9, {
   3.606819821429803*^9, 3.6068198372640066`*^9}, 3.6068201005339813`*^9, 
   3.6068201951179943`*^9, 3.6068202267552*^9, 3.6068203134767113`*^9, 
   3.606825210761516*^9, 3.606825261087761*^9, 3.606825298887046*^9, {
   3.6068256466467037`*^9, 3.6068256930260987`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"FNormalizeLogBC[b,dimlist]=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.21477605520844198`", "0.21125596129995367`", 
            "0.15613498840986006`", "0.2622729188654522`", 
            "0.15556007621629236`"},
           {"0.15521655981680274`", "0.19431305395348367`", 
            "0.3301288830941583`", "0.1629061841338168`", 
            "0.1574353190017387`"},
           {"0.21351438071840356`", "0.15046584284590972`", 
            "0.2111697508368325`", "0.1971789396050385`", 
            "0.2276710859938158`"},
           {"0.2076460096956783`", "0.1128032759068687`", 
            "0.21961374018134702`", "0.17695122851789113`", 
            "0.282985745698215`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.16706749904597995`", "0.16757078442301235`", 
            "0.16773605335549271`", "0.25816970340658296`", 
            "0.23945595976893205`"},
           {"0.23545042145387493`", "0.11731183968592415`", 
            "0.29218772610014604`", "0.16809049797253786`", 
            "0.1869595147875171`"},
           {"0.20140191002004992`", "0.2952583327018722`", 
            "0.126629481276073`", "0.14573861529459012`", 
            "0.23097166070741482`"},
           {"0.17604173182266858`", "0.14623421353669194`", 
            "0.1802436550313341`", "0.24739828872944117`", 
            "0.2500821108798642`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.1328715409352337`", "0.22866497552433301`", 
            "0.14330053080392596`", "0.24621654801576728`", 
            "0.24894640472073992`"},
           {"0.18367189114628008`", "0.3125771390775222`", 
            "0.12836697692233973`", "0.13993345568153692`", 
            "0.23545053717232114`"},
           {"0.3012865565703971`", "0.13503620190418816`", 
            "0.25588054365278695`", "0.14240213504374188`", 
            "0.16539456282888543`"},
           {"0.12456705432923938`", "0.20247112615956123`", 
            "0.2661319433761909`", "0.19503729944691078`", 
            "0.21179257668809748`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]},
       {
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.1650285920428123`", "0.175987616551507`", 
            "0.25542332575424387`", "0.2743896206588953`", 
            "0.12917084499254158`"},
           {"0.21570185573650455`", "0.18377638115941672`", 
            "0.3123358691029931`", "0.1454219831761979`", 
            "0.1427639108248877`"},
           {"0.1879372265387851`", "0.2861240717209991`", 
            "0.12220651290072225`", "0.19382021938653154`", 
            "0.20991196945296214`"},
           {"0.266332798011042`", "0.16318191983545655`", 
            "0.17108149997075495`", "0.15952782500859278`", 
            "0.2398759571741535`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.24597974358635716`", "0.19619884598545884`", 
            "0.24963712585168835`", "0.1271662631091375`", 
            "0.1810180214673584`"},
           {"0.17298133186510378`", "0.15164689274399926`", 
            "0.19547157378182428`", "0.21744138754291095`", 
            "0.2624588140661619`"},
           {"0.258775061803675`", "0.196263865309706`", "0.172502846623438`", 
            "0.2120932485954593`", "0.16036497766772181`"},
           {"0.17627311314547442`", "0.13344661312322995`", 
            "0.2812081393721347`", "0.19632357250646731`", 
            "0.21274856185269367`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.25915575810534086`", "0.19162655887242366`", 
            "0.14347190587887654`", "0.28106402251276696`", 
            "0.12468175463059182`"},
           {"0.24998688400156927`", "0.14710101342751988`", 
            "0.20811186310214785`", "0.17629462145899094`", 
            "0.21850561800977206`"},
           {"0.18819886227828525`", "0.2065608787852334`", 
            "0.1573010772720695`", "0.16152371341195992`", 
            "0.286415468252452`"},
           {"0.13616765574248077`", "0.11797817306552402`", 
            "0.26783674852224637`", "0.23107511441428683`", 
            "0.24694230825546193`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["FNormalizeLogBC[b,dimlist]=", 
   MatrixForm[CompressedData["
1:eJwVj3lQlAUAxYEkUSwZ3BC5hG0hBjeyCRxYwMd9yHAkR5iihGzhqBybEyCy
JQiCDMO6yA6CSYQgARmGY0yc++1+e/Cx7MEiCXGEgKKJGVdcs61//GbeX+/3
nkNy+lH2NgMDAyM9b+l5k431nCav0WV5FEYd0znpOyks3c075LUpgpc27HOa
XIVk8dK3KfMiHNuwmqJPiFDnv7zDd1IG8p7FrNZ+GCuTlXY2o2KUXWF+OOIk
Rkq9W2ZGLIVhS8u1b/zf9Ez639pOYTujWOvsI0dxeDg3hqHA6EjKOuNGP/hD
c3+3TnXhePLzigibAbTFdeXFN0rALOg7nGGjQZJfNJGVTOKvo2m1yxwScUpC
dyqbBEvo7TFaqMLqPmNXbuMgqIbNMJ/3B/Ewa9rcyaQHJfQ1R7d2DeI6peFb
BSRWbP+gHVmQoqols7VEKkfj+AO3glkNyhhsGtu9D4YHWba8uwR4gYUdF3kK
VJ27QCsplqCTfoyr+I0AY2440dNcCsWiIKC3WYmT1DQ7wVCF119mBr0yFMJ1
t3JkJlD/637jestnBKytOq3evqLEs+5ERc64Es3Zw9zyfCkCmBdKAwy14IRO
IzatDzaJ00/j54UIKsnzP6zffz19IDUkdAhfuV4UjYcKUfZfszwhSYXsE5w2
LxYB7R3GB40HSPys+C7phye9YLfcfsZ/Lkf3R5HBkSZqsJaivt5YkcGk2u3p
NhsKOWHjLk37STTkUvaiIgmKDNr2jCWoYD5F5t4sV6M952xlS3EfFvk7ou1u
Uej85bzxZqEUk7z+yqitIYx5Lxgd/J5Ax0njSxbBBObvjXTEvCsDf6UpfixK
g5CIQLOXob2womQj+5QysDgvPNkT/chRxXRUmarx479cZ8cnYjCrf6rXzZKo
+6LmdOpZMQQZN075PRhEfsjehoBLSkTW5rub2spxza99y3pJCXVT9cJGcB8m
XC09bx6QgrkgqPRlSBBklhHvckYEOjsh9ZCxHJTAkWc3TEGb3/2O/YAKutnx
YLJchTMMTh1zvxw7s44TfJoEjF73/ZOOFNIf+756VCRG7Z+7d9nxJChx5sVI
aULUsbjnonVqxN9vzXNwkMNP+zAswYtCZG6qiZFAhYis9vc8rspgdVlTEZZI
wJL/8dLiphrlj0t/Z7zohaCmZu26TomrVf90uWkJOGWvPkqt78evAapsjd5j
ata6trVKwakqOnfOQgZr3WUfQUY/0lz89mTSxdhl+KmtslWMO7cjSutiNWh/
udfi9Xkh7KKXj6g/6UFo7kyPN0MNqUVz2USFAjMn1j0Ga5T4H3ao36c=
    "]]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.606819200852847*^9, 3.606819222349923*^9}, 
   3.6068194234063005`*^9, 3.606819506196562*^9, {3.606819662604167*^9, 
   3.6068196844912477`*^9}, 3.6068197215573225`*^9, 3.6068197863293533`*^9, {
   3.606819821429803*^9, 3.6068198372640066`*^9}, 3.6068201005339813`*^9, 
   3.6068201951179943`*^9, 3.6068202267552*^9, 3.6068203134767113`*^9, 
   3.606825210761516*^9, 3.606825261087761*^9, 3.606825298887046*^9, {
   3.6068256466467037`*^9, 3.6068256930416985`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"FNormalizeLog[a]=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.21477605520844187`", "0.21125596129995358`", 
            "0.15613498840985998`", "0.26227291886545206`", 
            "0.15556007621629228`"},
           {"0.15521655981680274`", "0.19431305395348367`", 
            "0.3301288830941583`", "0.1629061841338168`", 
            "0.1574353190017387`"},
           {"0.21351438071840356`", "0.15046584284590972`", 
            "0.2111697508368325`", "0.1971789396050385`", 
            "0.2276710859938158`"},
           {"0.2076460096956783`", "0.1128032759068687`", 
            "0.21961374018134702`", "0.17695122851789113`", 
            "0.282985745698215`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.16706749904597995`", "0.16757078442301235`", 
            "0.16773605335549271`", "0.25816970340658296`", 
            "0.23945595976893205`"},
           {"0.23545042145387493`", "0.11731183968592415`", 
            "0.29218772610014604`", "0.16809049797253786`", 
            "0.1869595147875171`"},
           {"0.20140191002004992`", "0.2952583327018722`", 
            "0.126629481276073`", "0.14573861529459012`", 
            "0.23097166070741482`"},
           {"0.17604173182266858`", "0.14623421353669194`", 
            "0.1802436550313341`", "0.24739828872944117`", 
            "0.2500821108798642`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.1328715409352337`", "0.22866497552433301`", 
            "0.14330053080392596`", "0.24621654801576728`", 
            "0.24894640472073992`"},
           {"0.18367189114628008`", "0.3125771390775222`", 
            "0.12836697692233973`", "0.13993345568153692`", 
            "0.23545053717232114`"},
           {"0.30128655657039727`", "0.13503620190418822`", 
            "0.25588054365278706`", "0.14240213504374194`", 
            "0.1653945628288855`"},
           {"0.12456705432923938`", "0.20247112615956123`", 
            "0.2661319433761909`", "0.19503729944691078`", 
            "0.21179257668809748`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]},
       {
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.1650285920428123`", "0.175987616551507`", 
            "0.25542332575424387`", "0.2743896206588953`", 
            "0.12917084499254158`"},
           {"0.21570185573650455`", "0.18377638115941672`", 
            "0.3123358691029931`", "0.1454219831761979`", 
            "0.1427639108248877`"},
           {"0.1879372265387851`", "0.2861240717209991`", 
            "0.12220651290072225`", "0.19382021938653154`", 
            "0.20991196945296214`"},
           {"0.266332798011042`", "0.16318191983545655`", 
            "0.17108149997075495`", "0.15952782500859278`", 
            "0.2398759571741535`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.24597974358635716`", "0.19619884598545884`", 
            "0.24963712585168835`", "0.1271662631091375`", 
            "0.1810180214673584`"},
           {"0.17298133186510378`", "0.15164689274399926`", 
            "0.19547157378182428`", "0.21744138754291095`", 
            "0.2624588140661619`"},
           {"0.258775061803675`", "0.196263865309706`", "0.172502846623438`", 
            "0.2120932485954593`", "0.16036497766772181`"},
           {"0.17627311314547442`", "0.13344661312322995`", 
            "0.2812081393721347`", "0.19632357250646731`", 
            "0.21274856185269367`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.25915575810534086`", "0.19162655887242366`", 
            "0.14347190587887654`", "0.28106402251276696`", 
            "0.12468175463059182`"},
           {"0.24998688400156927`", "0.14710101342751988`", 
            "0.20811186310214785`", "0.17629462145899094`", 
            "0.21850561800977206`"},
           {"0.18819886227828525`", "0.2065608787852334`", 
            "0.1573010772720695`", "0.16152371341195992`", 
            "0.286415468252452`"},
           {"0.13616765574248077`", "0.11797817306552402`", 
            "0.26783674852224637`", "0.23107511441428683`", 
            "0.24694230825546193`"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["FNormalizeLog[a]=", 
   MatrixForm[CompressedData["
1:eJwVz2lQ1AUABXAgSRRLBjdEbraFGNzIJnBgAR/3IcORHGGKELENjMqxOXHJ
liAIMgzbAjsIJhGCBGQYjjFx7r3Ln2UPFjchWEJA0cSIK67Ztg+/mfftveeY
mnWGvs/AwMBI7w29/7OxXrLwJllSREDjlMXIOkhg5V7RSe9dPrzU4Z+SpAok
C9a+Tlvi4+yO1Sx5ho/mgPUDfloJhPctFtQOE9jQ1tnZTApQdZ36vsZZgLQW
95zsOAITlpZbXwXw4a3WBtzeT2A/pVzt4itFeUQEM5Yiw6QmbZtSOwL2+OJf
XbP9OJf6oibSZhTd8f1FCW0iUEuGT2XbqJDiH8PLTRXizzOZTesMIeLlPF1y
nhA0ro/nZKkCm8eM3ZhtYyBad8N93x3Do9w5c2eTQVSQt5zce1SI7xNH7JUI
sWH7O+n0shj1nTldFWIp2qYfupcsqFBFoZPoHsMwPEGzZd3jgRVU2lvAkqH+
0hVSRbkIfeSzTNmvPFAWJ5K8zMWQrXIChzrkuEDM0RMNFVj5Iif4tSEXbofl
mvkg/a8Hbdudn/BgbdVn9eZ1OZ4PJMnyp+XoyJtgVheLEUi9UhloqAYjbA5x
mcOwSZp7lrDERXBFUcAp/f7arNH00LBxZLgV8KfDuKj+t0OamKJAwXlGtzeN
B81dynttx4X4SfZNyvdPh0DvvPOc/UKKgQ+iQqJMlKCtRX+5syGBSYP7s302
BPLDp13b7YVoLSQc+GUilBl0H5lKVMB8Vlh4q1qJnvyLdZ3lw1hlH4ixu02g
7+fLxrulYmhZI3XRe+OY8lk2OvEdD70XjK9ahPCwdF/TG/u2BOyN9oSpaBVC
I4PMXoUNwYqQaI7JJaAxXnrRZ0aQr4jtrTdV4od/mC5OTwWgNvzYolsQovmz
xs/TLwrAya5N9n84huLQo62BV+WIair2MLWV4qZ/z571mhzK9oblnZBhzLhZ
et06LgZ1mVPnRxEh2Cw7wTWDDzI9Mf2ksRQEx4llN0FAXTzwlsOoArqF6RBh
tQIZFEYz1V6Kg7nneGySCJQhD3utE4GsJ36vH5cJ0PTH4UN2LBEqXFixYhIX
zTTmpRidEgkPuoocHaXwVz8KT/QmEFWYbmLEUSAyt+cdzxsSWF1T1YQn8WDJ
/nBtdVeJ6ieVv1FeDoHT2Lj1rU6OG/V/97ureXDO23yc3jKCXwIVeSp9j6lZ
19beJgHn+pjCRQsJrHXXfDnZI8h09T+SQxbgkOHHtvIuAe7eiaxsjlOh59VR
i5XLXNjFrJ9WfjSIsML5QR+KEmKLjqqZGhnmz297jjXK8R9YwN+k
    "]]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.606819200852847*^9, 3.606819222349923*^9}, 
   3.6068194234063005`*^9, 3.606819506196562*^9, {3.606819662604167*^9, 
   3.6068196844912477`*^9}, 3.6068197215573225`*^9, 3.6068197863293533`*^9, {
   3.606819821429803*^9, 3.6068198372640066`*^9}, 3.6068201005339813`*^9, 
   3.6068201951179943`*^9, 3.6068202267552*^9, 3.6068203134767113`*^9, 
   3.606825210761516*^9, 3.606825261087761*^9, 3.606825298887046*^9, {
   3.6068256466467037`*^9, 3.6068256930416985`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"MNormalizeLogBC[b,dimlist]=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"-", "1.4549184710455174`"}], 
            RowBox[{"-", "1.4810774392564119`"}], 
            RowBox[{"-", "2.1445119371718944`"}], 
            RowBox[{"-", "1.1832456353794658`"}], 
            RowBox[{"-", "2.156064963580431`"}]},
           {
            RowBox[{"-", "2.2531708337091017`"}], 
            RowBox[{"-", "1.5730280998117268`"}], 
            RowBox[{"-", "0.8009754916724927`"}], 
            RowBox[{"-", "2.0628177202013154`"}], 
            RowBox[{"-", "2.193442935860035`"}]},
           {
            RowBox[{"-", "1.5181655460617616`"}], 
            RowBox[{"-", "2.038236302592421`"}], 
            RowBox[{"-", "1.5310427441576757`"}], 
            RowBox[{"-", "1.6149264275614743`"}], 
            RowBox[{"-", "1.446413920617707`"}]},
           {
            RowBox[{"-", "1.4762691348311225`"}], 
            RowBox[{"-", "4.294662134682101`"}], 
            RowBox[{"-", "1.393445305887793`"}], 
            RowBox[{"-", "1.7592931912583634`"}], 
            RowBox[{"-", "1.086233888712475`"}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"-", "1.9678938915428552`"}], 
            RowBox[{"-", "1.9598436786195572`"}], 
            RowBox[{"-", "1.9572194581240798`"}], 
            RowBox[{"-", "1.1934028160410615`"}], 
            RowBox[{"-", "1.2912378930717894`"}]},
           {
            RowBox[{"-", "1.282387170607406`"}], 
            RowBox[{"-", "3.8975899290624656`"}], 
            RowBox[{"-", "1.029894892693195`"}], 
            RowBox[{"-", "1.8772178780303785`"}], 
            RowBox[{"-", "1.64882776626356`"}]},
           {
            RowBox[{"-", "1.5158208855914892`"}], 
            RowBox[{"-", "1.0224245063200323`"}], 
            RowBox[{"-", "3.001918155651767`"}], 
            RowBox[{"-", "2.29102631769068`"}], 
            RowBox[{"-", "1.310088420231807`"}]},
           {
            RowBox[{"-", "1.812911750143668`"}], 
            RowBox[{"-", "2.316012956222473`"}], 
            RowBox[{"-", "1.7638645526339147`"}], 
            RowBox[{"-", "1.2675836455304665`"}], 
            RowBox[{"-", "1.2543430170407133`"}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"-", "2.5341017714229226`"}], 
            RowBox[{"-", "1.3659720830597184`"}], 
            RowBox[{"-", "2.2652701481278843`"}], 
            RowBox[{"-", "1.2762534027905807`"}], 
            RowBox[{"-", "1.2635403366356535`"}]},
           {
            RowBox[{"-", "1.679521973165318`"}], 
            RowBox[{"-", "0.8516994031644057`"}], 
            RowBox[{"-", "3.7050257025912914`"}], 
            RowBox[{"-", "2.7554762596320668`"}], 
            RowBox[{"-", "1.2084180201776462`"}]},
           {
            RowBox[{"-", "0.8742905776730917`"}], 
            RowBox[{"-", "3.2000922430481165`"}], 
            RowBox[{"-", "1.077215314964215`"}], 
            RowBox[{"-", "2.7231251567402603`"}], 
            RowBox[{"-", "1.9960421375161488`"}]},
           {
            RowBox[{"-", "3.267933990928939`"}], 
            RowBox[{"-", "1.537550950920214`"}], 
            RowBox[{"-", "1.1570039557931378`"}], 
            RowBox[{"-", "1.6030074625489978`"}], 
            RowBox[{"-", "1.4640779560828863`"}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]},
       {
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"-", "2.0139957896334924`"}], 
            RowBox[{"-", "1.8236507876966497`"}], 
            RowBox[{"-", "1.128401540897528`"}], 
            RowBox[{"-", "1.036421437017688`"}], 
            RowBox[{"-", "3.6179175785250064`"}]},
           {
            RowBox[{"-", "1.3803305839601792`"}], 
            RowBox[{"-", "1.7015070496895097`"}], 
            RowBox[{"-", "0.8887715747411934`"}], 
            RowBox[{"-", "2.507813043941941`"}], 
            RowBox[{"-", "2.6106127897164844`"}]},
           {
            RowBox[{"-", "1.6628739799357688`"}], 
            RowBox[{"-", "1.0324568620097385`"}], 
            RowBox[{"-", "3.9600294251655725`"}], 
            RowBox[{"-", "1.6004486283505104`"}], 
            RowBox[{"-", "1.4549704734316957`"}]},
           {
            RowBox[{"-", "1.1286227602001029`"}], 
            RowBox[{"-", "2.053345227759678`"}], 
            RowBox[{"-", "1.9163736963195501`"}], 
            RowBox[{"-", "2.126264271719872`"}], 
            RowBox[{"-", "1.2665756685518734`"}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"-", "1.2209155833001493`"}], 
            RowBox[{"-", "1.5906024852511156`"}], 
            RowBox[{"-", "1.2009442940280575`"}], 
            RowBox[{"-", "3.54080964279583`"}], 
            RowBox[{"-", "1.7641202507529612`"}]},
           {
            RowBox[{"-", "2.274920620537107`"}], 
            RowBox[{"-", "6.089385994112844`"}], 
            RowBox[{"-", "1.6287970693813405`"}], 
            RowBox[{"-", "1.28185813839187`"}], 
            RowBox[{"-", "0.8645487928294453`"}]},
           {
            RowBox[{"-", "0.9769289515914847`"}], 
            RowBox[{"-", "1.6244852417707578`"}], 
            RowBox[{"-", "2.1780694990185108`"}], 
            RowBox[{"-", "1.3969321183065966`"}], 
            RowBox[{"-", "2.7195129943291625`"}]},
           {
            RowBox[{"-", "1.8240928609464184`"}], 
            RowBox[{"-", "2.9878741914899365`"}], 
            RowBox[{"-", "1.056766704001435`"}], 
            RowBox[{"-", "1.5880922640633477`"}], 
            RowBox[{"-", "1.4424467931800873`"}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"-", "1.1252049095020866`"}], 
            RowBox[{"-", "1.5957001857770958`"}], 
            RowBox[{"-", "2.4536432611991934`"}], 
            RowBox[{"-", "1.0290840574574895`"}], 
            RowBox[{"-", "3.5290193110003254`"}]},
           {
            RowBox[{"-", "1.3346968124627687`"}], 
            RowBox[{"-", "2.0938152918059956`"}], 
            RowBox[{"-", "1.5379115205075884`"}], 
            RowBox[{"-", "1.7659826982787274`"}], 
            RowBox[{"-", "1.4797353098679458`"}]},
           {
            RowBox[{"-", "1.6845543302775834`"}], 
            RowBox[{"-", "1.5015841022097063`"}], 
            RowBox[{"-", "2.173576677607247`"}], 
            RowBox[{"-", "2.0844994377587414`"}], 
            RowBox[{"-", "1.0397117084320449`"}]},
           {
            RowBox[{"-", "2.446231971800919`"}], 
            RowBox[{"-", "3.2815616975590576`"}], 
            RowBox[{"-", "1.1456005420259399`"}], 
            RowBox[{"-", "1.3185233942985692`"}], 
            RowBox[{"-", "1.237018895876388`"}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["MNormalizeLogBC[b,dimlist]=", 
   MatrixForm[CompressedData["
1:eJwB2QMm/CFib1JlBAAAAAIAAAADAAAABAAAAAUAAAAEyjeXWEf3vwkyx0F+
sve/dkfg3/UnAcDIbrH5ku7yv/oI1fyePwHANqcYbn4GAsAUFkaDHyv5vyQw
tFqXoem/zv2uk6aAAMDiSVnPK4wBwOv8o/RnSvi/Ojyp1U5OAMAK9y6tJn/4
v44p/Re91vm/24NY7IIk978oGmNizJ73vxJRH+m7LRHAN9gYTo1L9r94ewie
ECb8v1M7Pck2YfG/tssiTn58/7/kF48LhVv/v+LNu1nFUP+/UZwdjS0Y87+n
lqEQ6aj0v7oZ6WiohPS/h1b0oEMuD8CK9CYRc3rwvz62GZ0VCf6/aGtNOZlh
+r/mWKNmzUD4vzFglMzZW/C/BFh+qu0DCMDhDSabBVQCwAA5fEYf9vS/OWtW
wK8B/b/RswDNMYcCwG0uggnKOPy/CPfnyQVI9L9MfsL7yRH0vxr6RybXRQTA
CNn/igXb9b/Eg5b0RR8CwONOJrCIa/S/cG5wEnY39L/uiLpuUt/6v5ekUxsf
Qeu/jcD7g+SjDcBsMSAjNwsGwAD2SCKuVfO/79HJOzD66798mUD2yZkJwKZY
SCBGPPG/EuqY1/XIBcDgHWHhye//v2I2hJO6JArAJC2iBs+Z+L8llneUFoPy
vy9FLifrpfm/dLrCAd1s9790DxbTqRwAwD+1x3KsLf2/AZMuxu4N8r8m1A2l
LpXwv3kbe8V+8QzA2nC8hdUV9r88R8V0Xzn7v08X5BXRcOy/6bMBSQAQBMAh
0FL1iOIEwIYYE78hm/q/Qs2NfPGE8L9ARULoI64PwJQYWwVwm/m/a46AHo9H
97+ESkm91g7yvwABRUNAbQDAsrYJd3ep/r9Xha3XlgIBwCJvJdnkQ/S/6DZX
x96I878VcHGXG3P5v2uxMl0RN/O/NFuJAZRTDMDmH/Mn1jn8v4qfEZUJMwLA
jr2FAIhbGMAZBA2EjQ/6v4cS6K19gvS/vPXfOmKq679YOzOBAEPvv0fXozzk
/fm/zJiVs69sAcDKvS1+1Vn2v7uGXQeQwQXAcBzq/nsv/b8AGIiVKucHwIoB
EzSE6PC/POwSb9No+b9Y264WQxT3v/rC+dzWAPK/2CMC6/yH+b/oNde3D6ED
wKTWOdggd/C/P5f9eW47DMAKpnkL61r1vyBfUTsiwADAMIxLHEmb+L8ki+YS
d0H8v3boqe7+rPe/2AnOPe/z+r+G8jINfQb4vydfTSt8YwHAKqKNCg6tAMAj
vo++qKLwvy6EahHikQPARJRWa6NACsAlgOQ7YVTyv05fmPyrGPW/eytlU9TK
8791VPj1
    "]]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.606819200852847*^9, 3.606819222349923*^9}, 
   3.6068194234063005`*^9, 3.606819506196562*^9, {3.606819662604167*^9, 
   3.6068196844912477`*^9}, 3.6068197215573225`*^9, 3.6068197863293533`*^9, {
   3.606819821429803*^9, 3.6068198372640066`*^9}, 3.6068201005339813`*^9, 
   3.6068201951179943`*^9, 3.6068202267552*^9, 3.6068203134767113`*^9, 
   3.606825210761516*^9, 3.606825261087761*^9, 3.606825298887046*^9, {
   3.6068256466467037`*^9, 3.6068256930416985`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"MNormalizeLog1[a]=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"-", "1.4549184710455176`"}], 
            RowBox[{"-", "1.481077439256412`"}], 
            RowBox[{"-", "2.1445119371718944`"}], 
            RowBox[{"-", "1.1832456353794663`"}], 
            RowBox[{"-", "2.156064963580431`"}]},
           {
            RowBox[{"-", "2.2531708337091017`"}], 
            RowBox[{"-", "1.5730280998117268`"}], 
            RowBox[{"-", "0.8009754916724927`"}], 
            RowBox[{"-", "2.0628177202013154`"}], 
            RowBox[{"-", "2.193442935860035`"}]},
           {
            RowBox[{"-", "1.5181655460617616`"}], 
            RowBox[{"-", "2.038236302592421`"}], 
            RowBox[{"-", "1.5310427441576757`"}], 
            RowBox[{"-", "1.6149264275614743`"}], 
            RowBox[{"-", "1.446413920617707`"}]},
           {
            RowBox[{"-", "1.4762691348311225`"}], 
            RowBox[{"-", "4.294662134682101`"}], 
            RowBox[{"-", "1.393445305887793`"}], 
            RowBox[{"-", "1.7592931912583634`"}], 
            RowBox[{"-", "1.086233888712475`"}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"-", "1.9678938915428552`"}], 
            RowBox[{"-", "1.9598436786195572`"}], 
            RowBox[{"-", "1.9572194581240798`"}], 
            RowBox[{"-", "1.1934028160410615`"}], 
            RowBox[{"-", "1.2912378930717894`"}]},
           {
            RowBox[{"-", "1.282387170607406`"}], 
            RowBox[{"-", "3.8975899290624656`"}], 
            RowBox[{"-", "1.029894892693195`"}], 
            RowBox[{"-", "1.8772178780303785`"}], 
            RowBox[{"-", "1.64882776626356`"}]},
           {
            RowBox[{"-", "1.5158208855914892`"}], 
            RowBox[{"-", "1.0224245063200323`"}], 
            RowBox[{"-", "3.001918155651767`"}], 
            RowBox[{"-", "2.29102631769068`"}], 
            RowBox[{"-", "1.310088420231807`"}]},
           {
            RowBox[{"-", "1.812911750143668`"}], 
            RowBox[{"-", "2.316012956222473`"}], 
            RowBox[{"-", "1.7638645526339147`"}], 
            RowBox[{"-", "1.2675836455304665`"}], 
            RowBox[{"-", "1.2543430170407133`"}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"-", "2.5341017714229226`"}], 
            RowBox[{"-", "1.3659720830597184`"}], 
            RowBox[{"-", "2.2652701481278843`"}], 
            RowBox[{"-", "1.2762534027905807`"}], 
            RowBox[{"-", "1.2635403366356535`"}]},
           {
            RowBox[{"-", "1.679521973165318`"}], 
            RowBox[{"-", "0.8516994031644057`"}], 
            RowBox[{"-", "3.7050257025912914`"}], 
            RowBox[{"-", "2.7554762596320668`"}], 
            RowBox[{"-", "1.2084180201776462`"}]},
           {
            RowBox[{"-", "0.8742905776730917`"}], 
            RowBox[{"-", "3.2000922430481165`"}], 
            RowBox[{"-", "1.077215314964215`"}], 
            RowBox[{"-", "2.7231251567402603`"}], 
            RowBox[{"-", "1.9960421375161488`"}]},
           {
            RowBox[{"-", "3.267933990928939`"}], 
            RowBox[{"-", "1.5375509509202145`"}], 
            RowBox[{"-", "1.157003955793138`"}], 
            RowBox[{"-", "1.603007462548998`"}], 
            RowBox[{"-", "1.4640779560828863`"}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]},
       {
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"-", "2.0139957896334924`"}], 
            RowBox[{"-", "1.8236507876966497`"}], 
            RowBox[{"-", "1.128401540897528`"}], 
            RowBox[{"-", "1.036421437017688`"}], 
            RowBox[{"-", "3.6179175785250064`"}]},
           {
            RowBox[{"-", "1.3803305839601792`"}], 
            RowBox[{"-", "1.7015070496895097`"}], 
            RowBox[{"-", "0.8887715747411934`"}], 
            RowBox[{"-", "2.507813043941941`"}], 
            RowBox[{"-", "2.6106127897164844`"}]},
           {
            RowBox[{"-", "1.6628739799357688`"}], 
            RowBox[{"-", "1.0324568620097385`"}], 
            RowBox[{"-", "3.9600294251655725`"}], 
            RowBox[{"-", "1.6004486283505104`"}], 
            RowBox[{"-", "1.4549704734316957`"}]},
           {
            RowBox[{"-", "1.1286227602001029`"}], 
            RowBox[{"-", "2.053345227759678`"}], 
            RowBox[{"-", "1.9163736963195501`"}], 
            RowBox[{"-", "2.126264271719872`"}], 
            RowBox[{"-", "1.2665756685518734`"}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"-", "1.2209155833001493`"}], 
            RowBox[{"-", "1.5906024852511156`"}], 
            RowBox[{"-", "1.2009442940280575`"}], 
            RowBox[{"-", "3.54080964279583`"}], 
            RowBox[{"-", "1.7641202507529612`"}]},
           {
            RowBox[{"-", "2.274920620537107`"}], 
            RowBox[{"-", "6.089385994112844`"}], 
            RowBox[{"-", "1.6287970693813405`"}], 
            RowBox[{"-", "1.28185813839187`"}], 
            RowBox[{"-", "0.8645487928294453`"}]},
           {
            RowBox[{"-", "0.9769289515914847`"}], 
            RowBox[{"-", "1.6244852417707578`"}], 
            RowBox[{"-", "2.1780694990185108`"}], 
            RowBox[{"-", "1.3969321183065966`"}], 
            RowBox[{"-", "2.7195129943291625`"}]},
           {
            RowBox[{"-", "1.8240928609464184`"}], 
            RowBox[{"-", "2.9878741914899365`"}], 
            RowBox[{"-", "1.056766704001435`"}], 
            RowBox[{"-", "1.5880922640633477`"}], 
            RowBox[{"-", "1.4424467931800873`"}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"-", "1.1252049095020866`"}], 
            RowBox[{"-", "1.5957001857770958`"}], 
            RowBox[{"-", "2.4536432611991934`"}], 
            RowBox[{"-", "1.0290840574574895`"}], 
            RowBox[{"-", "3.5290193110003254`"}]},
           {
            RowBox[{"-", "1.3346968124627687`"}], 
            RowBox[{"-", "2.0938152918059956`"}], 
            RowBox[{"-", "1.5379115205075884`"}], 
            RowBox[{"-", "1.7659826982787274`"}], 
            RowBox[{"-", "1.4797353098679458`"}]},
           {
            RowBox[{"-", "1.6845543302775834`"}], 
            RowBox[{"-", "1.5015841022097063`"}], 
            RowBox[{"-", "2.1735766776072474`"}], 
            RowBox[{"-", "2.0844994377587414`"}], 
            RowBox[{"-", "1.039711708432045`"}]},
           {
            RowBox[{"-", "2.446231971800919`"}], 
            RowBox[{"-", "3.2815616975590576`"}], 
            RowBox[{"-", "1.1456005420259399`"}], 
            RowBox[{"-", "1.3185233942985692`"}], 
            RowBox[{"-", "1.237018895876388`"}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["MNormalizeLog1[a]=", 
   MatrixForm[CompressedData["
1:eJwB2QMm/CFib1JlBAAAAAIAAAADAAAABAAAAAUAAAAFyjeXWEf3vwoyx0F+
sve/dkfg3/UnAcDKbrH5ku7yv/oI1fyePwHANqcYbn4GAsAUFkaDHyv5vyQw
tFqXoem/zv2uk6aAAMDiSVnPK4wBwOv8o/RnSvi/Ojyp1U5OAMAK9y6tJn/4
v44p/Re91vm/24NY7IIk978oGmNizJ73vxJRH+m7LRHAN9gYTo1L9r94ewie
ECb8v1M7Pck2YfG/tssiTn58/7/kF48LhVv/v+LNu1nFUP+/UZwdjS0Y87+n
lqEQ6aj0v7oZ6WiohPS/h1b0oEMuD8CK9CYRc3rwvz62GZ0VCf6/aGtNOZlh
+r/mWKNmzUD4vzFglMzZW/C/BFh+qu0DCMDhDSabBVQCwAA5fEYf9vS/OWtW
wK8B/b/RswDNMYcCwG0uggnKOPy/CPfnyQVI9L9MfsL7yRH0vxr6RybXRQTA
CNn/igXb9b/Eg5b0RR8CwONOJrCIa/S/cG5wEnY39L/uiLpuUt/6v5ekUxsf
Qeu/jcD7g+SjDcBsMSAjNwsGwAD2SCKuVfO/79HJOzD66798mUD2yZkJwKZY
SCBGPPG/EuqY1/XIBcDgHWHhye//v2I2hJO6JArAJi2iBs+Z+L8mlneUFoPy
vzBFLifrpfm/dLrCAd1s9790DxbTqRwAwD+1x3KsLf2/AZMuxu4N8r8m1A2l
LpXwv3kbe8V+8QzA2nC8hdUV9r88R8V0Xzn7v08X5BXRcOy/6bMBSQAQBMAh
0FL1iOIEwIYYE78hm/q/Qs2NfPGE8L9ARULoI64PwJQYWwVwm/m/a46AHo9H
97+ESkm91g7yvwABRUNAbQDAsrYJd3ep/r9Xha3XlgIBwCJvJdnkQ/S/6DZX
x96I878VcHGXG3P5v2uxMl0RN/O/NFuJAZRTDMDmH/Mn1jn8v4qfEZUJMwLA
jr2FAIhbGMAZBA2EjQ/6v4cS6K19gvS/vPXfOmKq679YOzOBAEPvv0fXozzk
/fm/zJiVs69sAcDKvS1+1Vn2v7uGXQeQwQXAcBzq/nsv/b8AGIiVKucHwIoB
EzSE6PC/POwSb9No+b9Y264WQxT3v/rC+dzWAPK/2CMC6/yH+b/oNde3D6ED
wKTWOdggd/C/P5f9eW47DMAKpnkL61r1vyBfUTsiwADAMIxLHEmb+L8ki+YS
d0H8v3boqe7+rPe/2AnOPe/z+r+G8jINfQb4vyhfTSt8YwHAKqKNCg6tAMAk
vo++qKLwvy6EahHikQPARJRWa6NACsAlgOQ7YVTyv05fmPyrGPW/eytlU9TK
87+MdPj/
    "]]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.606819200852847*^9, 3.606819222349923*^9}, 
   3.6068194234063005`*^9, 3.606819506196562*^9, {3.606819662604167*^9, 
   3.6068196844912477`*^9}, 3.6068197215573225`*^9, 3.6068197863293533`*^9, {
   3.606819821429803*^9, 3.6068198372640066`*^9}, 3.6068201005339813`*^9, 
   3.6068201951179943`*^9, 3.6068202267552*^9, 3.6068203134767113`*^9, 
   3.606825210761516*^9, 3.606825261087761*^9, 3.606825298887046*^9, {
   3.6068256466467037`*^9, 3.6068256930416985`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetVectorFromMulti", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"multiVector", ",", "_Real", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"frontierList", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "_Integer"}], "}"}]}], "}"}], ",", 
     RowBox[{"multiVector", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"frontierList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ";;", 
        RowBox[{
         RowBox[{"frontierList", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", "1"}]}], "]"}], "]"}], 
     ",", 
     RowBox[{"CompilationTarget", " ", "\[Rule]", " ", "\"\<C\>\""}], ",", 
     RowBox[{"CompilationOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], ",",
         " ", 
        RowBox[{"\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6068869382199473`*^9, 3.6068869869367337`*^9}, {
  3.606887025189922*^9, 3.606887049142292*^9}, {3.6068870964839993`*^9, 
  3.6068872584492636`*^9}, {3.606887314352461*^9, 3.606887315791543*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1274, 1302},
WindowMargins->{{Automatic, 392}, {Automatic, -8}},
ShowSelection->True,
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (November 20, 2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 114, 2, 31, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[696, 26, 259, 3, 79, "Section"],
Cell[CellGroupData[{
Cell[980, 33, 108, 1, 34, "Subsubsection"],
Cell[1091, 36, 1098, 27, 52, "Input",
 InitializationCell->True],
Cell[2192, 65, 168, 3, 31, "Input"],
Cell[2363, 70, 170, 4, 31, "Input"],
Cell[CellGroupData[{
Cell[2558, 78, 209, 5, 31, "Input"],
Cell[2770, 85, 207, 5, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3014, 95, 210, 5, 31, "Input"],
Cell[3227, 102, 178, 4, 31, "Output"]
}, Open  ]],
Cell[3420, 109, 1367, 36, 55, "Input",
 InitializationCell->True],
Cell[4790, 147, 758, 20, 31, "Input",
 InitializationCell->True],
Cell[5551, 169, 1358, 35, 52, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[6934, 208, 338, 8, 31, "Input"],
Cell[7275, 218, 358, 8, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7670, 231, 137, 2, 31, "Input"],
Cell[7810, 235, 127, 2, 31, "Output"]
}, Open  ]],
Cell[7952, 240, 3709, 82, 172, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[11686, 326, 144, 2, 31, "Input"],
Cell[11833, 330, 1491, 20, 1171, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[13361, 355, 758, 20, 25, "Input"],
Cell[14122, 377, 341, 8, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14500, 390, 100, 3, 31, "Input"],
Cell[14603, 395, 104, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14744, 402, 855, 23, 31, "Input"],
Cell[15602, 427, 379, 9, 31, "Output"]
}, Open  ]],
Cell[15996, 439, 3502, 78, 152, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[19523, 521, 2113, 61, 52, "Input"],
Cell[21639, 584, 477, 9, 31, "Output"]
}, Open  ]],
Cell[22131, 596, 3827, 97, 152, "Input",
 InitializationCell->True],
Cell[25961, 695, 1586, 38, 52, "Input",
 InitializationCell->True],
Cell[27550, 735, 1510, 37, 52, "Input",
 InitializationCell->True],
Cell[29063, 774, 1419, 36, 52, "Input",
 InitializationCell->True],
Cell[30485, 812, 1704, 43, 72, "Input",
 InitializationCell->True],
Cell[32192, 857, 1756, 45, 72, "Input",
 InitializationCell->True],
Cell[33951, 904, 2035, 51, 72, "Input",
 InitializationCell->True],
Cell[35989, 957, 1160, 25, 152, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[37174, 986, 902, 22, 31, "Input"],
Cell[38079, 1010, 1864, 49, 42, "Output"]
}, Open  ]],
Cell[39958, 1062, 1744, 45, 108, "Input",
 InitializationCell->True],
Cell[41705, 1109, 4069, 100, 196, "Input",
 InitializationCell->True],
Cell[45777, 1211, 2539, 62, 72, "Input",
 InitializationCell->True],
Cell[48319, 1275, 2232, 57, 72, "Input",
 InitializationCell->True],
Cell[50554, 1334, 3877, 93, 132, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[54456, 1431, 1040, 28, 52, "Input"],
Cell[55499, 1461, 600, 11, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56136, 1477, 1428, 38, 72, "Input"],
Cell[57567, 1517, 439, 9, 31, "Output"]
}, Open  ]],
Cell[58021, 1529, 3402, 80, 192, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[61448, 1613, 141, 2, 31, "Input"],
Cell[61592, 1617, 1736, 24, 1513, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[63365, 1646, 316, 8, 25, "Input"],
Cell[63684, 1656, 225, 5, 31, "Output"]
}, Open  ]],
Cell[63924, 1664, 2177, 58, 92, "Input",
 InitializationCell->True],
Cell[66104, 1724, 2559, 66, 112, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[68688, 1794, 544, 16, 52, "Input"],
Cell[69235, 1812, 646, 20, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69918, 1837, 635, 19, 52, "Input"],
Cell[70556, 1858, 833, 25, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71426, 1888, 955, 28, 52, "Input"],
Cell[72384, 1918, 337, 9, 31, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[72770, 1933, 109, 1, 35, "Subsection"],
Cell[72882, 1936, 2791, 69, 172, "Input",
 InitializationCell->True],
Cell[75676, 2007, 1403, 37, 72, "Input",
 InitializationCell->True],
Cell[77082, 2046, 1639, 43, 72, "Input",
 InitializationCell->True],
Cell[78724, 2091, 1816, 47, 72, "Input",
 InitializationCell->True],
Cell[80543, 2140, 1984, 52, 72, "Input",
 InitializationCell->True],
Cell[82530, 2194, 2143, 56, 92, "Input",
 InitializationCell->True],
Cell[84676, 2252, 2362, 62, 92, "Input",
 InitializationCell->True],
Cell[87041, 2316, 2523, 66, 92, "Input",
 InitializationCell->True],
Cell[89567, 2384, 1723, 39, 212, "Input",
 InitializationCell->True],
Cell[91293, 2425, 801, 20, 103, "Input",
 InitializationCell->True],
Cell[92097, 2447, 1236, 32, 105, "Input",
 InitializationCell->True],
Cell[93336, 2481, 1472, 38, 105, "Input",
 InitializationCell->True],
Cell[94811, 2521, 1691, 44, 105, "Input",
 InitializationCell->True],
Cell[96505, 2567, 1910, 50, 105, "Input",
 InitializationCell->True],
Cell[98418, 2619, 2166, 55, 133, "Input",
 InitializationCell->True],
Cell[100587, 2676, 2376, 60, 133, "Input",
 InitializationCell->True],
Cell[102966, 2738, 2605, 67, 133, "Input",
 InitializationCell->True],
Cell[105574, 2807, 1381, 31, 212, "Input",
 InitializationCell->True],
Cell[106958, 2840, 867, 21, 72, "Input",
 InitializationCell->True],
Cell[107828, 2863, 1265, 32, 72, "Input",
 InitializationCell->True],
Cell[109096, 2897, 1419, 35, 72, "Input",
 InitializationCell->True],
Cell[110518, 2934, 1571, 39, 72, "Input",
 InitializationCell->True],
Cell[112092, 2975, 1715, 43, 72, "Input",
 InitializationCell->True],
Cell[113810, 3020, 1902, 46, 92, "Input",
 InitializationCell->True],
Cell[115715, 3068, 2038, 49, 92, "Input",
 InitializationCell->True],
Cell[117756, 3119, 2199, 54, 92, "Input",
 InitializationCell->True],
Cell[119958, 3175, 1483, 32, 212, "Input",
 InitializationCell->True],
Cell[121444, 3209, 1086, 27, 72, "Input",
 InitializationCell->True],
Cell[122533, 3238, 1525, 39, 72, "Input",
 InitializationCell->True],
Cell[124061, 3279, 1756, 43, 72, "Input",
 InitializationCell->True],
Cell[125820, 3324, 1998, 50, 72, "Input",
 InitializationCell->True],
Cell[127821, 3376, 2133, 53, 72, "Input",
 InitializationCell->True],
Cell[129957, 3431, 2295, 57, 92, "Input",
 InitializationCell->True],
Cell[132255, 3490, 2462, 61, 92, "Input",
 InitializationCell->True],
Cell[134720, 3553, 2606, 67, 92, "Input",
 InitializationCell->True],
Cell[137329, 3622, 2030, 46, 212, "Input",
 InitializationCell->True],
Cell[139362, 3670, 1588, 40, 72, "Input",
 InitializationCell->True],
Cell[140953, 3712, 2387, 62, 92, "Input",
 InitializationCell->True],
Cell[143343, 3776, 2838, 72, 92, "Input",
 InitializationCell->True],
Cell[146184, 3850, 3206, 81, 92, "Input",
 InitializationCell->True],
Cell[149393, 3933, 3579, 91, 92, "Input",
 InitializationCell->True],
Cell[152975, 4026, 3951, 100, 132, "Input",
 InitializationCell->True],
Cell[156929, 4128, 4320, 109, 132, "Input",
 InitializationCell->True],
Cell[161252, 4239, 4688, 118, 132, "Input",
 InitializationCell->True],
Cell[165943, 4359, 1559, 39, 212, "Input",
 InitializationCell->True],
Cell[167505, 4400, 1567, 38, 103, "Input",
 InitializationCell->True],
Cell[169075, 4440, 1690, 42, 103, "Input",
 InitializationCell->True],
Cell[170768, 4484, 1934, 47, 103, "Input",
 InitializationCell->True],
Cell[172705, 4533, 2108, 51, 103, "Input",
 InitializationCell->True],
Cell[174816, 4586, 2290, 56, 103, "Input",
 InitializationCell->True],
Cell[177109, 4644, 2462, 60, 123, "Input",
 InitializationCell->True],
Cell[179574, 4706, 2652, 65, 123, "Input",
 InitializationCell->True],
Cell[182229, 4773, 2828, 69, 123, "Input",
 InitializationCell->True],
Cell[185060, 4844, 1585, 40, 212, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[186682, 4889, 96, 1, 43, "Subsection"],
Cell[186781, 4892, 3028, 70, 152, "Input",
 InitializationCell->True],
Cell[189812, 4964, 2100, 53, 72, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[191937, 5021, 338, 8, 31, "Input"],
Cell[192278, 5031, 229, 4, 31, "Output"]
}, Open  ]],
Cell[192522, 5038, 3948, 90, 172, "Input",
 InitializationCell->True],
Cell[196473, 5130, 4007, 91, 172, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[200505, 5225, 345, 8, 31, "Input"],
Cell[200853, 5235, 513, 9, 31, "Output"]
}, Open  ]],
Cell[201381, 5247, 548, 13, 31, "Input"],
Cell[CellGroupData[{
Cell[201954, 5264, 283, 7, 31, "Input"],
Cell[202240, 5273, 145, 2, 31, "Output"]
}, Open  ]],
Cell[202400, 5278, 4143, 96, 192, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[206568, 5378, 175, 4, 31, "Input"],
Cell[206746, 5384, 220, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[207003, 5393, 380, 10, 31, "Input"],
Cell[207386, 5405, 377, 6, 31, "Output"]
}, Open  ]],
Cell[207778, 5414, 264, 3, 30, "Text"],
Cell[208045, 5419, 206, 4, 30, "Text"],
Cell[208254, 5425, 164, 3, 30, "Text"],
Cell[208421, 5430, 175, 4, 30, "Text"],
Cell[208599, 5436, 296, 6, 30, "Text"],
Cell[208898, 5444, 183, 4, 30, "Text"],
Cell[209084, 5450, 346, 6, 30, "Text"],
Cell[209433, 5458, 218, 4, 30, "Text"],
Cell[209654, 5464, 202, 4, 30, "Text"],
Cell[209859, 5470, 1538, 39, 112, "Input"],
Cell[211400, 5511, 2746, 68, 152, "Input",
 InitializationCell->True],
Cell[214149, 5581, 1723, 43, 152, "Input"],
Cell[215875, 5626, 2720, 66, 172, "Input",
 InitializationCell->True],
Cell[218598, 5694, 94, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[218717, 5699, 3669, 103, 212, "Input"],
Cell[CellGroupData[{
Cell[222411, 5806, 9437, 200, 125, "Print"],
Cell[231851, 6008, 9441, 200, 125, "Print"]
}, Open  ]]
}, Open  ]],
Cell[241319, 6212, 622, 17, 31, "Input",
 InitializationCell->True],
Cell[241944, 6231, 11879, 241, 552, "Input",
 InitializationCell->True],
Cell[253826, 6474, 9725, 191, 432, "Input",
 InitializationCell->True],
Cell[263554, 6667, 10009, 197, 432, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[273588, 6868, 2647, 64, 132, "Input"],
Cell[276238, 6934, 121, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[276396, 6941, 6972, 169, 452, "Input"],
Cell[283371, 7112, 200, 3, 31, "Output"]
}, Open  ]],
Cell[283586, 7118, 1131, 30, 52, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[284742, 7152, 437, 13, 31, "Input"],
Cell[285182, 7167, 76, 1, 31, "Output"]
}, Open  ]],
Cell[285273, 7171, 1185, 31, 52, "Input",
 InitializationCell->True],
Cell[286461, 7204, 2942, 55, 92, "Input",
 InitializationCell->True],
Cell[289406, 7261, 2932, 55, 92, "Input",
 InitializationCell->True],
Cell[292341, 7318, 7515, 169, 392, "Input",
 InitializationCell->True],
Cell[299859, 7489, 194, 4, 49, "Text"],
Cell[300056, 7495, 9920, 217, 512, "Input",
 InitializationCell->True],
Cell[309979, 7714, 10177, 225, 532, "Input",
 InitializationCell->True],
Cell[320159, 7941, 9265, 209, 572, "Input",
 InitializationCell->True],
Cell[329427, 8152, 872, 23, 48, "Input",
 InitializationCell->True],
Cell[330302, 8177, 698, 18, 48, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[331025, 8199, 5955, 139, 372, "Input"],
Cell[336983, 8340, 828, 18, 31, "Output"]
}, Open  ]],
Cell[337826, 8361, 5298, 115, 232, "Input",
 InitializationCell->True],
Cell[343127, 8478, 26306, 653, 792, "Input",
 InitializationCell->True],
Cell[369436, 9133, 29529, 694, 832, "Input",
 InitializationCell->True],
Cell[398968, 9829, 886, 23, 88, "Input",
 InitializationCell->True],
Cell[399857, 9854, 937, 25, 88, "Input",
 InitializationCell->True],
Cell[400797, 9881, 29730, 697, 832, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[430552, 10582, 7026, 192, 432, "Input"],
Cell[CellGroupData[{
Cell[437603, 10778, 9558, 199, 125, "Print"],
Cell[447164, 10979, 9676, 201, 156, "Print"],
Cell[456843, 11182, 9653, 201, 156, "Print"],
Cell[466499, 11385, 12330, 275, 156, "Print"],
Cell[478832, 11662, 12310, 275, 156, "Print"]
}, Open  ]]
}, Open  ]],
Cell[491169, 11941, 1321, 33, 72, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
